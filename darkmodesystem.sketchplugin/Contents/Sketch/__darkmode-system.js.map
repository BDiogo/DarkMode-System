{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./node_modules/balanced-match/index.js","webpack://exports/./node_modules/brace-expansion/index.js","webpack://exports/./node_modules/concat-map/index.js","webpack://exports/./node_modules/minimatch/minimatch.js","webpack://exports/./src/darkmode-system.js","webpack://exports/./src/functions.js","webpack://exports/external \"path\"","webpack://exports/external \"sketch\"","webpack://exports/external \"sketch/dom\"","webpack://exports/external \"sketch/settings\""],"names":["functions","require","page","pageInfo","Rectangle","TextDom","Text","Artboard","Settings","Style","SharedStyle","getSettings","context","DarkModeSystem","deleteAll","documentColors","DeleteAllSettings","switchDark","switchLight","createDarkmode","type","labels_alignments","pluginName","pluginDomain","document","sketch","getSelectedDocument","currentPage","userInfo","fieldHeight","fieldWidth","labelHeight","leftColWidth","settingPad","settingX","settingY","switchHeight","textOffset","windowHeight","windowWidth","get_settign_S","settingForKey","setSettingForKey","s_styles","s_colors","documentSettingForKey","alert","NSAlert","alloc","init","alertIconPath","plugin","urlForResourceNamed","path","alertIcon","NSImage","initByReferencingFile","alertContent","NSView","initWithFrame","NSMakeRect","col_width","groupdefaultFont_label","createLabel","addSubview","CGRectGetMaxY","subviews","lastObject","frame","createBoldLabel","progress","createColoredBlock","pages_available","i","pages","length","all_shapes","find","all_shapesPaths","all_texts","total","push","name","selected_page","createPopUpButton","setIcon","setMessageText","setInformativeText","accessoryView","buttonOrganize","addButtonWithTitle","buttonCancel","responseCode","runModal","reviewed_Settings","reviewSettings","s_page","indexOfSelectedItem","new_styles","syncLayerwithStyles_best","sharedLayerStyles","layer","sharedTextStyles","text","count_added","new_styles_ids","new_styles_withdark","createDarkModeStyle","settings","count","SwitchDarkMode_best","UI","message","colors_in_layer_styles","colors_in_layer_styles_names","styles_layer","colors","groupdefaultColorsCode","groupdefaultColorsCode_dark","groupdefaultColorsCode_block","groupdefaultColorsCode_block_dark","groupdefaultColorsName","groupdefaultColorsCode_textstyles","groupdefaultColorsCode_block_textstyles","groupdefaultColorsName_textstyles","groupdefaultColorsCode_layerstyles","groupdefaultColorsCode_block_layerstyles","groupdefaultColorsName_layerstyles","style","fills","layer_style_color","color","repeated","j","code","k","styles_list","colors_in_text_styles","text_style_color","textColor","undefined","createField","title_color_1","title_color_2","title_color","divider_2","createDivider","alpha","slice","dark_hex_hex","DarkMode","dark_hex","RGBToHex","r","g","b","validated_array","validateColorInput","setDocumentSettingForKey","count_repeated","stringValue","groupdefaultColorsCode_merged","concat","groupdefaultColorsName_merged","all_settings","scrolHeight","alertscroll","NSScrollView","setFlipped","setHasVerticalScroller","setDocumentView","col","title_color_3","light_name","dark_name","console","log","dark_id","dark","light_id","light","sharedStyle_light","getSharedTextStyleWithID","sharedStyle_dark","element","getSharedLayerStyleWithID","buttonOrganize2","deleted","getFontIndex","font_name","avail_fonts","index","font_info","font_selected","style_oposite","style_oposite_id","getSpecificFonts","specific_font","fontManager","NSFontManager","sharedFontManager","fonts","family","weights","sys_fonts_families","availableFontFamilies","w","availableMembersOfFontFamily","m","getFonts","sys_fonts","availableFonts","last_font","getFontsOld","getFontName","addTextStyle","styleName","theStyle","sketchVersion","MSApplicationMetadata","metadata","appVersion","textStyles","documentData","layerTextStyles","addSharedStyleWithName_firstInstance","textStyle","MSSharedStyle","initWithName_firstInstance","addSharedObject","initWithName_style","getTextStyleByName","updateTextStyle","create_info","defaultSettings","place","base","ratio","parseFloat","replace","font_family","titleOfSelectedItem","font_weight","font_weight_index","font_color","font_color_name","weights_array","list_weights","count_updated","count_Created","weight_info","getWeightfromPopupButton","initial_size","is_italic","getIs_italic","s_labels","size","Math","pow","label","options","h","s_hierarchy","titleStyle","style_to_update","getTextStyleByNameLabel","fontFamily","fontSize","fontStyle","fontWeight","weight","lineHeight","alignment","borders","new_style","layers","getAllInstancesLayers","syncWithSharedStyle","updateTextStyleLabel","print","createTextStyle","count_existent","selectedPage","placeTextStyles","x","y","layer_width","layer_height","Group","organized_styles","OrganizeArrayTextStyles","layers_artboard","getLayersNamed","artboard","parent","group","styles","rect","sharedStyleId","id","adjustToFit","padding","height","width","art_x","art_y","elementHasStyle","all_styles","exists","ifStyleNameAlreadyExists","getStyleByName","getStyleById","removeStyle","objects","objectAtIndex","removeSharedStyle","updateSettingsWithDocument","value","layerSettingForKey","err","command","valueForKey_onLayer","sketchObject","updateSettingsWithGlobal","defaults","objectForKey","createSelect","items","selectedItemIndex","comboBox","NSComboBox","addItemsWithObjectValues","selectItemAtIndex","setNumberOfVisibleItems","setCompletes","PopUpButton","NSPopUpButton","addItemsWithTitles","setTarget","self","createPopUpButtonWeights","items_names","getIndexforPopupButton","all_weights","toLowerCase","indexOf","str","font","variation","italic","getUserDefaults","domain","NSUserDefaults","initWithSuiteName","NSTextField","setStringValue","setFont","NSFont","boldSystemFontOfSize","setBezeled","setDrawsBackground","setEditable","setSelectable","createNotSelectableInput","systemFontOfSize","createCheckbox","item","flag","checkbox","NSButton","NSOffState","NSOnState","setButtonType","NSSwitchButton","setBezelStyle","setTitle","setTag","setState","darkmode","block","setWantsLayer","color_rgb","hexToRgba","cornerRadius","maskedCorners","setBackgroundColor","CGColorCreateGenericRGB","a","changeColoredBlock","hex","result","exec","substr","parseInt","gray_middle","abs","lightness","RGBToHSL","darkmode_rgb","HSLToRGB","rgb","ex","test","sep","split","R","round","toString","hsl","isPct","s","l","PI","c","mode","cmin","min","cmax","max","delta","toFixed","bi","s_color","transformed_color","lu","HSLToHex","divider","field","delegate","createFieldnoBack","createFieldControl","NSControl","setKeyOrder","order","thisItem","nextItem","setNextKeyView","window","setInitialFirstResponder","code_array","name_array","add","a_length","array","cur_style","cur_style_name","style_fontSize","style_name","style_name_array","s_name","has_group","has_group_id","updateElementStyle","sharedStyle","addNewStyle","style_type","added","this_name","styleType","getLayerArtboard","p","parent_top","artboar_id","reviewed_settings","layer_styles","text_styles","colored_containers","percentage","count_shapePath_added","container_min_width","container_min_height","shapeType","count_fills","enabled","container","hasStyle","isOutOfSync","isOutOfSyncWithSharedStyle","is_inside_colored_container","hasMatchingStyle","elementHasMatchingStyle","hasmach_butnot","n","hasmach_butnot_setting","last","element_size","layer_artboard","frame_absolute","getFrameAbsoluteFrame","this_frame","hasSettings","ifStylesavedInSettings","TextinsideColoredContainer","colored_container","count_shape_added","count_text_added","layerName","text_element","same_artboard","sum_x","sum_y","originLibrary","getLibrary","style_id","style_dark","styles_text","percentage_layer","percentage_text","new_styles_layer","new_styles_text","shared_style","s_style_name","includes","clean_name","last_style","transformMode","f","fillType","gradient","stops","newcolor","transformColor","shadows","innerShadows","dark_hex_alpha","getSettingStyle","opositde_mode","all_layer","all_artboards","this_mode","to_mode","count_switch","background","new_artboard_color"],"mappings":";;;;;;;;QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;AClFa;AACb;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;AC1DA,gBAAgB,mBAAO,CAAC,sDAAY;AACpC,eAAe,mBAAO,CAAC,8DAAgB;;AAEvC;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uBAAuB;AACvB,uBAAuB;AACvB;AACA;AACA;;AAEA;AACA;AACA,mCAAmC;AACnC,oCAAoC;AACpC;AACA;AACA;;;AAGA;AACA;AACA,wCAAwC,GAAG,IAAI;AAC/C;AACA;AACA;;AAEA;AACA,qBAAqB,KAAK;;AAE1B;AACA;;AAEA;AACA;AACA;AACA;;AAEA,qBAAqB,aAAa;AAClC;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,8BAA8B;AAC9B,uCAAuC,GAAG;AAC1C,YAAY,GAAG,yBAAyB;AACxC;AACA;AACA,8BAA8B;AAC9B,cAAc,GAAG;AACjB;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,WAAW,YAAY;AACvB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,qBAAqB,KAAK;AAC1B;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAQ,EAAE;AACV,2BAA2B;AAC3B,sBAAsB;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,YAAY,KAAK,QAAQ,EAAE,IAAI,EAAE;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,mBAAmB,YAAY;AAC/B;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,mCAAmC,2BAA2B;AAC9D;;AAEA,iBAAiB,cAAc;AAC/B,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;;ACvMA;AACA;AACA,mBAAmB,eAAe;AAClC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;ACZA;AACA;;AAEA,YAAY;AACZ;AACA,SAAS,mBAAO,CAAC,kBAAM;AACvB,CAAC;;AAED;AACA,aAAa,mBAAO,CAAC,gEAAiB;;AAEtC;AACA,QAAQ,uCAAuC;AAC/C,QAAQ,2BAA2B;AACnC,QAAQ,2BAA2B;AACnC,QAAQ,2BAA2B;AACnC,QAAQ;AACR;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,yCAAyC,IAAI;;AAE7C;AACA;AACA;;AAEA;AACA,gCAAgC;;AAEhC,aAAa;AACb;AACA;AACA;AACA;AACA,GAAG,IAAI;AACP;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,KAAK,IAAI;AACT,KAAK,GAAG;AACR,KAAK,KAAK;AACV,KAAK,IAAI,IAAI,EAAE;AACf,KAAK,IAAI,EAAE,IAAI;AACf;AACA;AACA,KAAK,IAAI,OAAO,IAAI;AACpB,KAAK,EAAE,OAAO,EAAE;AAChB;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,sBAAsB,IAAI;AAC1B;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,IAAI;AACxC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;;AAEA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,IAAI;AACvC;AACA;AACA;AACA,gCAAgC,EAAE,EAAE,KAAK;AACzC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,wCAAwC,QAAQ;AAChD;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe,sBAAsB;AACrC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,6CAA6C;AAC7C;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,wBAAwB,QAAQ;AAChC;AACA;AACA;;AAEA,aAAa,gBAAgB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK,6CAA6C;;AAElD;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP,OAAO;AACP;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,2BAA2B;AAC3B;;;;;;;;;;;;;AC15BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AACA,IAAMA,SAAS,GAAEC,mBAAO,CAAC,0CAAD,CAAxB;;AAEA,IAAIC,IAAJ,EAAUC,QAAV,C,CACA;;AAEA,IAAIC,SAAS,GAAGH,mBAAO,CAAC,8BAAD,CAAP,CAAsBG,SAAtC;;AACA,IAAIC,OAAO,GAAGJ,mBAAO,CAAC,8BAAD,CAAP,CAAsBK,IAApC;;AACA,IAAIC,QAAQ,GAAGN,mBAAO,CAAC,8BAAD,CAAP,CAAsBM,QAArC;;AACA,IAAIC,QAAQ,GAAGP,mBAAO,CAAC,wCAAD,CAAtB;;AACA,IAAIQ,KAAK,GAAGR,mBAAO,CAAC,8BAAD,CAAP,CAAsBQ,KAAlC;;AACA,IAAIC,WAAW,GAAGT,mBAAO,CAAC,8BAAD,CAAP,CAAsBS,WAAxC;;AAGO,SAASC,WAAT,CAAqBC,OA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","file":"__darkmode-system.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/darkmode-system.js\");\n","'use strict';\nmodule.exports = balanced;\nfunction balanced(a, b, str) {\n  if (a instanceof RegExp) a = maybeMatch(a, str);\n  if (b instanceof RegExp) b = maybeMatch(b, str);\n\n  var r = range(a, b, str);\n\n  return r && {\n    start: r[0],\n    end: r[1],\n    pre: str.slice(0, r[0]),\n    body: str.slice(r[0] + a.length, r[1]),\n    post: str.slice(r[1] + b.length)\n  };\n}\n\nfunction maybeMatch(reg, str) {\n  var m = str.match(reg);\n  return m ? m[0] : null;\n}\n\nbalanced.range = range;\nfunction range(a, b, str) {\n  var begs, beg, left, right, result;\n  var ai = str.indexOf(a);\n  var bi = str.indexOf(b, ai + 1);\n  var i = ai;\n\n  if (ai >= 0 && bi > 0) {\n    begs = [];\n    left = str.length;\n\n    while (i >= 0 && !result) {\n      if (i == ai) {\n        begs.push(i);\n        ai = str.indexOf(a, i + 1);\n      } else if (begs.length == 1) {\n        result = [ begs.pop(), bi ];\n      } else {\n        beg = begs.pop();\n        if (beg < left) {\n          left = beg;\n          right = bi;\n        }\n\n        bi = str.indexOf(b, i + 1);\n      }\n\n      i = ai < bi && ai >= 0 ? ai : bi;\n    }\n\n    if (begs.length) {\n      result = [ left, right ];\n    }\n  }\n\n  return result;\n}\n","var concatMap = require('concat-map');\nvar balanced = require('balanced-match');\n\nmodule.exports = expandTop;\n\nvar escSlash = '\\0SLASH'+Math.random()+'\\0';\nvar escOpen = '\\0OPEN'+Math.random()+'\\0';\nvar escClose = '\\0CLOSE'+Math.random()+'\\0';\nvar escComma = '\\0COMMA'+Math.random()+'\\0';\nvar escPeriod = '\\0PERIOD'+Math.random()+'\\0';\n\nfunction numeric(str) {\n  return parseInt(str, 10) == str\n    ? parseInt(str, 10)\n    : str.charCodeAt(0);\n}\n\nfunction escapeBraces(str) {\n  return str.split('\\\\\\\\').join(escSlash)\n            .split('\\\\{').join(escOpen)\n            .split('\\\\}').join(escClose)\n            .split('\\\\,').join(escComma)\n            .split('\\\\.').join(escPeriod);\n}\n\nfunction unescapeBraces(str) {\n  return str.split(escSlash).join('\\\\')\n            .split(escOpen).join('{')\n            .split(escClose).join('}')\n            .split(escComma).join(',')\n            .split(escPeriod).join('.');\n}\n\n\n// Basically just str.split(\",\"), but handling cases\n// where we have nested braced sections, which should be\n// treated as individual members, like {a,{b,c},d}\nfunction parseCommaParts(str) {\n  if (!str)\n    return [''];\n\n  var parts = [];\n  var m = balanced('{', '}', str);\n\n  if (!m)\n    return str.split(',');\n\n  var pre = m.pre;\n  var body = m.body;\n  var post = m.post;\n  var p = pre.split(',');\n\n  p[p.length-1] += '{' + body + '}';\n  var postParts = parseCommaParts(post);\n  if (post.length) {\n    p[p.length-1] += postParts.shift();\n    p.push.apply(p, postParts);\n  }\n\n  parts.push.apply(parts, p);\n\n  return parts;\n}\n\nfunction expandTop(str) {\n  if (!str)\n    return [];\n\n  // I don't know why Bash 4.3 does this, but it does.\n  // Anything starting with {} will have the first two bytes preserved\n  // but *only* at the top level, so {},a}b will not expand to anything,\n  // but a{},b}c will be expanded to [a}c,abc].\n  // One could argue that this is a bug in Bash, but since the goal of\n  // this module is to match Bash's rules, we escape a leading {}\n  if (str.substr(0, 2) === '{}') {\n    str = '\\\\{\\\\}' + str.substr(2);\n  }\n\n  return expand(escapeBraces(str), true).map(unescapeBraces);\n}\n\nfunction identity(e) {\n  return e;\n}\n\nfunction embrace(str) {\n  return '{' + str + '}';\n}\nfunction isPadded(el) {\n  return /^-?0\\d/.test(el);\n}\n\nfunction lte(i, y) {\n  return i <= y;\n}\nfunction gte(i, y) {\n  return i >= y;\n}\n\nfunction expand(str, isTop) {\n  var expansions = [];\n\n  var m = balanced('{', '}', str);\n  if (!m || /\\$$/.test(m.pre)) return [str];\n\n  var isNumericSequence = /^-?\\d+\\.\\.-?\\d+(?:\\.\\.-?\\d+)?$/.test(m.body);\n  var isAlphaSequence = /^[a-zA-Z]\\.\\.[a-zA-Z](?:\\.\\.-?\\d+)?$/.test(m.body);\n  var isSequence = isNumericSequence || isAlphaSequence;\n  var isOptions = m.body.indexOf(',') >= 0;\n  if (!isSequence && !isOptions) {\n    // {a},b}\n    if (m.post.match(/,.*\\}/)) {\n      str = m.pre + '{' + m.body + escClose + m.post;\n      return expand(str);\n    }\n    return [str];\n  }\n\n  var n;\n  if (isSequence) {\n    n = m.body.split(/\\.\\./);\n  } else {\n    n = parseCommaParts(m.body);\n    if (n.length === 1) {\n      // x{{a,b}}y ==> x{a}y x{b}y\n      n = expand(n[0], false).map(embrace);\n      if (n.length === 1) {\n        var post = m.post.length\n          ? expand(m.post, false)\n          : [''];\n        return post.map(function(p) {\n          return m.pre + n[0] + p;\n        });\n      }\n    }\n  }\n\n  // at this point, n is the parts, and we know it's not a comma set\n  // with a single entry.\n\n  // no need to expand pre, since it is guaranteed to be free of brace-sets\n  var pre = m.pre;\n  var post = m.post.length\n    ? expand(m.post, false)\n    : [''];\n\n  var N;\n\n  if (isSequence) {\n    var x = numeric(n[0]);\n    var y = numeric(n[1]);\n    var width = Math.max(n[0].length, n[1].length)\n    var incr = n.length == 3\n      ? Math.abs(numeric(n[2]))\n      : 1;\n    var test = lte;\n    var reverse = y < x;\n    if (reverse) {\n      incr *= -1;\n      test = gte;\n    }\n    var pad = n.some(isPadded);\n\n    N = [];\n\n    for (var i = x; test(i, y); i += incr) {\n      var c;\n      if (isAlphaSequence) {\n        c = String.fromCharCode(i);\n        if (c === '\\\\')\n          c = '';\n      } else {\n        c = String(i);\n        if (pad) {\n          var need = width - c.length;\n          if (need > 0) {\n            var z = new Array(need + 1).join('0');\n            if (i < 0)\n              c = '-' + z + c.slice(1);\n            else\n              c = z + c;\n          }\n        }\n      }\n      N.push(c);\n    }\n  } else {\n    N = concatMap(n, function(el) { return expand(el, false) });\n  }\n\n  for (var j = 0; j < N.length; j++) {\n    for (var k = 0; k < post.length; k++) {\n      var expansion = pre + N[j] + post[k];\n      if (!isTop || isSequence || expansion)\n        expansions.push(expansion);\n    }\n  }\n\n  return expansions;\n}\n\n","module.exports = function (xs, fn) {\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        var x = fn(xs[i], i);\n        if (isArray(x)) res.push.apply(res, x);\n        else res.push(x);\n    }\n    return res;\n};\n\nvar isArray = Array.isArray || function (xs) {\n    return Object.prototype.toString.call(xs) === '[object Array]';\n};\n","module.exports = minimatch\nminimatch.Minimatch = Minimatch\n\nvar path = { sep: '/' }\ntry {\n  path = require('path')\n} catch (er) {}\n\nvar GLOBSTAR = minimatch.GLOBSTAR = Minimatch.GLOBSTAR = {}\nvar expand = require('brace-expansion')\n\nvar plTypes = {\n  '!': { open: '(?:(?!(?:', close: '))[^/]*?)'},\n  '?': { open: '(?:', close: ')?' },\n  '+': { open: '(?:', close: ')+' },\n  '*': { open: '(?:', close: ')*' },\n  '@': { open: '(?:', close: ')' }\n}\n\n// any single thing other than /\n// don't need to escape / when using new RegExp()\nvar qmark = '[^/]'\n\n// * => any number of characters\nvar star = qmark + '*?'\n\n// ** when dots are allowed.  Anything goes, except .. and .\n// not (^ or / followed by one or two dots followed by $ or /),\n// followed by anything, any number of times.\nvar twoStarDot = '(?:(?!(?:\\\\\\/|^)(?:\\\\.{1,2})($|\\\\\\/)).)*?'\n\n// not a ^ or / followed by a dot,\n// followed by anything, any number of times.\nvar twoStarNoDot = '(?:(?!(?:\\\\\\/|^)\\\\.).)*?'\n\n// characters that need to be escaped in RegExp.\nvar reSpecials = charSet('().*{}+?[]^$\\\\!')\n\n// \"abc\" -> { a:true, b:true, c:true }\nfunction charSet (s) {\n  return s.split('').reduce(function (set, c) {\n    set[c] = true\n    return set\n  }, {})\n}\n\n// normalizes slashes.\nvar slashSplit = /\\/+/\n\nminimatch.filter = filter\nfunction filter (pattern, options) {\n  options = options || {}\n  return function (p, i, list) {\n    return minimatch(p, pattern, options)\n  }\n}\n\nfunction ext (a, b) {\n  a = a || {}\n  b = b || {}\n  var t = {}\n  Object.keys(b).forEach(function (k) {\n    t[k] = b[k]\n  })\n  Object.keys(a).forEach(function (k) {\n    t[k] = a[k]\n  })\n  return t\n}\n\nminimatch.defaults = function (def) {\n  if (!def || !Object.keys(def).length) return minimatch\n\n  var orig = minimatch\n\n  var m = function minimatch (p, pattern, options) {\n    return orig.minimatch(p, pattern, ext(def, options))\n  }\n\n  m.Minimatch = function Minimatch (pattern, options) {\n    return new orig.Minimatch(pattern, ext(def, options))\n  }\n\n  return m\n}\n\nMinimatch.defaults = function (def) {\n  if (!def || !Object.keys(def).length) return Minimatch\n  return minimatch.defaults(def).Minimatch\n}\n\nfunction minimatch (p, pattern, options) {\n  if (typeof pattern !== 'string') {\n    throw new TypeError('glob pattern string required')\n  }\n\n  if (!options) options = {}\n\n  // shortcut: comments match nothing.\n  if (!options.nocomment && pattern.charAt(0) === '#') {\n    return false\n  }\n\n  // \"\" only matches \"\"\n  if (pattern.trim() === '') return p === ''\n\n  return new Minimatch(pattern, options).match(p)\n}\n\nfunction Minimatch (pattern, options) {\n  if (!(this instanceof Minimatch)) {\n    return new Minimatch(pattern, options)\n  }\n\n  if (typeof pattern !== 'string') {\n    throw new TypeError('glob pattern string required')\n  }\n\n  if (!options) options = {}\n  pattern = pattern.trim()\n\n  // windows support: need to use /, not \\\n  if (path.sep !== '/') {\n    pattern = pattern.split(path.sep).join('/')\n  }\n\n  this.options = options\n  this.set = []\n  this.pattern = pattern\n  this.regexp = null\n  this.negate = false\n  this.comment = false\n  this.empty = false\n\n  // make the set of regexps etc.\n  this.make()\n}\n\nMinimatch.prototype.debug = function () {}\n\nMinimatch.prototype.make = make\nfunction make () {\n  // don't do it more than once.\n  if (this._made) return\n\n  var pattern = this.pattern\n  var options = this.options\n\n  // empty patterns and comments match nothing.\n  if (!options.nocomment && pattern.charAt(0) === '#') {\n    this.comment = true\n    return\n  }\n  if (!pattern) {\n    this.empty = true\n    return\n  }\n\n  // step 1: figure out negation, etc.\n  this.parseNegate()\n\n  // step 2: expand braces\n  var set = this.globSet = this.braceExpand()\n\n  if (options.debug) this.debug = console.error\n\n  this.debug(this.pattern, set)\n\n  // step 3: now we have a set, so turn each one into a series of path-portion\n  // matching patterns.\n  // These will be regexps, except in the case of \"**\", which is\n  // set to the GLOBSTAR object for globstar behavior,\n  // and will not contain any / characters\n  set = this.globParts = set.map(function (s) {\n    return s.split(slashSplit)\n  })\n\n  this.debug(this.pattern, set)\n\n  // glob --> regexps\n  set = set.map(function (s, si, set) {\n    return s.map(this.parse, this)\n  }, this)\n\n  this.debug(this.pattern, set)\n\n  // filter out everything that didn't compile properly.\n  set = set.filter(function (s) {\n    return s.indexOf(false) === -1\n  })\n\n  this.debug(this.pattern, set)\n\n  this.set = set\n}\n\nMinimatch.prototype.parseNegate = parseNegate\nfunction parseNegate () {\n  var pattern = this.pattern\n  var negate = false\n  var options = this.options\n  var negateOffset = 0\n\n  if (options.nonegate) return\n\n  for (var i = 0, l = pattern.length\n    ; i < l && pattern.charAt(i) === '!'\n    ; i++) {\n    negate = !negate\n    negateOffset++\n  }\n\n  if (negateOffset) this.pattern = pattern.substr(negateOffset)\n  this.negate = negate\n}\n\n// Brace expansion:\n// a{b,c}d -> abd acd\n// a{b,}c -> abc ac\n// a{0..3}d -> a0d a1d a2d a3d\n// a{b,c{d,e}f}g -> abg acdfg acefg\n// a{b,c}d{e,f}g -> abdeg acdeg abdeg abdfg\n//\n// Invalid sets are not expanded.\n// a{2..}b -> a{2..}b\n// a{b}c -> a{b}c\nminimatch.braceExpand = function (pattern, options) {\n  return braceExpand(pattern, options)\n}\n\nMinimatch.prototype.braceExpand = braceExpand\n\nfunction braceExpand (pattern, options) {\n  if (!options) {\n    if (this instanceof Minimatch) {\n      options = this.options\n    } else {\n      options = {}\n    }\n  }\n\n  pattern = typeof pattern === 'undefined'\n    ? this.pattern : pattern\n\n  if (typeof pattern === 'undefined') {\n    throw new TypeError('undefined pattern')\n  }\n\n  if (options.nobrace ||\n    !pattern.match(/\\{.*\\}/)) {\n    // shortcut. no need to expand.\n    return [pattern]\n  }\n\n  return expand(pattern)\n}\n\n// parse a component of the expanded set.\n// At this point, no pattern may contain \"/\" in it\n// so we're going to return a 2d array, where each entry is the full\n// pattern, split on '/', and then turned into a regular expression.\n// A regexp is made at the end which joins each array with an\n// escaped /, and another full one which joins each regexp with |.\n//\n// Following the lead of Bash 4.1, note that \"**\" only has special meaning\n// when it is the *only* thing in a path portion.  Otherwise, any series\n// of * is equivalent to a single *.  Globstar behavior is enabled by\n// default, and can be disabled by setting options.noglobstar.\nMinimatch.prototype.parse = parse\nvar SUBPARSE = {}\nfunction parse (pattern, isSub) {\n  if (pattern.length > 1024 * 64) {\n    throw new TypeError('pattern is too long')\n  }\n\n  var options = this.options\n\n  // shortcuts\n  if (!options.noglobstar && pattern === '**') return GLOBSTAR\n  if (pattern === '') return ''\n\n  var re = ''\n  var hasMagic = !!options.nocase\n  var escaping = false\n  // ? => one single character\n  var patternListStack = []\n  var negativeLists = []\n  var stateChar\n  var inClass = false\n  var reClassStart = -1\n  var classStart = -1\n  // . and .. never match anything that doesn't start with .,\n  // even when options.dot is set.\n  var patternStart = pattern.charAt(0) === '.' ? '' // anything\n  // not (start or / followed by . or .. followed by / or end)\n  : options.dot ? '(?!(?:^|\\\\\\/)\\\\.{1,2}(?:$|\\\\\\/))'\n  : '(?!\\\\.)'\n  var self = this\n\n  function clearStateChar () {\n    if (stateChar) {\n      // we had some state-tracking character\n      // that wasn't consumed by this pass.\n      switch (stateChar) {\n        case '*':\n          re += star\n          hasMagic = true\n        break\n        case '?':\n          re += qmark\n          hasMagic = true\n        break\n        default:\n          re += '\\\\' + stateChar\n        break\n      }\n      self.debug('clearStateChar %j %j', stateChar, re)\n      stateChar = false\n    }\n  }\n\n  for (var i = 0, len = pattern.length, c\n    ; (i < len) && (c = pattern.charAt(i))\n    ; i++) {\n    this.debug('%s\\t%s %s %j', pattern, i, re, c)\n\n    // skip over any that are escaped.\n    if (escaping && reSpecials[c]) {\n      re += '\\\\' + c\n      escaping = false\n      continue\n    }\n\n    switch (c) {\n      case '/':\n        // completely not allowed, even escaped.\n        // Should already be path-split by now.\n        return false\n\n      case '\\\\':\n        clearStateChar()\n        escaping = true\n      continue\n\n      // the various stateChar values\n      // for the \"extglob\" stuff.\n      case '?':\n      case '*':\n      case '+':\n      case '@':\n      case '!':\n        this.debug('%s\\t%s %s %j <-- stateChar', pattern, i, re, c)\n\n        // all of those are literals inside a class, except that\n        // the glob [!a] means [^a] in regexp\n        if (inClass) {\n          this.debug('  in class')\n          if (c === '!' && i === classStart + 1) c = '^'\n          re += c\n          continue\n        }\n\n        // if we already have a stateChar, then it means\n        // that there was something like ** or +? in there.\n        // Handle the stateChar, then proceed with this one.\n        self.debug('call clearStateChar %j', stateChar)\n        clearStateChar()\n        stateChar = c\n        // if extglob is disabled, then +(asdf|foo) isn't a thing.\n        // just clear the statechar *now*, rather than even diving into\n        // the patternList stuff.\n        if (options.noext) clearStateChar()\n      continue\n\n      case '(':\n        if (inClass) {\n          re += '('\n          continue\n        }\n\n        if (!stateChar) {\n          re += '\\\\('\n          continue\n        }\n\n        patternListStack.push({\n          type: stateChar,\n          start: i - 1,\n          reStart: re.length,\n          open: plTypes[stateChar].open,\n          close: plTypes[stateChar].close\n        })\n        // negation is (?:(?!js)[^/]*)\n        re += stateChar === '!' ? '(?:(?!(?:' : '(?:'\n        this.debug('plType %j %j', stateChar, re)\n        stateChar = false\n      continue\n\n      case ')':\n        if (inClass || !patternListStack.length) {\n          re += '\\\\)'\n          continue\n        }\n\n        clearStateChar()\n        hasMagic = true\n        var pl = patternListStack.pop()\n        // negation is (?:(?!js)[^/]*)\n        // The others are (?:<pattern>)<type>\n        re += pl.close\n        if (pl.type === '!') {\n          negativeLists.push(pl)\n        }\n        pl.reEnd = re.length\n      continue\n\n      case '|':\n        if (inClass || !patternListStack.length || escaping) {\n          re += '\\\\|'\n          escaping = false\n          continue\n        }\n\n        clearStateChar()\n        re += '|'\n      continue\n\n      // these are mostly the same in regexp and glob\n      case '[':\n        // swallow any state-tracking char before the [\n        clearStateChar()\n\n        if (inClass) {\n          re += '\\\\' + c\n          continue\n        }\n\n        inClass = true\n        classStart = i\n        reClassStart = re.length\n        re += c\n      continue\n\n      case ']':\n        //  a right bracket shall lose its special\n        //  meaning and represent itself in\n        //  a bracket expression if it occurs\n        //  first in the list.  -- POSIX.2 2.8.3.2\n        if (i === classStart + 1 || !inClass) {\n          re += '\\\\' + c\n          escaping = false\n          continue\n        }\n\n        // handle the case where we left a class open.\n        // \"[z-a]\" is valid, equivalent to \"\\[z-a\\]\"\n        if (inClass) {\n          // split where the last [ was, make sure we don't have\n          // an invalid re. if so, re-walk the contents of the\n          // would-be class to re-translate any characters that\n          // were passed through as-is\n          // TODO: It would probably be faster to determine this\n          // without a try/catch and a new RegExp, but it's tricky\n          // to do safely.  For now, this is safe and works.\n          var cs = pattern.substring(classStart + 1, i)\n          try {\n            RegExp('[' + cs + ']')\n          } catch (er) {\n            // not a valid class!\n            var sp = this.parse(cs, SUBPARSE)\n            re = re.substr(0, reClassStart) + '\\\\[' + sp[0] + '\\\\]'\n            hasMagic = hasMagic || sp[1]\n            inClass = false\n            continue\n          }\n        }\n\n        // finish up the class.\n        hasMagic = true\n        inClass = false\n        re += c\n      continue\n\n      default:\n        // swallow any state char that wasn't consumed\n        clearStateChar()\n\n        if (escaping) {\n          // no need\n          escaping = false\n        } else if (reSpecials[c]\n          && !(c === '^' && inClass)) {\n          re += '\\\\'\n        }\n\n        re += c\n\n    } // switch\n  } // for\n\n  // handle the case where we left a class open.\n  // \"[abc\" is valid, equivalent to \"\\[abc\"\n  if (inClass) {\n    // split where the last [ was, and escape it\n    // this is a huge pita.  We now have to re-walk\n    // the contents of the would-be class to re-translate\n    // any characters that were passed through as-is\n    cs = pattern.substr(classStart + 1)\n    sp = this.parse(cs, SUBPARSE)\n    re = re.substr(0, reClassStart) + '\\\\[' + sp[0]\n    hasMagic = hasMagic || sp[1]\n  }\n\n  // handle the case where we had a +( thing at the *end*\n  // of the pattern.\n  // each pattern list stack adds 3 chars, and we need to go through\n  // and escape any | chars that were passed through as-is for the regexp.\n  // Go through and escape them, taking care not to double-escape any\n  // | chars that were already escaped.\n  for (pl = patternListStack.pop(); pl; pl = patternListStack.pop()) {\n    var tail = re.slice(pl.reStart + pl.open.length)\n    this.debug('setting tail', re, pl)\n    // maybe some even number of \\, then maybe 1 \\, followed by a |\n    tail = tail.replace(/((?:\\\\{2}){0,64})(\\\\?)\\|/g, function (_, $1, $2) {\n      if (!$2) {\n        // the | isn't already escaped, so escape it.\n        $2 = '\\\\'\n      }\n\n      // need to escape all those slashes *again*, without escaping the\n      // one that we need for escaping the | character.  As it works out,\n      // escaping an even number of slashes can be done by simply repeating\n      // it exactly after itself.  That's why this trick works.\n      //\n      // I am sorry that you have to see this.\n      return $1 + $1 + $2 + '|'\n    })\n\n    this.debug('tail=%j\\n   %s', tail, tail, pl, re)\n    var t = pl.type === '*' ? star\n      : pl.type === '?' ? qmark\n      : '\\\\' + pl.type\n\n    hasMagic = true\n    re = re.slice(0, pl.reStart) + t + '\\\\(' + tail\n  }\n\n  // handle trailing things that only matter at the very end.\n  clearStateChar()\n  if (escaping) {\n    // trailing \\\\\n    re += '\\\\\\\\'\n  }\n\n  // only need to apply the nodot start if the re starts with\n  // something that could conceivably capture a dot\n  var addPatternStart = false\n  switch (re.charAt(0)) {\n    case '.':\n    case '[':\n    case '(': addPatternStart = true\n  }\n\n  // Hack to work around lack of negative lookbehind in JS\n  // A pattern like: *.!(x).!(y|z) needs to ensure that a name\n  // like 'a.xyz.yz' doesn't match.  So, the first negative\n  // lookahead, has to look ALL the way ahead, to the end of\n  // the pattern.\n  for (var n = negativeLists.length - 1; n > -1; n--) {\n    var nl = negativeLists[n]\n\n    var nlBefore = re.slice(0, nl.reStart)\n    var nlFirst = re.slice(nl.reStart, nl.reEnd - 8)\n    var nlLast = re.slice(nl.reEnd - 8, nl.reEnd)\n    var nlAfter = re.slice(nl.reEnd)\n\n    nlLast += nlAfter\n\n    // Handle nested stuff like *(*.js|!(*.json)), where open parens\n    // mean that we should *not* include the ) in the bit that is considered\n    // \"after\" the negated section.\n    var openParensBefore = nlBefore.split('(').length - 1\n    var cleanAfter = nlAfter\n    for (i = 0; i < openParensBefore; i++) {\n      cleanAfter = cleanAfter.replace(/\\)[+*?]?/, '')\n    }\n    nlAfter = cleanAfter\n\n    var dollar = ''\n    if (nlAfter === '' && isSub !== SUBPARSE) {\n      dollar = '$'\n    }\n    var newRe = nlBefore + nlFirst + nlAfter + dollar + nlLast\n    re = newRe\n  }\n\n  // if the re is not \"\" at this point, then we need to make sure\n  // it doesn't match against an empty path part.\n  // Otherwise a/* will match a/, which it should not.\n  if (re !== '' && hasMagic) {\n    re = '(?=.)' + re\n  }\n\n  if (addPatternStart) {\n    re = patternStart + re\n  }\n\n  // parsing just a piece of a larger pattern.\n  if (isSub === SUBPARSE) {\n    return [re, hasMagic]\n  }\n\n  // skip the regexp for non-magical patterns\n  // unescape anything in it, though, so that it'll be\n  // an exact match against a file etc.\n  if (!hasMagic) {\n    return globUnescape(pattern)\n  }\n\n  var flags = options.nocase ? 'i' : ''\n  try {\n    var regExp = new RegExp('^' + re + '$', flags)\n  } catch (er) {\n    // If it was an invalid regular expression, then it can't match\n    // anything.  This trick looks for a character after the end of\n    // the string, which is of course impossible, except in multi-line\n    // mode, but it's not a /m regex.\n    return new RegExp('$.')\n  }\n\n  regExp._glob = pattern\n  regExp._src = re\n\n  return regExp\n}\n\nminimatch.makeRe = function (pattern, options) {\n  return new Minimatch(pattern, options || {}).makeRe()\n}\n\nMinimatch.prototype.makeRe = makeRe\nfunction makeRe () {\n  if (this.regexp || this.regexp === false) return this.regexp\n\n  // at this point, this.set is a 2d array of partial\n  // pattern strings, or \"**\".\n  //\n  // It's better to use .match().  This function shouldn't\n  // be used, really, but it's pretty convenient sometimes,\n  // when you just want to work with a regex.\n  var set = this.set\n\n  if (!set.length) {\n    this.regexp = false\n    return this.regexp\n  }\n  var options = this.options\n\n  var twoStar = options.noglobstar ? star\n    : options.dot ? twoStarDot\n    : twoStarNoDot\n  var flags = options.nocase ? 'i' : ''\n\n  var re = set.map(function (pattern) {\n    return pattern.map(function (p) {\n      return (p === GLOBSTAR) ? twoStar\n      : (typeof p === 'string') ? regExpEscape(p)\n      : p._src\n    }).join('\\\\\\/')\n  }).join('|')\n\n  // must match entire pattern\n  // ending in a * or ** will make it less strict.\n  re = '^(?:' + re + ')$'\n\n  // can match anything, as long as it's not this.\n  if (this.negate) re = '^(?!' + re + ').*$'\n\n  try {\n    this.regexp = new RegExp(re, flags)\n  } catch (ex) {\n    this.regexp = false\n  }\n  return this.regexp\n}\n\nminimatch.match = function (list, pattern, options) {\n  options = options || {}\n  var mm = new Minimatch(pattern, options)\n  list = list.filter(function (f) {\n    return mm.match(f)\n  })\n  if (mm.options.nonull && !list.length) {\n    list.push(pattern)\n  }\n  return list\n}\n\nMinimatch.prototype.match = match\nfunction match (f, partial) {\n  this.debug('match', f, this.pattern)\n  // short-circuit in the case of busted things.\n  // comments, etc.\n  if (this.comment) return false\n  if (this.empty) return f === ''\n\n  if (f === '/' && partial) return true\n\n  var options = this.options\n\n  // windows: need to use /, not \\\n  if (path.sep !== '/') {\n    f = f.split(path.sep).join('/')\n  }\n\n  // treat the test path as a set of pathparts.\n  f = f.split(slashSplit)\n  this.debug(this.pattern, 'split', f)\n\n  // just ONE of the pattern sets in this.set needs to match\n  // in order for it to be valid.  If negating, then just one\n  // match means that we have failed.\n  // Either way, return on the first hit.\n\n  var set = this.set\n  this.debug(this.pattern, 'set', set)\n\n  // Find the basename of the path by looking for the last non-empty segment\n  var filename\n  var i\n  for (i = f.length - 1; i >= 0; i--) {\n    filename = f[i]\n    if (filename) break\n  }\n\n  for (i = 0; i < set.length; i++) {\n    var pattern = set[i]\n    var file = f\n    if (options.matchBase && pattern.length === 1) {\n      file = [filename]\n    }\n    var hit = this.matchOne(file, pattern, partial)\n    if (hit) {\n      if (options.flipNegate) return true\n      return !this.negate\n    }\n  }\n\n  // didn't get any hits.  this is success if it's a negative\n  // pattern, failure otherwise.\n  if (options.flipNegate) return false\n  return this.negate\n}\n\n// set partial to true to test if, for example,\n// \"/a/b\" matches the start of \"/*/b/*/d\"\n// Partial means, if you run out of file before you run\n// out of pattern, then that's fine, as long as all\n// the parts match.\nMinimatch.prototype.matchOne = function (file, pattern, partial) {\n  var options = this.options\n\n  this.debug('matchOne',\n    { 'this': this, file: file, pattern: pattern })\n\n  this.debug('matchOne', file.length, pattern.length)\n\n  for (var fi = 0,\n      pi = 0,\n      fl = file.length,\n      pl = pattern.length\n      ; (fi < fl) && (pi < pl)\n      ; fi++, pi++) {\n    this.debug('matchOne loop')\n    var p = pattern[pi]\n    var f = file[fi]\n\n    this.debug(pattern, p, f)\n\n    // should be impossible.\n    // some invalid regexp stuff in the set.\n    if (p === false) return false\n\n    if (p === GLOBSTAR) {\n      this.debug('GLOBSTAR', [pattern, p, f])\n\n      // \"**\"\n      // a/**/b/**/c would match the following:\n      // a/b/x/y/z/c\n      // a/x/y/z/b/c\n      // a/b/x/b/x/c\n      // a/b/c\n      // To do this, take the rest of the pattern after\n      // the **, and see if it would match the file remainder.\n      // If so, return success.\n      // If not, the ** \"swallows\" a segment, and try again.\n      // This is recursively awful.\n      //\n      // a/**/b/**/c matching a/b/x/y/z/c\n      // - a matches a\n      // - doublestar\n      //   - matchOne(b/x/y/z/c, b/**/c)\n      //     - b matches b\n      //     - doublestar\n      //       - matchOne(x/y/z/c, c) -> no\n      //       - matchOne(y/z/c, c) -> no\n      //       - matchOne(z/c, c) -> no\n      //       - matchOne(c, c) yes, hit\n      var fr = fi\n      var pr = pi + 1\n      if (pr === pl) {\n        this.debug('** at the end')\n        // a ** at the end will just swallow the rest.\n        // We have found a match.\n        // however, it will not swallow /.x, unless\n        // options.dot is set.\n        // . and .. are *never* matched by **, for explosively\n        // exponential reasons.\n        for (; fi < fl; fi++) {\n          if (file[fi] === '.' || file[fi] === '..' ||\n            (!options.dot && file[fi].charAt(0) === '.')) return false\n        }\n        return true\n      }\n\n      // ok, let's see if we can swallow whatever we can.\n      while (fr < fl) {\n        var swallowee = file[fr]\n\n        this.debug('\\nglobstar while', file, fr, pattern, pr, swallowee)\n\n        // XXX remove this slice.  Just pass the start index.\n        if (this.matchOne(file.slice(fr), pattern.slice(pr), partial)) {\n          this.debug('globstar found match!', fr, fl, swallowee)\n          // found a match.\n          return true\n        } else {\n          // can't swallow \".\" or \"..\" ever.\n          // can only swallow \".foo\" when explicitly asked.\n          if (swallowee === '.' || swallowee === '..' ||\n            (!options.dot && swallowee.charAt(0) === '.')) {\n            this.debug('dot detected!', file, fr, pattern, pr)\n            break\n          }\n\n          // ** swallows a segment, and continue.\n          this.debug('globstar swallow a segment, and continue')\n          fr++\n        }\n      }\n\n      // no match was found.\n      // However, in partial mode, we can't say this is necessarily over.\n      // If there's more *pattern* left, then\n      if (partial) {\n        // ran out of file\n        this.debug('\\n>>> no match, partial?', file, fr, pattern, pr)\n        if (fr === fl) return true\n      }\n      return false\n    }\n\n    // something other than **\n    // non-magic patterns just have to match exactly\n    // patterns with magic have been turned into regexps.\n    var hit\n    if (typeof p === 'string') {\n      if (options.nocase) {\n        hit = f.toLowerCase() === p.toLowerCase()\n      } else {\n        hit = f === p\n      }\n      this.debug('string match', p, f, hit)\n    } else {\n      hit = f.match(p)\n      this.debug('pattern match', p, f, hit)\n    }\n\n    if (!hit) return false\n  }\n\n  // Note: ending in / means that we'll get a final \"\"\n  // at the end of the pattern.  This can only match a\n  // corresponding \"\" at the end of the file.\n  // If the file ends in /, then it can only match a\n  // a pattern that ends in /, unless the pattern just\n  // doesn't have any more for it. But, a/b/ should *not*\n  // match \"a/b/*\", even though \"\" matches against the\n  // [^/]*? pattern, except in partial mode, where it might\n  // simply not be reached yet.\n  // However, a/b/ should still satisfy a/*\n\n  // now either we fell off the end of the pattern, or we're done.\n  if (fi === fl && pi === pl) {\n    // ran out of pattern and filename at the same time.\n    // an exact hit!\n    return true\n  } else if (fi === fl) {\n    // ran out of file, but still had pattern left.\n    // this is ok if we're doing the match as part of\n    // a glob fs traversal.\n    return partial\n  } else if (pi === pl) {\n    // ran out of pattern, still have file left.\n    // this is only acceptable if we're on the very last\n    // empty segment of a file with a trailing slash.\n    // a/* should match a/b/\n    var emptyFileEnd = (fi === fl - 1) && (file[fi] === '')\n    return emptyFileEnd\n  }\n\n  // should be unreachable.\n  throw new Error('wtf?')\n}\n\n// replace stuff like \\* with *\nfunction globUnescape (s) {\n  return s.replace(/\\\\(.)/g, '$1')\n}\n\nfunction regExpEscape (s) {\n  return s.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&')\n}\n","import sketch from 'sketch';\nconst functions= require('./functions.js');\n\nvar page, pageInfo;\n// Config\n\nlet Rectangle = require('sketch/dom').Rectangle;\nlet TextDom = require('sketch/dom').Text;\nlet Artboard = require('sketch/dom').Artboard\nlet Settings = require('sketch/settings');\nlet Style = require('sketch/dom').Style;\nlet SharedStyle = require('sketch/dom').SharedStyle;\n\n\nexport function getSettings(context) {\n  DarkModeSystem(context,\"settings\");\n  \n}\nexport function deleteAll(context) {\n  DarkModeSystem(context,\"delete\");\n  \n}\nexport function documentColors(context) {\n  DarkModeSystem(context,\"colors\");\n  \n}\nexport function DeleteAllSettings(context) {\n  DarkModeSystem(context,\"deletesettings\");\n}\n\nexport function switchDark(context) {\n  DarkModeSystem(context,\"switchDark\");\n}\nexport function switchLight(context) {\n  DarkModeSystem(context,\"switchLight\");\n}\n\n\nexport function createDarkmode(context) {\n\n /*\n\n  Settings.setSettingForKey('Styles', []);\n  Settings.setSettingForKey('Styles', []);\n\n  var get_settign_S=Settings.settingForKey('Styles');\n  \n  console.log(get_settign_S);\n  */\n\tDarkModeSystem(context,\"darkmode\");\n}\n\n\nfunction DarkModeSystem(context,type) {\n  var labels_alignments =[ \"Left\", \"Right\", \"Center\"];\n\n  var pluginName = \"DarkMode System\",\n\tpluginDomain = \"DarkModeSystem\";\n\n  var document = sketch.getSelectedDocument();\n  \n\t// Page variables\n\tpage = context.document.currentPage(),\n  pageInfo = page.userInfo();\n  \n  var fieldHeight = 22,\n  fieldWidth = 60,\n  labelHeight = 16,\n  leftColWidth = 120,\n  settingPad = 10,\n  settingX = 0,\n  settingY = 30,\n  switchHeight = 16,\n  textOffset = 2,\n  windowHeight =(labelHeight*7)+(settingPad*7)+50,\n  windowWidth = 600;\n  \n  \n  // Setting variables\n  var get_settign_S=Settings.settingForKey('Styles');\n  if(get_settign_S == null){\n    Settings.setSettingForKey('Styles', []);\n\n  }\n\n\n\n\n  // ------- ------- ------- -------\n  // darkmode AREA\n\t// ------- ------- ------- -------  \n\tif (type && type == \"darkmode\") {\n    var document = sketch.getSelectedDocument();\n    var page = context.document.currentPage();\n    var s_styles= Settings.settingForKey('Styles');\n    //Settings.setDocumentSettingForKey(document, 'Font', groupdefaultFont.indexOfSelectedItem());\n    \n    \n    //create Modal\n    var s_colors= Settings.documentSettingForKey(document, 'colors');\n\n\n\t\tvar alert = NSAlert.alloc().init(),\n\t\talertIconPath = context.plugin.urlForResourceNamed(\"icon.png\").path(),\n\t\talertIcon = NSImage.alloc().initByReferencingFile(alertIconPath),\n\t\talertContent = NSView.alloc().init();\n    alertContent = NSView.alloc().initWithFrame(NSMakeRect(0, 0, windowWidth, windowHeight));\n\n\n    //explaining process\n    //FONT FAMILY\n    var col_width= windowWidth/4 - 10;\n      var groupdefaultFont_label = functions.createLabel(\"Clean Unvalid Settings\",12,NSMakeRect(0,settingY + textOffset,col_width,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n    var groupdefaultFont_label = functions.createLabel(\"Sync Layers with SharedStyles\",12,NSMakeRect(col_width+10,settingY + textOffset,col_width,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n    var groupdefaultFont_label = functions.createLabel(\"Create DarkMode Version\",12,NSMakeRect((col_width+10)*2,settingY + textOffset,col_width,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n    var groupdefaultFont_label = functions.createLabel(\"Switch to DarkMode \",12,NSMakeRect((col_width+10)*3,settingY + textOffset,col_width,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + 5;\n    var groupdefaultFont_label = functions.createBoldLabel(\"Step 1\",12,NSMakeRect(0,settingY + textOffset,col_width,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n    var groupdefaultFont_label = functions.createBoldLabel(\"Step 2\",12,NSMakeRect((col_width+10),settingY + textOffset,col_width,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n    var groupdefaultFont_label = functions.createBoldLabel(\"Step 3\",12,NSMakeRect((col_width+10)*2,settingY + textOffset,col_width,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n    var groupdefaultFont_label = functions.createBoldLabel(\"Step 4\",12,NSMakeRect((col_width+10)*3,settingY + textOffset,col_width,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var progress = functions.createColoredBlock(\"#fa6a00\", NSMakeRect(0,settingY,col_width,12), false);\n    alertContent.addSubview(progress);\n    var progress = functions.createColoredBlock(\"#b25f29\", NSMakeRect((col_width+10),settingY,col_width,12), false);\n    alertContent.addSubview(progress);\n    var progress = functions.createColoredBlock(\"#66422c\", NSMakeRect((col_width+10)*2,settingY,col_width,12), false);\n    alertContent.addSubview(progress);\n    var progress = functions.createColoredBlock(\"#2d2e38\", NSMakeRect((col_width+10)*3,settingY,col_width,12), false);\n    alertContent.addSubview(progress);\n\n\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var groupdefaultFont_label = functions.createBoldLabel(\"Process Overview\",15,NSMakeRect(0,settingY + textOffset,windowWidth,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n\n\n\n    //FONT FAMILY\n    var pages_available=[];\n    for(var i=0; i<document.pages.length; i++){\n      var all_shapes= sketch.find('Shape', document.pages[i]).length;\n      var all_shapesPaths= sketch.find('ShapePath', document.pages[i]).length;\n      var all_texts= sketch.find('Text', document.pages[i]).length;\n      var total= all_shapes+all_shapesPaths+all_texts;\n      pages_available.push(document.pages[i].name+\" - \"+total);\n    }\n\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + (settingPad*3);\n    var selected_page = functions.createPopUpButton(pages_available,0,NSMakeRect(0,settingY,(windowWidth/2),fieldHeight));\n    alertContent.addSubview(selected_page);\n    \n\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var groupdefaultFont_label = functions.createBoldLabel(\"Select Page to Transform\",15,NSMakeRect(0,settingY + textOffset,windowWidth,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n\n    \n\n\t\talert.setIcon(alertIcon);\n\t\talert.setMessageText(\"Create Dark Mode System\");\n\t\talert.setInformativeText(\"This might take a while....\");\n\n    alert.accessoryView = alertContent;\n\n      //BUTTONS\n      var buttonOrganize = alert.addButtonWithTitle(\"Create Dark Mode\");\n      var buttonCancel = alert.addButtonWithTitle(\"Cancel\");\n      var responseCode = alert.runModal();\n  \n  \n      if (responseCode == 1000) { //create dark mode \n\n          var reviewed_Settings= functions.reviewSettings(Settings, document);\n          Settings.setSettingForKey('Styles', reviewed_Settings);\n\n        \n          var s_page= selected_page.indexOfSelectedItem();\n          \n          var all_shapes= sketch.find('Shape', document.pages[s_page]);\n          var all_shapesPaths= sketch.find('ShapePath', document.pages[s_page]);\n          var all_texts= sketch.find('Text', document.pages[s_page]);\n\n\n          var new_styles= functions.syncLayerwithStyles_best(Settings, sketch, document, s_page);\n\n          document.sharedLayerStyles= new_styles.layer;\n          document.sharedTextStyles= new_styles.text;\n\n          var count_added=document.sharedLayerStyles.length+document.sharedTextStyles.length;\n\n          var new_styles_ids=new_styles.new_styles;      \n          var new_styles_withdark= functions.createDarkModeStyle(Settings, document, new_styles.layer, new_styles.text, new_styles.new_styles);\n\n          Settings.setSettingForKey('Styles', new_styles_withdark.settings);\n\n          document.sharedLayerStyles=  new_styles_withdark.layer; \n          document.sharedTextStyles=  new_styles_withdark.text; \n\n         // functions.SwitchDarkMode(document ,layers, new_styles_withdark.layer, new_styles_withdark.text, true);\n         var count= functions.SwitchDarkMode_best(Settings, sketch, document, s_page , new_styles_withdark.layer, new_styles_withdark.text, true);\n\n        if(count>0){\n          sketch.UI.message(' Created Dark Mode version in '+count+' Layers Sucessfully!'); \n        }else{\n          sketch.UI.message(\" All layers are already in Light Mode or haven't created a DarkMode System\"); \n\n        }   \n\n      }\n  }\n  \n    \n  // ------- ------- ------- -------\n  // Colors AREA\n\t// ------- ------- ------- -------  \n\tif (type && type == \"colors\") {\n    var count=0;\n   \n   \n    //Layer styles COlors\n    var colors_in_layer_styles= [];\n    var colors_in_layer_styles_names= [];\n    var styles_layer = document.sharedLayerStyles;\n    var s_colors= Settings.documentSettingForKey(document, 'colors');\n\n    //console.log(styles_layer);\n\n\n    //COLORS\n    var colors= s_colors;\n    var groupdefaultColorsCode = [];\n    var groupdefaultColorsCode_dark = [];\n    var groupdefaultColorsCode_block = [];\n    var groupdefaultColorsCode_block_dark = [];\n    var groupdefaultColorsName = [];\n\n    var groupdefaultColorsCode_textstyles = [];\n    var groupdefaultColorsCode_block_textstyles = [];\n    var groupdefaultColorsName_textstyles = [];\n\n    var groupdefaultColorsCode_layerstyles = [];\n    var groupdefaultColorsCode_block_layerstyles = [];\n    var groupdefaultColorsName_layerstyles = [];\n\n\n\n    for(var i=0; i<styles_layer.length; i++){\n      if( styles_layer[i].style.fills.length>0){\n\n        var layer_style_color= styles_layer[i].style.fills[0].color;\n        var repeated=0;\n        \n        for( var j=0; j<colors.length; j++){\n          if( layer_style_color == colors[j].code){\n            repeated++;\n            break;\n          }\n\n        }\n\n        for( var k=0; k<colors_in_layer_styles.length; k++){\n          if( layer_style_color == colors_in_layer_styles[k]){\n            repeated++;\n            break;\n          }\n        }\n        if(repeated==0){\n          colors_in_layer_styles.push(layer_style_color);\n          colors_in_layer_styles_names.push(styles_layer[i].name);\n        }\n\n\n    }\n  }\n\n\n    //Text styles COlors\n    var styles_list = document.sharedTextStyles;\n    var colors_in_text_styles= [];\n\n    for(var i=0; i<styles_list.length; i++){\n      var text_style_color= styles_list[i].style.textColor;\n      //console.log(text_style_color);\n      var repeated=0;\n      \n      for( var j=0; j<colors.length; j++){\n        if( text_style_color == colors[j].code){\n          repeated++;\n          break;\n        }\n\n      }\n\n      for( var k=0; k<colors_in_text_styles.length; k++){\n        if( text_style_color == colors_in_text_styles[k]){\n          repeated++;\n          break;\n        }\n      }\n      \n      if(repeated==0 && text_style_color!=undefined){\n        colors_in_text_styles.push(text_style_color);\n      }\n\n    }\n   // Settings.setDocumentSettingForKey(document, 'colors', []);\n\n\n    windowHeight = 100 + (s_colors.length*(fieldHeight+settingPad)\n                    +(colors_in_layer_styles.length* (fieldHeight+settingPad))\n                    +(colors_in_text_styles.length* (fieldHeight+settingPad))+100);\n    windowWidth = 600;\n\n\t\tvar alert = NSAlert.alloc().init(),\n\t\talertIconPath = context.plugin.urlForResourceNamed(\"icon.png\").path(),\n\t\talertIcon = NSImage.alloc().initByReferencingFile(alertIconPath),\n\t\talertContent = NSView.alloc().init();\n    alertContent = NSView.alloc().initWithFrame(NSMakeRect(0, 0, windowWidth, windowHeight));\n\n\t\talert.setIcon(alertIcon);\n\t\talert.setMessageText(\"Edit Document Colors\");\n\t\talert.setInformativeText(\"Here you can setup some of the variables that help you generate and edit your DarkMode Systems.\");\n\n    alert.accessoryView = alertContent;\n\n\n\n    groupdefaultColorsCode[colors.length] = functions.createField(\"\", NSMakeRect(40,settingY,(windowWidth/2)-50,fieldHeight));\n    alertContent.addSubview(groupdefaultColorsCode[colors.length]);\n\n    groupdefaultColorsName[colors.length] = functions.createField(\"\", NSMakeRect(windowWidth/2,settingY,windowWidth/2,fieldHeight));\n    alertContent.addSubview(groupdefaultColorsName[colors.length]);\n\n   \n    //TITLES\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var title_color_1 = functions.createLabel(\"Color Code\",12,NSMakeRect(40,settingY,(windowWidth/2)-50,fieldHeight));\n    alertContent.addSubview(title_color_1);\n\n    var title_color_2 = functions.createLabel(\"Color Name\",12,NSMakeRect(windowWidth/2,settingY,windowWidth/2,fieldHeight));\n    alertContent.addSubview(title_color_2);\n\n\n    //TITLES\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var title_color = functions.createBoldLabel(\"Add New Color\",12,NSMakeRect(0,settingY + textOffset,windowWidth-leftColWidth,labelHeight));\n    alertContent.addSubview(title_color);\n\n    // DIVIDER\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var divider_2 = functions.createDivider(NSMakeRect(0,settingY,windowWidth,1));\n    alertContent.addSubview(divider_2);\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n \n\n\n\n\n    for( var i=colors_in_layer_styles.length-1; i>=0; i--){\n      settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n      \n      groupdefaultColorsCode_block_layerstyles[i] = functions.createColoredBlock(colors_in_layer_styles[i], NSMakeRect(0,settingY,fieldHeight,fieldHeight), false);\n      alertContent.addSubview(groupdefaultColorsCode_block_layerstyles[i]);\n\n      groupdefaultColorsCode_layerstyles[i] = functions.createField(colors_in_layer_styles[i], NSMakeRect(40,settingY,(windowWidth/2)-50,fieldHeight));\n      alertContent.addSubview(groupdefaultColorsCode_layerstyles[i]);\n\n      groupdefaultColorsName_layerstyles[i] = functions.createField(colors_in_layer_styles_names[i], NSMakeRect(windowWidth/2,settingY,windowWidth/2,fieldHeight));\n      alertContent.addSubview(groupdefaultColorsName_layerstyles[i]);\n    \n    }\n    //TITLES\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var title_color = functions.createBoldLabel(\"New Colors from Layer Styles\",12,NSMakeRect(0,settingY + textOffset,windowWidth-leftColWidth,labelHeight));\n    alertContent.addSubview(title_color);\n    \n\n\n    // DIVIDER\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var divider_2 = functions.createDivider(NSMakeRect(0,settingY,windowWidth,1));\n    alertContent.addSubview(divider_2);\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n \n\n    //console.log(styles[]);\n    for( var i=colors_in_text_styles.length-1; i>=0; i--){\n      settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n      \n      groupdefaultColorsCode_block_textstyles[i] = functions.createColoredBlock(colors_in_text_styles[i], NSMakeRect(0,settingY,fieldHeight,fieldHeight),false);\n      alertContent.addSubview(groupdefaultColorsCode_block_textstyles[i]);\n\n      groupdefaultColorsCode_textstyles[i] = functions.createField(colors_in_text_styles[i], NSMakeRect(40,settingY,(windowWidth/2)-50,fieldHeight));\n      alertContent.addSubview(groupdefaultColorsCode_textstyles[i]);\n\n      groupdefaultColorsName_textstyles[i] = functions.createField(colors_in_text_styles[i], NSMakeRect(windowWidth/2,settingY,windowWidth/2,fieldHeight));\n      alertContent.addSubview(groupdefaultColorsName_textstyles[i]);\n    \n    }\n\n    \n    //TITLES\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var title_color = functions.createBoldLabel(\"New Colors from Text Styles\",12,NSMakeRect(0,settingY + textOffset,windowWidth-leftColWidth,labelHeight));\n    alertContent.addSubview(title_color);\n    \n\n\n    // DIVIDER\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var divider_2 = functions.createDivider(NSMakeRect(0,settingY,windowWidth,1));\n    alertContent.addSubview(divider_2);\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n \n\n    for( var i=colors.length-1; i>=0; i--){\n        settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n      \n        groupdefaultColorsCode_block[i] = functions.createColoredBlock(colors[i].code, NSMakeRect(0,settingY,fieldHeight,fieldHeight), false);\n        alertContent.addSubview(groupdefaultColorsCode_block[i]);\n\n        groupdefaultColorsCode[i] = functions.createField(colors[i].code, NSMakeRect(50,settingY,(windowWidth/3)-50,fieldHeight));\n        alertContent.addSubview(groupdefaultColorsCode[i]);\n\n        groupdefaultColorsName[i] = functions.createField(colors[i].name, NSMakeRect(windowWidth/3,settingY,windowWidth/3,fieldHeight));\n        alertContent.addSubview(groupdefaultColorsName[i]);\n\n\n        groupdefaultColorsCode_block_dark[i] = functions.createColoredBlock(colors[i].code, NSMakeRect(windowWidth/3*2+40,settingY,fieldHeight,fieldHeight), true);\n        alertContent.addSubview(groupdefaultColorsCode_block_dark[i]);\n\n        var color= colors[i].code;\n        if(color.length>7){\n          var alpha = color.slice(7, 9);\n        }else{\n          var alpha=\"ff\";\n        }\n        var dark_hex_hex= functions.DarkMode(color,\"Shape_Fill\");\n        var dark_hex= functions.RGBToHex(\"rgb(\"+dark_hex_hex.r+\",\"+dark_hex_hex.g+\",\"+dark_hex_hex.b+\")\");\n        groupdefaultColorsCode_dark[i] = functions.createLabel(dark_hex+alpha,12, NSMakeRect(windowWidth/3*2+90,settingY,(windowWidth/3*3)-90,fieldHeight));\n        alertContent.addSubview(groupdefaultColorsCode_dark[i]);\n      \n    }\n\n    //TITLES\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var title_color = functions.createBoldLabel(\"Colors\",12,NSMakeRect(0,settingY + textOffset,windowWidth-leftColWidth,labelHeight));\n    alertContent.addSubview(title_color);\n\n\n\n\t\talert.accessoryView = alertContent;\n    //BUTTONS\n\t\tvar buttonOrganize = alert.addButtonWithTitle(\"Update Colors\");\n\t\tvar buttonOrganize = alert.addButtonWithTitle(\"Add Color\");\n\t\tvar buttonOrganize = alert.addButtonWithTitle(\"Add Text Colors\");\n\t\tvar buttonCancel = alert.addButtonWithTitle(\"Cancel\");\n\t\tvar responseCode = alert.runModal();\n\n\n    if (responseCode == 1000) { //update color\n      var validated_array = functions.validateColorInput(groupdefaultColorsCode, groupdefaultColorsName, false);\n      Settings.setDocumentSettingForKey(document, 'colors', validated_array);\n    }\n    else if (responseCode == 1001) {  //add color\n\n      var count_repeated=0;\n      for(var j=0; j<colors.length; j++){\n        if( groupdefaultColorsCode[colors.length].stringValue()==colors[j].code){\n          count_repeated++;\n          break;\n\n        }\n      }\n      if( count_repeated==0){\n        var validated_array = functions.validateColorInput( groupdefaultColorsCode, groupdefaultColorsName, true);\n        Settings.setDocumentSettingForKey(document, 'colors', validated_array);\n        sketch.UI.message('Color added!');\n\n      }else{\n        \n        sketch.UI.message(' That Color code already exists! Color not added.');\n\n      }\n\n    }\n    else if (responseCode == 1002) {  //add color from text\n      var groupdefaultColorsCode_merged = groupdefaultColorsCode.concat(groupdefaultColorsCode_textstyles);\n      var groupdefaultColorsName_merged = groupdefaultColorsName.concat(groupdefaultColorsName_textstyles);\n\n      var validated_array = functions.validateColorInput(groupdefaultColorsCode_merged, groupdefaultColorsName_merged, true);\n      Settings.setDocumentSettingForKey(document, 'colors', validated_array);\n\n      //console.log(validated_array);\n\n    }\n  }\n\n\n\n\n\n\n\n\n\n\n\n\t// ------- ------- ------- -------\n  // switchLight AREA\n\t// ------- ------- ------- -------  \n\telse if (type && type == \"switchDark\") {\n    windowHeight = 90;\n    windowWidth = 300;\n\n    var document = sketch.getSelectedDocument();\n    var page = context.document.currentPage();\n    var s_styles= Settings.settingForKey('Styles');\n    //Settings.setDocumentSettingForKey(document, 'Font', groupdefaultFont.indexOfSelectedItem());\n    \n    \n    //create Modal\n    var s_colors= Settings.documentSettingForKey(document, 'colors');\n\n\n\t\tvar alert = NSAlert.alloc().init(),\n\t\talertIconPath = context.plugin.urlForResourceNamed(\"icon.png\").path(),\n\t\talertIcon = NSImage.alloc().initByReferencingFile(alertIconPath),\n\t\talertContent = NSView.alloc().init();\n    alertContent = NSView.alloc().initWithFrame(NSMakeRect(0, 0, windowWidth, windowHeight));\n\n\n\n    //FONT FAMILY\n    var pages_available=[];\n    for(var i=0; i<document.pages.length; i++){\n      //var all_shapes= sketch.find('Shape', document.pages[i]).length;\n      //var all_shapesPaths= sketch.find('ShapePath', document.pages[i]).length;\n      //var all_texts= sketch.find('Text', document.pages[i]).length;\n      //var total= all_shapes+all_shapesPaths+all_texts;\n      pages_available.push(document.pages[i].name);\n    }\n\n    var selected_page = functions.createPopUpButton(pages_available,0,NSMakeRect(0,settingY,windowWidth,fieldHeight));\n    alertContent.addSubview(selected_page);\n    \n\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var groupdefaultFont_label = functions.createBoldLabel(\"Select Page to Transform\",15,NSMakeRect(0,settingY + textOffset,windowWidth,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n\n    \n\n\t\talert.setIcon(alertIcon);\n\t\talert.setMessageText(\"Switch to Light Mode \");\n    alert.accessoryView = alertContent;\n\n      //BUTTONS\n      var buttonOrganize = alert.addButtonWithTitle(\"Switch Dark\");\n      var buttonCancel = alert.addButtonWithTitle(\"Cancel\");\n      var responseCode = alert.runModal();\n  \n  \n      if (responseCode == 1000) { //create dark mode \n        var s_page= selected_page.indexOfSelectedItem();\n        //functions.SwitchDarkMode(document ,layers, new_styles_withdark.layer, new_styles_withdark.text, false);\n        var count= functions.SwitchDarkMode_best(Settings, sketch, document, s_page , document.sharedLayerStyles, document.sharedTextStyles, true);\n\n        if(count>0){\n          sketch.UI.message(' Switched '+count+' Layers to Dark Mode Sucessfully!'); \n        }else{\n          sketch.UI.message(\" All layers are already in Dark Mode or haven't created a DarkMode System\"); \n\n        }\n    }\n  }\n\n  \n\n  \t// ------- ------- ------- -------\n  // switchLight AREA\n\t// ------- ------- ------- -------  \n\telse if (type && type == \"switchLight\") {\n    windowHeight = 90;\n    windowWidth = 300;\n\n    var document = sketch.getSelectedDocument();\n    var page = context.document.currentPage();\n    var s_styles= Settings.settingForKey('Styles');\n    //Settings.setDocumentSettingForKey(document, 'Font', groupdefaultFont.indexOfSelectedItem());\n    \n    \n    //create Modal\n    var s_colors= Settings.documentSettingForKey(document, 'colors');\n\n\n\t\tvar alert = NSAlert.alloc().init(),\n\t\talertIconPath = context.plugin.urlForResourceNamed(\"icon.png\").path(),\n\t\talertIcon = NSImage.alloc().initByReferencingFile(alertIconPath),\n\t\talertContent = NSView.alloc().init();\n    alertContent = NSView.alloc().initWithFrame(NSMakeRect(0, 0, windowWidth, windowHeight));\n\n\n\n    //FONT FAMILY\n    var pages_available=[];\n    for(var i=0; i<document.pages.length; i++){\n      //var all_shapes= sketch.find('Shape', document.pages[i]).length;\n      //var all_shapesPaths= sketch.find('ShapePath', document.pages[i]).length;\n      //var all_texts= sketch.find('Text', document.pages[i]).length;\n      //var total= all_shapes+all_shapesPaths+all_texts;\n      pages_available.push(document.pages[i].name);\n    }\n\n    var selected_page = functions.createPopUpButton(pages_available,0,NSMakeRect(0,settingY,windowWidth,fieldHeight));\n    alertContent.addSubview(selected_page);\n    \n\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var groupdefaultFont_label = functions.createBoldLabel(\"Select Page to Transform\",15,NSMakeRect(0,settingY + textOffset,windowWidth,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n\n    \n\n\t\talert.setIcon(alertIcon);\n\t\talert.setMessageText(\"Switch to Light Mode \");\n    alert.accessoryView = alertContent;\n\n      //BUTTONS\n      var buttonOrganize = alert.addButtonWithTitle(\"Switch Light\");\n      var buttonCancel = alert.addButtonWithTitle(\"Cancel\");\n      var responseCode = alert.runModal();\n  \n  \n      if (responseCode == 1000) { //create dark mode \n        var s_page= selected_page.indexOfSelectedItem();\n        //functions.SwitchDarkMode(document ,layers, new_styles_withdark.layer, new_styles_withdark.text, false);\n        var count= functions.SwitchDarkMode_best(Settings, sketch, document, s_page , document.sharedLayerStyles, document.sharedTextStyles, false);\n\n        if(count>0){\n          sketch.UI.message(' Switched '+count+' Layers to Light Mode Sucessfully!'); \n        }else{\n          sketch.UI.message(\" All layers are already in Light Mode or haven't created a DarkMode System\"); \n\n        }\n    }\n  }\n\n\n\n\n  \n\t// ------- ------- ------- -------\n  // SETTINGS AREA\n\t// ------- ------- ------- -------  \n\telse if (type && type == \"settings\") {\n\n    windowHeight = 460;\n    windowWidth = 800;\n    var all_settings= Settings.settingForKey('Styles');\n    var scrolHeight= (all_settings.length*(labelHeight+settingPad))+100;\n\n\t\tvar alert = NSAlert.alloc().init(),\n\t\talertIconPath = context.plugin.urlForResourceNamed(\"icon.png\").path(),\n    alertIcon = NSImage.alloc().initByReferencingFile(alertIconPath),\n\n    //scroll\n    alertscroll = NSScrollView.alloc().initWithFrame(NSMakeRect(0, 0, windowWidth, windowHeight)),\n    \n    //content\n    alertContent = NSView.alloc().initWithFrame(NSMakeRect(0, 0, windowWidth, scrolHeight));\n    alertContent.setFlipped(1);\n\n\n    alertscroll.setHasVerticalScroller(1);\n    alertscroll.setDocumentView(alertContent);  \n    \n\n    var col=(windowWidth/2)-60;\n\n    //LABELS\n    var title_color_1 = functions.createBoldLabel(\"Type\",12,NSMakeRect(0,settingY ,100,labelHeight));\n    alertContent.addSubview(title_color_1);\n    var title_color_2 = functions.createBoldLabel(\"Light Style\",12,NSMakeRect(60,settingY ,col,labelHeight));\n    alertContent.addSubview(title_color_2);\n    var title_color_3 = functions.createBoldLabel(\"Dark Style\",12,NSMakeRect((col+60),settingY ,col,labelHeight));\n    alertContent.addSubview(title_color_3);\n\n    var light_name=[];\n    var dark_name=[];\n    var type=[];\n    console.log(all_settings);\n\n    for(var i=0; i<all_settings.length; i++){\n      settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n      \n      var dark_id= all_settings[i].dark;\n      var light_id= all_settings[i].light;\n  \n      if(all_settings[i].type==\"text\"){\n        var sharedStyle_light = document.getSharedTextStyleWithID(light_id);\n        var sharedStyle_dark = document.getSharedTextStyleWithID(dark_id);\n        type[i] = functions.createLabel(all_settings[i].element,12,NSMakeRect(0,settingY + textOffset,100,labelHeight));\n        alertContent.addSubview(type[i]);\n      }else{\n        var sharedStyle_light = document.getSharedLayerStyleWithID(light_id);\n        var sharedStyle_dark = document.getSharedLayerStyleWithID(dark_id);\n        type[i] = functions.createLabel(all_settings[i].element,12,NSMakeRect(0,settingY + textOffset,100,labelHeight));\n        alertContent.addSubview(type[i]);\n        \n      }\n        //console.log(sharedStyle_dark);\n        //console.log(sharedStyle_light);\n  \n      if(sharedStyle_light===undefined || sharedStyle_dark===undefined){\n        light_name[i] = functions.createLabel(\"-\",12,NSMakeRect(60,settingY + textOffset,windowWidth-leftColWidth,labelHeight));\n        alertContent.addSubview(light_name[i]);\n        dark_name[i] = functions.createLabel(\"-\",12,NSMakeRect((col+60),settingY + textOffset,windowWidth-leftColWidth,labelHeight));\n        alertContent.addSubview(dark_name[i]);\n       // console.log(\"there is one settings missing\");\n      }else{\n        light_name[i] = functions.createLabel(sharedStyle_light.name,12,NSMakeRect(60,settingY + textOffset,windowWidth-leftColWidth,labelHeight));\n        alertContent.addSubview(light_name[i]);\n        dark_name[i] = functions.createLabel(sharedStyle_dark.name,12,NSMakeRect((col+60),settingY + textOffset,windowWidth-leftColWidth,labelHeight));\n        alertContent.addSubview(dark_name[i]);\n      }\n  \n    }\n\n\n\n    alert.setIcon(alertIcon);\n\t\talert.setMessageText(\"Edit Settings\");\n\t\talert.setInformativeText(\"Here you can setup some of the variables that help you generate and edit your DarkMode Systems.\");\n\n\t\talert.accessoryView = alertscroll;\n\t\tvar responseCode = alert.runModal();\n\n\t\tif (responseCode == 1000) {\n\n\n        //userDefaults.synchronize();\n        sketch.UI.message(' Updated Sucessfully');\n        \n        \n\t\t\t\n\t\t} else return false;\n  }\n\n\n\n\n\n\n\n\n\n\n\n\n // ------------------------------------------------\n  // create a Delete All Style System\n  // ------------------------------------------------\n  else if (type && type == \"deletesettings\") {\n    windowHeight = 10;\n    windowWidth = 400;\n    \n    var alert = NSAlert.alloc().init(),\n    alertIconPath = context.plugin.urlForResourceNamed(\"icon.png\").path(),\n    alertIcon = NSImage.alloc().initByReferencingFile(alertIconPath),\n    alertContent = NSView.alloc().init();\n    alertContent = NSView.alloc().initWithFrame(NSMakeRect(0, 0, windowWidth, windowHeight));\n\n    alert.setIcon(alertIcon);\n    alert.setMessageText(\"Delete All Settings \");\n    alert.setInformativeText(\"Are you Sure You want to delete all \"+get_settign_S.length+\" styles? This will not delete the shared styles connected to the layers, but the setting connecting the 2.\");\n    alert.accessoryView = alertContent;\n\n\n    //BUTTONS\n    var buttonOrganize = alert.addButtonWithTitle(\"Delete All\");\n    var buttonOrganize2 = alert.addButtonWithTitle(\"Delete Unused\");\n    var buttonCancel = alert.addButtonWithTitle(\"Cancel\");\n    // RUN MODAL\n    var responseCode = alert.runModal();\n   // log(styles_list);\n    if (responseCode == 1000) {\n      var all_settings= Settings.settingForKey('Styles');\n\n      sketch.UI.message(' Deleted All! '+all_settings.length+' styles, sucessfully!');\n      Settings.setSettingForKey('Styles', []);\n\n    }else if (responseCode == 1001) {\n      var all_settings= Settings.settingForKey('Styles');\n\n      var reviewed_Settings= functions.reviewSettings(Settings, document);\n      Settings.setSettingForKey('Styles', reviewed_Settings);\n\n      var deleted= all_settings.length-reviewed_Settings.length;\n\n      sketch.UI.message(' Deleted '+deleted+' Settings , sucessfully! You now have '+reviewed_Settings.length+\" Settings!\");\n\n    }\n\n  }\n}\n\n\n\n","import sketch from 'sketch';\nimport M from 'minimatch';\n\n// ------------------\n//inputs\n// ------------------\nexport function getFontIndex(font_name,avail_fonts) {\n    var index=0;\n    //has to convert them to normal array, as {sys_fonts} is array-like object, and is persistent, so when modified, changes stay between runs of script\n    for (var i = 0; i < avail_fonts.length; i++) {\n        var font_info = avail_fonts[i];\n\n        var font_selected = font_name;\n        var style_oposite = document.getSharedTextStyleWithID(style_oposite_id);\n\n        if(font_info==font_selected && style_oposite!=null){\n            index=i;\n            break;\n        }\n    }\n    return index;\n}\n\nexport function getSpecificFonts(specific_font) {\n  var fontManager = NSFontManager.sharedFontManager();\n  var fonts = {\n      family : [],\n      weights : []\n  }\n  var sys_fonts_families = fontManager.availableFontFamilies();\n\n  for (var i = 0; i < sys_fonts_families.length; i++) {\n    if(sys_fonts_families[i]== specific_font){\n      fonts.family.push(sys_fonts_families[i]);\n\n      var w= fontManager.availableMembersOfFontFamily(sys_fonts_families[i]);\n      var weights =[];\n      //log(w);\n      for(var m=0; m<w.length; m++){\n          \n          weights.push({\"name\": w[m][1],\"font\": w[m][0], \"weight\": w[m][2], \"variation\":w[m][3]});\n\n      }\n      if(w.length.length==0){\n          weights.push({\"name\": \"plain\",\"font\": sys_fonts_families[i], \"weight\":\"5\", \"variation\":0});\n\n      }\n      fonts.weights.push(weights);\n    }\n  }\n  return fonts;\n}\n\n\n\nexport function getFonts() {\n    var fontManager = NSFontManager.sharedFontManager();\n    var fonts = {\n        family : [],\n        weights : []\n    }\n    var sys_fonts = fontManager.availableFonts();\n    var sys_fonts_families = fontManager.availableFontFamilies();\n\n   var w= fontManager.availableMembersOfFontFamily(sys_fonts_families[0]);\n\n    var last_font;\n\n\n    for (var i = 0; i < sys_fonts_families.length; i++) {\n        fonts.family.push(sys_fonts_families[i]);\n\n        var w= fontManager.availableMembersOfFontFamily(sys_fonts_families[i]);\n        var weights =[];\n        //log(w);\n        for(var m=0; m<w.length; m++){\n            \n            weights.push({\"name\": w[m][1],\"font\": w[m][0], \"weight\": w[m][2], \"variation\":w[m][3]});\n\n        }\n        if(w.length.length==0){\n            weights.push({\"name\": \"plain\",\"font\": sys_fonts_families[i], \"weight\":\"5\", \"variation\":0});\n\n        }\n        fonts.weights.push(weights);\n    }\n    return fonts;\n  }\n\n\n  export function getFontsOld() {\n    var fontManager = NSFontManager.sharedFontManager();\n    var fonts = [];\n    var sys_fonts = fontManager.availableFonts();\n    //has to convert them to normal array, as {sys_fonts} is array-like object, and is persistent, so when modified, changes stay between runs of script\n    for (var i = 0; i < sys_fonts.length; i++) {\n        fonts.push(sys_fonts[i] );\n    }\n    return fonts;\n  }\n  /*\n  export function getFontIndex(font) {\n    var fontManager = NSFontManager.sharedFontManager();\n    var font_name ;\n    var sys_fonts = fontManager.availableFonts();\n    //has to convert them to normal array, as {sys_fonts} is array-like object, and is persistent, so when modified, changes stay between runs of script\n    for (var i = 0; i < sys_fonts.length; ++i) {\n        if(sys_fonts[i]==font){\n            font_name=i;\n            break;\n\n        }\n    }\n    return font_name;\n  }\n  */\n  export function getFontName(index) {\n    var fontManager = NSFontManager.sharedFontManager();\n    var font_name ;\n    var sys_fonts = fontManager.availableFonts();\n    //has to convert them to normal array, as {sys_fonts} is array-like object, and is persistent, so when modified, changes stay between runs of script\n    for (var i = 0; i < sys_fonts.length; ++i) {\n        if(i==index){\n            font_name=sys_fonts[i];\n            break;\n\n        }\n    }\n    return font_name;\n  }\n\n\n// ------------------\n// text style\n// ------------------\n\nexport function addTextStyle(context,styleName,theStyle) {\n\tvar sketchVersion = MSApplicationMetadata.metadata().appVersion;\n\tvar textStyles = context.document.documentData().layerTextStyles();\n\n\tif (textStyles.addSharedStyleWithName_firstInstance) {\n\t\ttextStyles.addSharedStyleWithName_firstInstance(styleName,theStyle.style());\n\t} else if (sketchVersion < 52) {\n\t\tvar textStyle = MSSharedStyle.alloc().initWithName_firstInstance(styleName,theStyle.style());\n\n\t\ttextStyles.addSharedObject(textStyle);\n\t} else {\n\t\tvar textStyle = MSSharedStyle.alloc().initWithName_style(styleName,theStyle.style());\n\n\t\ttextStyles.addSharedObject(textStyle);\n\t}\n\n\treturn getTextStyleByName(context,styleName);\n}\n\n\n/*\nfunction updateTextStyle(context,styleName,theStyle) {\n\tvar textStyles = context.document.documentData().layerTextStyles(),\n\t\tcurrentStyle = getTextStyleByName(context,styleName);\n\n\tif (textStyles.updateValueOfSharedObject_byCopyingInstance) {\n\t\ttextStyles.updateValueOfSharedObject_byCopyingInstance(currentStyle,theStyle.style());\n\t} else {\n\t\tcurrentStyle.updateToMatch(theStyle.style());\n\t}\n\n\treturn getTextStyleByName(context,styleName);\n}\n*/\n/*\nexport function createTextStyle(styleData,frame) {\n\tvar textStyle = MSTextLayer.alloc().initWithFrame(frame);\n\ttextStyle.setFontSize(styleData.fontSize);\n\ttextStyle.setLineHeight(styleData.lineHeight);\n\ttextStyle.setTextAlignment(styleData.textAlignment);\n\ttextStyle.setFontPostscriptName(styleData.fontFace);\n\ttextStyle.setTextColor(MSImmutableColor.colorWithSVGString(\"#\" + styleData.fontColor));\n\n\treturn textStyle;\n}\n*/\n\nexport function updateTextStyle(document, Text, Rectangle, create_info,defaultSettings , place){\n    var base = create_info.base.stringValue();\n    var ratio = parseFloat(create_info.ratio.stringValue().replace(\",\", \".\"));\n    var font_family = create_info.font_family.titleOfSelectedItem();\n    var font_weight = create_info.font_weight.titleOfSelectedItem();\n    var font_weight_index = create_info.font_weight.indexOfSelectedItem();\n    var font_color = create_info.color.indexOfSelectedItem();\n    var font_color_name = create_info.color.titleOfSelectedItem();\n    var color = defaultSettings.s_colors[font_color].code;\n    var weights_array= create_info.list_weights;\n    var labels_alignments= create_info.labels_alignments;\n      \n    var count=[];\n    var count_updated=0;\n    var count_Created=0;\n\n    var weight_info= getWeightfromPopupButton(font_weight_index,font_weight,weights_array);\n      \n    var i=0;\n    var initial_size = base/ratio/ratio/ratio;\n    var is_italic= getIs_italic(weight_info[0].name);\n\n    while (i< defaultSettings.s_labels.length){\n        var size = initial_size* Math.pow(ratio, i+1);\n        var label= defaultSettings.s_labels.length -i-1;\n\n        for (var j=0; j<3; j++){\n          var options = [defaultSettings.s_labels[label], font_family, weight_info[0].name, font_color_name, labels_alignments[j]];\n          var h= defaultSettings.s_hierarchy;\n          var styleName= options[h[0]]+\"/\"+options[h[1]]+\"/\"+options[h[2]]+\"/\"+options[h[3]]+\"/\"+options[h[4]];\n          \n         // var styleName=defaultSettings.s_labels[label]+\"/\"+font_color_name+\"/\"+weight_info[0].name+\"/\"+labels_alignments[j];\n          var titleStyle = getTextStyleByName(context,styleName);\n          // If title style does not exist...\n          let styles_list = document.sharedTextStyles;\n\n          var style_to_update= getTextStyleByNameLabel(styleName, styles_list)\n          if (!titleStyle) {\n            count_Created++; \n            document.sharedTextStyles.push({\n              name: styleName,\n              style:{\n                fontFamily: font_family ,\n                fontSize : size,\n                fontStyle: is_italic,\n                fontWeight : weight_info[0].weight,\n                textColor : color+\"ff\",\n                lineHeight :(size*1.2),\n                alignment : j,\n                borders : [],\n                fills : []\n              }\n            })\n            \n          }else{\n            count_updated++;\n            var new_style ={\n                fontFamily: font_family ,\n                fontSize : size,\n                fontStyle: is_italic,\n                fontWeight : weight_info[0].weight,\n                textColor : color+\"ff\",\n                lineHeight :(size*1.2),\n                alignment : j,\n                borders : [],\n                fills : []\n              };\n              //log(titleStyle);\n              //log(style_to_update);\n              style_to_update.style.fontFamily= font_family;\n              style_to_update.style.fontSize= size;\n              style_to_update.style.fontStyle= is_italic;\n              style_to_update.style.fontWeight= weight_info[0].weight;\n              style_to_update.style.lineHeight= (size*1.2);\n\n              var layers = style_to_update.getAllInstancesLayers();\n              //log(\"NEW CHANge\");\n              for(var m=0; m< layers.length; m++){\n                  layers[m].style.syncWithSharedStyle(style_to_update);\n\n              }\n          }\n\n        }\n        i++;\n    }\n    if(place>0){\n        //placeTextStyles(document, Text, Rectangle);\n        \n    }\n\n    var count=[count_Created,count_updated];\n    return count;\n}\n\n\n\n\n\nexport function updateTextStyleLabel(document, Text, Rectangle, create_info,defaultSettings , place){\n  var base = create_info.base.stringValue();\n  var ratio = parseFloat(create_info.ratio.stringValue().replace(\",\", \".\"));\n  var font_family = create_info.font_family.titleOfSelectedItem();\n  var font_weight = create_info.font_weight.titleOfSelectedItem();\n  var font_weight_index = create_info.font_weight.indexOfSelectedItem();\n  var font_color = create_info.color.indexOfSelectedItem();\n  var font_color_name = create_info.color.titleOfSelectedItem();\n\n  var color = defaultSettings.s_colors[font_color].code;\n  var weights_array= create_info.list_weights;\n  var labels_alignments= create_info.labels_alignments;\n    \n  print(ratio);\n  var count=[];\n  var count_updated=0;\n  var count_Created=0;\n\n  var weight_info= getWeightfromPopupButton(font_weight_index,font_weight,weights_array);\n    \n  var i=0;\n  var initial_size = base/ratio/ratio/ratio;\n  var is_italic= getIs_italic(weight_info[0].name);\n\n  while (i< defaultSettings.s_labels.length){\n      var size = initial_size* Math.pow(ratio, i+1);\n      var label= defaultSettings.s_labels.length -i-1;\n\n      for (var j=0; j<3; j++){\n        var options = [defaultSettings.s_labels[label], font_family, weight_info[0].name, font_color_name, labels_alignments[j]];\n        var h= defaultSettings.s_hierarchy;\n        var styleName= options[h[0]]+\"/\"+options[h[1]]+\"/\"+options[h[2]]+\"/\"+options[h[3]]+\"/\"+options[h[4]];\n        \n       // var styleName=defaultSettings.s_labels[label]+\"/\"+font_color_name+\"/\"+weight_info[0].name+\"/\"+labels_alignments[j];\n        var titleStyle = getTextStyleByName(context,styleName);\n        // If title style does not exist...\n        let styles_list = document.sharedTextStyles;\n\n        var style_to_update= getTextStyleByNameLabel(styleName, styles_list)\n        if (!titleStyle) {\n          count_Created++; \n          document.sharedTextStyles.push({\n            name: styleName,\n            style:{\n              fontFamily: font_family ,\n              fontSize : size,\n              fontStyle: is_italic,\n              fontWeight : weight_info[0].weight,\n              textColor : color+\"ff\",\n              lineHeight :(size*1.2),\n              alignment : j,\n              borders : [],\n              fills : []\n            }\n          })\n          \n        }else{\n          count_updated++;\n          var new_style ={\n              fontFamily: font_family ,\n              fontSize : size,\n              fontStyle: is_italic,\n              fontWeight : weight_info[0].weight,\n              textColor : color+\"ff\",\n              lineHeight :(size*1.2),\n              alignment : j,\n              borders : [],\n              fills : []\n            };\n            //log(titleStyle);\n            //log(style_to_update);\n            style_to_update.style.fontFamily= font_family;\n            style_to_update.style.fontSize= size;\n            style_to_update.style.fontStyle= is_italic;\n            style_to_update.style.fontWeight= weight_info[0].weight;\n            style_to_update.style.lineHeight= (size*1.2);\n\n            var layers = style_to_update.getAllInstancesLayers();\n            //log(\"NEW CHANge\");\n            for(var m=0; m< layers.length; m++){\n                layers[m].style.syncWithSharedStyle(style_to_update);\n\n            }\n        }\n\n      }\n      i++;\n  }\n  if(place>0){\n      //placeTextStyles(document, Text, Rectangle);\n      \n  }\n\n  var count=[count_Created,count_updated];\n  return count;\n}\n\n\n\nexport function createTextStyle(document, Text, Rectangle, create_info,defaultSettings , place){\n    var base = create_info.base.stringValue();\n    var ratio = parseFloat(create_info.ratio.stringValue().replace(\",\", \".\"));\n    var font_family = create_info.font_family.titleOfSelectedItem();\n    var font_weight = create_info.font_weight.titleOfSelectedItem();\n    var font_weight_index = create_info.font_weight.indexOfSelectedItem();\n    var font_color = create_info.color.indexOfSelectedItem();\n    var font_color_name = create_info.color.titleOfSelectedItem();\n    var color = defaultSettings.s_colors[font_color].code;\n    var weights_array= create_info.list_weights;\n    var labels_alignments= create_info.labels_alignments;\n  print(ratio);\n      \n    var count=[];\n    var count_existent=0;\n      var weight_info= getWeightfromPopupButton(font_weight_index,font_weight,weights_array);\n      \n\n      var i=0;\n      var initial_size = base/ratio/ratio/ratio;\n      var count_Created=0;\n      var is_italic= getIs_italic(weight_info[0].name);\n\n\n      while (i< defaultSettings.s_labels.length){\n        var size = initial_size* Math.pow(ratio, i+1);\n        var label= defaultSettings.s_labels.length -i-1;\n\n        for (var j=0; j<3; j++){\n\n\n          //HIERARQUIA\n          var options = [defaultSettings.s_labels[label], font_family, weight_info[0].name, font_color_name, labels_alignments[j]];\n          var h= defaultSettings.s_hierarchy;\n          var styleName= options[h[0]]+\"/\"+options[h[1]]+\"/\"+options[h[2]]+\"/\"+options[h[3]]+\"/\"+options[h[4]];\n          //var styleName=defaultSettings.s_labels[label]+\"/\"+font_family+\"/\"+weight_info[0].name+\"/\"+font_color_name+\"/\"+labels_alignments[j];\n          var titleStyle = getTextStyleByName(context,styleName);\n          // If title style does not exist...\n          if (!titleStyle) {\n            count_Created++; \n\n            const page = document.selectedPage;\n            document.sharedTextStyles.push({\n              name: styleName,\n              style:{\n                fontFamily: font_family ,\n                fontSize : size,\n                fontStyle: is_italic,\n                fontWeight : weight_info[0].weight,\n                textColor : color+\"ff\",\n                lineHeight :(size*1.2),\n                alignment : j,\n                borders : [],\n                fills : []\n              }\n            })\n            \n          }else{\n            count_existent++;\n          }\n\n        }\n        i++;\n      }\n    if(place>0){\n        placeTextStyles(document, Text, Rectangle);\n    }\n    var count=[count_Created,count_existent];\n\n    return count;\n}\n\n\nexport function placeTextStyles(document, Text, Rectangle){\n\n    var x=0;\n    var y=0;\n    var layer_width= 800;\n    var layer_height= 70;\n\n\n    var styles_list = document.sharedTextStyles;\n    var page = document.selectedPage;\n    var Group = require('sketch/dom').Group;\n\n    var Artboard = require('sketch/dom').Artboard;\n\n    var organized_styles= OrganizeArrayTextStyles(styles_list);\n\n    var layers_artboard = document.getLayersNamed(\"TypeSystem\");\n    if (layers_artboard.length) {\n      //  layers[0].remove();\n        var artboard =layers_artboard[0];\n        artboard.layers=[];\n    }else{\n        var artboard = new Artboard({\n            name: 'TypeSystem',\n            parent: page\n        });\n    }\n    \n\n    var layers = document.getLayersNamed(\"Group TypeSystem\");\n    if (layers.length) {\n      //  layers[0].remove();\n        var group =layers[0];\n        group.layers=[];\n    }else{\n        var group = new Group({\n            name: 'Group TypeSystem',\n            parent: artboard\n        });\n    }\n    \n    // log (organized_styles);\n    if(organized_styles.length>0){\n        for(var j=0; j<organized_styles.length; j++){\n            y=j*(layer_height+10);\n            // STYLES INDIVIDUALLY\n            var styles= organized_styles[j].styles;\n            for(var i=0; i<styles.length; i++){\n                x=i*(layer_width+100);\n\n                var rect = new Rectangle(x, y, layer_width, layer_height);\n                var text = new Text({\n                    text: styles[i].name,\n                    sharedStyleId:styles[i].id,\n                    frame: rect,\n                    parent: group,\n                    style: styles[i].style\n                })\n                //document.centerOnLayer(text);\n\n            }\n           \n        }\n        sketch.UI.message(' Placed '+styles_list.length+' text styles, sucessfully!');\n        group.adjustToFit();\n        artboard.adjustToFit();\n        var padding =100;\n        var h= artboard.frame.height+(padding*2);\n        var w= artboard.frame.width+(padding*2);\n        var art_x= artboard.frame.x -padding;\n        var art_y= artboard.frame.y - padding;\n\n        artboard.frame.height=h;\n        artboard.frame.width=w;\n        artboard.frame.x=art_x;\n        artboard.frame.y=art_y;\n\n        group.frame.x=padding;\n        group.frame.y=padding;\n\n\n    }else{\n        sketch.UI.message('No Styles to Place :( Try creating them first.');    \n    }\n}\n\nexport function elementHasStyle(all_styles, id){\n  var exists=false;\n  //console.log(all_styles);\n\n\n  for(var i= 0; i< all_styles.length; i++){\n    if(id==all_styles[i].id){\n      exists=all_styles[i];\n      break;\n    }\n  }\n  return exists;\n\n}\n\n\nexport function ifStyleNameAlreadyExists(all_styles, name){\n  var exists=false;\n  //console.log(all_styles);\n\n  for(var i= 0; i< all_styles.length; i++){\n    if(name.replace(\" \",\"\")==all_styles[i].name.replace(\" \",\"\")){\n      exists=true;\n      break;\n    }\n  }\n  return exists;\n\n}\n\nexport function getStyleByName(all_styles, name){\n  var style=false;\n  //console.log(all_styles);\n\n  for(var i= 0; i< all_styles.length; i++){\n    if(name.replace(\" \", \"\")==all_styles[i].name.replace(\" \", \"\")){\n      style=all_styles[i];\n      break;\n    }\n  }\n  return style;\n\n}\n\n\n\nexport function getStyleById(all_styles, id){\n  var style=false;\n  //console.log(all_styles);\n\n  for(var i= 0; i< all_styles.length; i++){\n    if(id==all_styles[i].id){\n      style=all_styles[i];\n      break;\n    }\n  }\n  return style;\n\n}\n\n\n\nexport function getTextStyleByName(context,styleName,removeStyle) {\n\tvar textStyles = context.document.documentData().layerTextStyles().objects();\n\n\tif (textStyles) {\n\t\tfor (var i = 0; i < textStyles.count(); i++) {\n\t\t\tif (textStyles.objectAtIndex(i).name() == styleName) {\n\t\t\t\tif (removeStyle && removeStyle == 1) {\n\t\t\t\t\tcontext.document.documentData().layerTextStyles().removeSharedStyle(textStyles.objectAtIndex(i));\n\t\t\t\t\treturn false;\n\t\t\t\t} else {\n\t\t\t\t\treturn textStyles.objectAtIndex(i);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn false;\n}\n\n// ------------------\n// functions\n// ------------------\nexport function updateSettingsWithDocument(context,settings, page) {\n    var i;\n      for (i in settings) {\n          try {\n              var value = sketch.Settings.layerSettingForKey(page,i);\n          } catch (err) {\n              log('Could not JSON.parse value, using old method');\n  \n              var value = context.command.valueForKey_onLayer(i,page.sketchObject);\n          }\n  \n          if (value != null) settings[i] = value;\n      }\n  \n      return settings;\n  }\nexport function updateSettingsWithGlobal(defaults,settings) {\n    var i;\n      for (i in settings) {\n          var value = defaults.objectForKey(i);\n          if (value) settings[i] = value;\n      }\n  \n      return settings;\n  }\n  \nexport function createSelect(items,selectedItemIndex,frame) {\n\tvar comboBox = NSComboBox.alloc().initWithFrame(frame),\n\t\tselectedItemIndex = (selectedItemIndex > -1) ? selectedItemIndex : 0;\n\n\tcomboBox.addItemsWithObjectValues(items);\n\tcomboBox.selectItemAtIndex(selectedItemIndex);\n\tcomboBox.setNumberOfVisibleItems(16);\n    comboBox.setCompletes(1);\n    \n\treturn comboBox;\n}\n\n\n  \nexport function createPopUpButton(items,selectedItemIndex,frame) {\n\tvar PopUpButton = NSPopUpButton.alloc().initWithFrame(frame),\n\t\tselectedItemIndex = (selectedItemIndex > -1) ? selectedItemIndex : 0;\n\n    PopUpButton.addItemsWithTitles(items);\n    PopUpButton.selectItemAtIndex(selectedItemIndex);\n    PopUpButton.setTarget=self;\n\n\treturn PopUpButton;\n}\n\n\nexport function createPopUpButtonWeights(items,selectedItemIndex,frame) {\n\tvar PopUpButton = NSPopUpButton.alloc().initWithFrame(frame),\n        selectedItemIndex = (selectedItemIndex > -1) ? selectedItemIndex : 0;\n        \n    var items_names=[];\n    \n    for(var i=0; i<items.length; i++){\n        items_names.push(items[i].name);\n    }\n    //log(items);\n    PopUpButton.addItemsWithTitles(items_names);\n    PopUpButton.selectItemAtIndex(selectedItemIndex);\n    PopUpButton.setTarget=self;\n\n\treturn PopUpButton;\n}\n\n\nexport function getIndexforPopupButton(weight, style, all_weights){\n    var index=0;\n   // log(all_weights);\n    for(var i=0; i<all_weights.length; i++){\n        if (style == null && all_weights[i].weight == weight ) { \n            index=i;\n            break;\n        }\n        else if (all_weights[i].name.toLowerCase().indexOf(style) !== -1 && all_weights[i].weight == weight ) { \n            index=i;\n            break;\n        }\n        \n    }\n    return index;\n}\n\n\nexport function getWeightfromPopupButton(index, name, all_weights){\n    var weight=[];\n    if(all_weights.length>0){\n        for(var i=0; i<all_weights.length; i++){\n            var str =  name.replace(\" \", \"\");\n\n            if (all_weights[i].name ==name) {\n                weight.push({\"name\": all_weights[index].name, \"font\": all_weights[index].font, \"weight\": all_weights[index].weight, \"variation\": all_weights[index].variation});\n                break;\n            }\n        }\n    }else{\n        weight=5;\n    }\n    return weight;\n}\nexport function getIs_italic(font_name){\n    var italic= undefined;\n    if (font_name.toLowerCase().indexOf(\"italic\") !== -1 ) {\n        italic =\"italic\";\n    }\n    return italic;\n\n}\nexport function getTextStyleByNameLabel(name, styles_list){\n    var style=[];\n    for(var i=0; i<styles_list.length; i++){\n        if(styles_list[i].name==name){\n            style.push(styles_list[i]); \n            break;\n        }\n    }\n    return style[0];\n\n\n}\nexport function getUserDefaults(domain) {\n\treturn NSUserDefaults.alloc().initWithSuiteName(domain);\n}\n\n\nexport function createBoldLabel(text,size,frame) {\n\tvar label = NSTextField.alloc().initWithFrame(frame);\n\n\tlabel.setStringValue(text);\n\tlabel.setFont(NSFont.boldSystemFontOfSize(size));\n\tlabel.setBezeled(false);\n\tlabel.setDrawsBackground(false);\n\tlabel.setEditable(false);\n\tlabel.setSelectable(false);\n\n\treturn label;\n}\n\nexport function createNotSelectableInput(text,size,frame) {\n\tvar label = NSTextField.alloc().initWithFrame(frame);\n\n\tlabel.setStringValue(text);\n\tlabel.setFont(NSFont.systemFontOfSize(size));\n\tlabel.setBezeled(false);\n\tlabel.setEditable(false);\n\tlabel.setSelectable(false);\n\n\treturn label;\n}\nexport function createLabel(text,size,frame) {\n\tvar label = NSTextField.alloc().initWithFrame(frame);\n\n\tlabel.setStringValue(text);\n\tlabel.setFont(NSFont.systemFontOfSize(size));\n\tlabel.setBezeled(false);\n\tlabel.setDrawsBackground(false);\n\tlabel.setEditable(false);\n\tlabel.setSelectable(false);\n\n\treturn label;\n}\n\nexport function createCheckbox(item,flag,frame) {\n\tvar checkbox = NSButton.alloc().initWithFrame(frame),\n\t\tflag = (flag == false) ? NSOffState : NSOnState;\n\n\tcheckbox.setButtonType(NSSwitchButton);\n\tcheckbox.setBezelStyle(0);\n\tcheckbox.setTitle(item.name);\n\tcheckbox.setTag(item.value);\n\tcheckbox.setState(flag);\n\n\treturn checkbox;\n}\n\nexport function createColoredBlock(color, frame, darkmode) {\n\tvar block = NSView.alloc().initWithFrame(frame);\n\n    block.setWantsLayer(1);\n    if(darkmode){\n      var color_rgb=DarkMode(color,\"Shape\"); \n\n    }else{\n       var color_rgb=hexToRgba(color); \n\n    }\n   //console.log(color_rgb);\n    //console.log(color_rgb);\n    block.layer().cornerRadius = 2;\n    block.layer().maskedCorners=true;\n\t  block.layer().setBackgroundColor(CGColorCreateGenericRGB(color_rgb.r/255,color_rgb.g/255,color_rgb.b/255,color_rgb.a/255));\n    \n    return block;\n    //NSRectFill\n}\n\nexport function changeColoredBlock(block, color) {\n    var color_rgb=hexToRgba(color); \n\t  block.layer().setBackgroundColor(CGColorCreateGenericRGB(color_rgb.r/255,color_rgb.g/255,color_rgb.b/255,color_rgb.a/255));\n}\n\n\nexport function DarkMode(hex, element){\n   // var hex = h.substr(0, 7);\n   var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex.substr(0, 7));\n   if(hex.length>7){\n     var alpha = parseInt(hex.slice(7, 9), 16);\n   }else{\n     var alpha=255;\n   }\n   var r=  parseInt(result[1], 16);\n   var g=  parseInt(result[2], 16);\n   var b=  parseInt(result[3], 16);\n   var gray_middle=127;\n\n\n   // IF IS MONOTONE\n   if( Math.abs(r-g)<50 && Math.abs(r-b)<50){\n    var lightness= (r * 0.299 + g * 0.587 + b * 0.114);\n    if (lightness > gray_middle){\n      //console.log(\"is light\"+lightness);\n      //(lightness* -100)/255\n      if(element==\"container\"){\n        var darkmode= RGBToHSL(\"rgb(255,255,255)\", \"container\", \"light\");\n      }else if(element==\"in_colored_container\"){\n        var darkmode= RGBToHSL(\"rgb(5,5,5)\", \"text\", \"dark\");\n      }else if(element==\"Shape\"){\n        var darkmode= RGBToHSL(\"rgb(\"+r+\",\"+g+\",\"+b+\")\", \"container\", \"light\");\n      }else{\n        var darkmode= RGBToHSL(\"rgb(\"+r+\",\"+g+\",\"+b+\")\", \"text\" ,\"light\");\n      }\n\n    }else{\n      if(element==\"container\"){\n        var darkmode= RGBToHSL(\"rgb(255,255,255)\", \"container\", \"light\");\n      }else if(element==\"in_colored_container\"){\n        var darkmode= RGBToHSL(\"rgb(5,5,5)\", \"text\", \"dark\");\n      } else if(element==\"Shape\"){\n        var darkmode= RGBToHSL(\"rgb(\"+r+\",\"+g+\",\"+b+\")\", \"container\", \"dark\");\n      }else{\n        //180- (90+((lightness* 100)/gray_middle));\n        var darkmode= RGBToHSL(\"rgb(\"+r+\",\"+g+\",\"+b+\")\", \"text\", \"dark\" );\n      }\n\n    }\n    var darkmode_rgb= HSLToRGB(darkmode, false);\n\n  //IF IS COLOR\n  }else{\n      //console.log(\"ITS COLORED\");\n      //console.log(element);\n\n    //console.log(\"original rgb(\"+r+\",\"+g+\",\"+b+\")\");\n    //var darkmode = RGBToHSL(\"rgb(\" + r + \",\" + g + \",\" + b + \")\", 0, -50);\n    if(element==\"container\"){\n      var darkmode= RGBToHSL(\"rgb(255,255,255)\", \"container\", \"light\");\n    }else if(element==\"Shape\" || element==\"in_colored_container\"){\n      var darkmode= RGBToHSL(\"rgb(\"+r+\",\"+g+\",\"+b+\")\", \"container\", \"color\");\n    }else{\n      var darkmode= RGBToHSL(\"rgb(\"+r+\",\"+g+\",\"+b+\")\", \"text\", \"color\");\n    }\n    var darkmode_rgb= HSLToRGB(darkmode, false);\n\n  }\n  //console.log(\"---------------------\");\n    return result ? {\n      r: darkmode_rgb.r,\n      g: darkmode_rgb.g,\n      b: darkmode_rgb.b,\n      a: alpha\n    } : null;\n\n    \n}\nexport function RGBToHex(rgb) {\n  let ex = /^rgb\\((((((((1?[1-9]?\\d)|10\\d|(2[0-4]\\d)|25[0-5]),\\s?)){2}|((((1?[1-9]?\\d)|10\\d|(2[0-4]\\d)|25[0-5])\\s)){2})((1?[1-9]?\\d)|10\\d|(2[0-4]\\d)|25[0-5]))|((((([1-9]?\\d(\\.\\d+)?)|100|(\\.\\d+))%,\\s?){2}|((([1-9]?\\d(\\.\\d+)?)|100|(\\.\\d+))%\\s){2})(([1-9]?\\d(\\.\\d+)?)|100|(\\.\\d+))%))\\)$/i;\n  if (ex.test(rgb)) {\n      // choose correct separator\n      let sep = rgb.indexOf(\",\") > -1 ? \",\" : \" \";\n      // turn \"rgb(r,g,b)\" into [r,g,b]\n      rgb = rgb.substr(4).split(\")\")[0].split(sep);\n\n      // convert %s to 0255\n      for (let R in rgb) {\n          let r = rgb[R];\n          if (r.indexOf(\"%\") > -1)\n              rgb[R] = Math.round(r.substr(0,r.length - 1) / 100 * 255);\n              /* Example:\n              75% -> 191\n              75/100 = 0.75, * 255 = 191.25 -> 191\n              */\n      }\n\n      let r = (+rgb[0]).toString(16),\n          g = (+rgb[1]).toString(16),\n          b = (+rgb[2]).toString(16);\n\n      if (r.length == 1)\n          r = \"0\" + r;\n      if (g.length == 1)\n          g = \"0\" + g;\n      if (b.length == 1)\n          b = \"0\" + b;\n      \n      return \"#\" + r + g + b;\n\n  } else {\n      return \"Invalid input color\";\n  }\n}\n\nfunction HSLToRGB(hsl,isPct) {\n  let ex = /^hsl\\(((((([12]?[1-9]?\\d)|[12]0\\d|(3[0-5]\\d))(\\.\\d+)?)|(\\.\\d+))(deg)?|(0|0?\\.\\d+)turn|(([0-6](\\.\\d+)?)|(\\.\\d+))rad)((,\\s?(([1-9]?\\d(\\.\\d+)?)|100|(\\.\\d+))%){2}|(\\s(([1-9]?\\d(\\.\\d+)?)|100|(\\.\\d+))%){2})\\)$/i;\n  if (ex.test(hsl)) {\n    \n      let sep = hsl.indexOf(\",\") > -1 ? \",\" : \" \";\n      hsl = hsl.substr(4).split(\")\")[0].split(sep);\n      isPct = isPct === true;\n\n      let h = hsl[0],\n          s = hsl[1].substr(0,hsl[1].length - 1) / 100,\n          l = hsl[2].substr(0,hsl[2].length - 1) / 100;\n\n      // strip label and convert to degrees (if necessary)\n      if (h.indexOf(\"deg\") > -1)\n          h = h.substr(0,h.length - 3);\n      else if (h.indexOf(\"rad\") > -1)\n          h = Math.round(h.substr(0,h.length - 3) / (2 * Math.PI) * 360);\n      else if (h.indexOf(\"turn\") > -1)\n          h = Math.round(h.substr(0,h.length - 4) * 360);\n      // keep hue fraction of 360 if ending up over\n      if (h >= 360)\n          h %= 360;\n      \n      let c = (1 - Math.abs(2 * l - 1)) * s,\n          x = c * (1 - Math.abs((h / 60) % 2 - 1)),\n          m = l - c/2,\n          r = 0,\n          g = 0,\n          b = 0;\n      \n      if (0 <= h && h < 60) {\n          r = c; g = x; b = 0;\n      } else if (60 <= h && h < 120) {\n          r = x; g = c; b = 0;\n      } else if (120 <= h && h < 180) {\n          r = 0; g = c; b = x;\n      } else if (180 <= h && h < 240) {\n          r = 0; g = x; b = c;\n      } else if (240 <= h && h < 300) {\n          r = x; g = 0; b = c;\n      } else if (300 <= h && h < 360) {\n          r = c; g = 0; b = x;\n      }\n\n      r = Math.round((r + m) * 255);\n      g = Math.round((g + m) * 255);\n      b = Math.round((b + m) * 255);\n      return{\n        r: r,\n        g: g,\n        b: b\n      } ;\n\n  } else {\n      return \"Invalid input color\";\n  }\n}\n\nfunction RGBToHSL(rgb,  type, mode) {\n  let ex = /^rgb\\((((((((1?[1-9]?\\d)|10\\d|(2[0-4]\\d)|25[0-5]),\\s?)){2}|((((1?[1-9]?\\d)|10\\d|(2[0-4]\\d)|25[0-5])\\s)){2})((1?[1-9]?\\d)|10\\d|(2[0-4]\\d)|25[0-5]))|((((([1-9]?\\d(\\.\\d+)?)|100|(\\.\\d+))%,\\s?){2}|((([1-9]?\\d(\\.\\d+)?)|100|(\\.\\d+))%\\s){2})(([1-9]?\\d(\\.\\d+)?)|100|(\\.\\d+))%))\\)$/i;\n  if (ex.test(rgb)) {\n      let sep = rgb.indexOf(\",\") > -1 ? \",\" : \" \";\n      rgb = rgb.substr(4).split(\")\")[0].split(sep);\n      \n      // convert %s to 0255\n      for (let R in rgb) {\n          let r = rgb[R];\n          if (r.indexOf(\"%\") > -1)\n              rgb[R] = Math.round(r.substr(0,r.length - 1) / 100 * 255);\n      }\n\n      // make r, g, and b fractions of 1\n      let r = rgb[0] / 255,\n          g = rgb[1] / 255,\n          b = rgb[2] / 255,\n\n      // find greatest and smallest channel values\n          cmin = Math.min(r,g,b),\n          cmax = Math.max(r,g,b),\n          delta = cmax - cmin,\n          h = 0,\n          s = 0,\n          l = 0;\n\n      // calculate hue\n      // no difference\n      if (delta == 0)\n          h = 0;\n      // red is max\n      else if (cmax == r)\n          h = ((g - b) / delta) % 6;\n      // green is max\n      else if (cmax == g)\n          h = (b - r) / delta + 2;\n      // blue is max\n      else\n          h = (r - g) / delta + 4;\n\n      h = Math.round(h * 60);\n\n      // make negative hues positive behind 360\n      if (h < 0)\n          h += 360;\n\n      // calculate lightness\n      l = (cmax + cmin) / 2;\n\n      // calculate saturation\n      s = delta == 0 ? 0 : delta / (1 - Math.abs(2 * l - 1));\n\n      // multiply l and s by 100\n      s = +(s * 100).toFixed(1);\n      l = +(l * 100).toFixed(1);\n      \n\n\n      if(mode==\"light\"){\n        if(type==\"container\"){\n          \n          var x = 100-l;\n          var a=10;\n          var c=2;\n          var bi=0.96;\n          var y= a*(Math.pow(bi, x))+c;\n          l=y;\n\n          //l = 100-l;\n\n        }else{\n          l = 100-l;\n\n        }\n        //(lightness* -100)/255\n      }else if(mode==\"dark\"){\n       \n        if(type==\"text\"){\n          var x = 100-l;\n          var a=10;\n          var c=5;\n          var bi=0.96;\n          var y= a*(Math.pow(bi, x))+c;\n          l=100-y;\n\n          //l = 100-l;\n\n        }else{\n          l = 100-l;\n        }\n\n      }else{\n\n        //dont exced limits\n        var s_color= -50;\n        var transformed_color= s+s_color;\n        if(transformed_color>=100){\n          s=100;\n        }else if(transformed_color<=0){\n          s=0;\n        }else{\n          s+=s_color;\n        }\n        s=75;\n        l=65;\n        \n      }\n      //l_darkmode, s_color,\n      if(l>100){\n        var lu= 100;\n      }else{\n        var lu= l;\n\n      }\n\n     // console.log(\"transformed hsl(\" + h + \",\" + s + \"%,\" + lu + \"%)\");\n      return \"hsl(\" + h + \",\" + s + \"%,\" + lu + \"%)\";\n\n  } else {\n      return \"Invalid input color\";\n  }\n}\n\n\n\n\nfunction HSLToHex(hsl) {\n  let ex = /^hsl\\(((((([12]?[1-9]?\\d)|[12]0\\d|(3[0-5]\\d))(\\.\\d+)?)|(\\.\\d+))(deg)?|(0|0?\\.\\d+)turn|(([0-6](\\.\\d+)?)|(\\.\\d+))rad)((,\\s?(([1-9]?\\d(\\.\\d+)?)|100|(\\.\\d+))%){2}|(\\s(([1-9]?\\d(\\.\\d+)?)|100|(\\.\\d+))%){2})\\)$/i;\n  if (ex.test(hsl)) {\n      let sep = hsl.indexOf(\",\") > -1 ? \",\" : \" \";\n      hsl = hsl.substr(4).split(\")\")[0].split(sep);\n\n      let h = hsl[0],\n          s = hsl[1].substr(0,hsl[1].length - 1) / 100,\n          l = hsl[2].substr(0,hsl[2].length - 1) / 100;\n  \n      // strip label and convert to degrees (if necessary)\n      if (h.indexOf(\"deg\") > -1)\n          h = h.substr(0,h.length - 3);\n      else if (h.indexOf(\"rad\") > -1)\n          h = Math.round(h.substr(0,h.length - 3) * (180 / Math.PI));\n      else if (h.indexOf(\"turn\") > -1)\n          h = Math.round(h.substr(0,h.length - 4) * 360);\n      if (h >= 360)\n          h %= 360;\n      \n      let c = (1 - Math.abs(2 * l - 1)) * s,\n          x = c * (1 - Math.abs((h / 60) % 2 - 1)),\n          m = l - c/2,\n          r = 0,\n          g = 0,\n          b = 0;\n      \n      if (0 <= h && h < 60) {\n          r = c; g = x; b = 0;\n      } else if (60 <= h && h < 120) {\n          r = x; g = c; b = 0;\n      } else if (120 <= h && h < 180) {\n          r = 0; g = c; b = x;\n      } else if (180 <= h && h < 240) {\n          r = 0; g = x; b = c;\n      } else if (240 <= h && h < 300) {\n          r = x; g = 0; b = c;\n      } else if (300 <= h && h < 360) {\n          r = c; g = 0; b = x;\n      }\n      // having obtained RGB, convert channels to hex\n      r = Math.round((r + m) * 255).toString(16);\n      g = Math.round((g + m) * 255).toString(16);\n      b = Math.round((b + m) * 255).toString(16);\n      \n      // prepend 0s if necessary\n      if (r.length == 1)\n          r = \"0\" + r;\n      if (g.length == 1)\n          g = \"0\" + g;\n      if (b.length == 1)\n          b = \"0\" + b;\n      \n      return \"#\" + r + g + b;\n\n  } else {\n      return \"Invalid input color\";\n  }\n}\n\nfunction hexToRgba(hex) {\n\n   // var hex = h.substr(0, 7);\n    var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex.substr(0, 7));\n    if(hex.length>7){\n      var alpha = parseInt(hex.slice(7, 9), 16);\n    }else{\n      var alpha=255;\n    }\n\n    return result ? {\n      r: parseInt(result[1], 16),\n      g: parseInt(result[2], 16),\n      b: parseInt(result[3], 16),\n      a: alpha\n    } : null;\n\n  }\nexport function createDivider(frame) {\n\tvar divider = NSView.alloc().initWithFrame(frame);\n\n\tdivider.setWantsLayer(1);\n\tdivider.layer().setBackgroundColor(CGColorCreateGenericRGB(204/255,204/255,204/255,1.0));\n\n\treturn divider;\n}\nexport function createField(value,frame) {\n\tvar field = NSTextField.alloc().initWithFrame(frame);\n\n\tfield.setStringValue(value);\n    field.delegate = self\n\n\treturn field;\n}\nexport function createFieldnoBack(value,frame) {\n\tvar field = NSTextField.alloc().initWithFrame(frame);\n\n    field.setStringValue(value);\n    field.setDrawsBackground(false);\n    field.delegate = self\n\n\treturn field;\n}\nexport function createFieldControl(value,frame) {\n\tvar field = NSControl.alloc().initWithFrame(frame);\n\n\tfield.setStringValue(value);\n    field.delegate = self\n\n\treturn field;\n}\nexport function setKeyOrder(alert,order) {\n\tfor (var i = 0; i < order.length; i++) {\n\t\tvar thisItem = order[i],\n\t\t\tnextItem = order[i+1];\n\n\t\tif (nextItem) thisItem.setNextKeyView(nextItem);\n\t}\n\n\talert.window().setInitialFirstResponder(order[0]);\n}\n\nexport function validateColorInput( code_array, name_array, add){  \n    \n    var validated_array=[];\n    if(add){\n      var a_length=code_array.length;\n    }else{\n      var a_length=code_array.length-1;\n\n    }\n    for(var i=0; i<a_length ; i++){\n        var count_repeated=0;\n        var code= code_array[i].stringValue();\n/*\n        for(var j=0; j<validated_array.length; j++){\n          if(code==validated_array[j]){\n            count_repeated++;\n            break;\n\n          }\n        }\n        */\n\n        if(count_repeated==0){\n          if(/^#[0-9A-F]{8}$/i.test(code) || /^#[0-9A-F]{6}$/i.test(code)){\n              validated_array.push({\"name\":name_array[i].stringValue() , \"code\":code_array[i].stringValue() });\n\n          }\n        }\n    }\n   \n    return validated_array;\n}\n\n\nexport function OrganizeArrayTextStyles(styles){\n    var array=[];\n    var cur_style, cur_style_name;\n\n    for(var i=0; i<styles.length; i++){\n      \n      var style_fontSize= styles[i].style.fontSize;\n      var style_name= styles[i].name;\n\n      if(style_name.indexOf(\"/\") !== -1){\n        var style_name_array= style_name.split(\"/\");\n        var s_name= style_name_array[0];\n\n      }else{\n        var s_name= style_name;\n\n\n      }\n        if(array.length==0){\n            array.push({\"group\": s_name ,\"styles\": [styles[i]], \"group_size\":style_fontSize});\n            cur_style_name=s_name;\n\n        }else{\n          var has_group=false;\n          var has_group_id=0;\n          for(var j=0; j<array.length; j++){\n            if(s_name==array[j].group){\n              has_group=true;\n              has_group_id=j;\n              break;\n            }\n          }\n          if(has_group){\n            array[has_group_id].styles.push( styles[i]);\n\n          }else{\n            array.push({\"group\": s_name ,\"styles\": [styles[i]], \"group_size\":style_fontSize});\n            cur_style_name=s_name;\n\n          }\n        }\n\n      }\n    \n    return array;\n}\n\n\n\n\nfunction updateElementStyle(element, style){\n  element.sharedStyleId=style.id;\n  element.sharedStyle=style;\n  element.style=style.style;\n  element.style.syncWithSharedStyle(style);\n\n}\n\nfunction addNewStyle(document,element ,style_type, style, added, styles){\n  var this_name= \"DarkModeSystem/\"+element+\"-\"+added+\"/lightMode\";\n  styles.push({\n    name: this_name,\n    style: style,\n    styleType: style_type,\n    document: document\n  })\n  return styles;\n}\n\nfunction getLayerArtboard(p){\n  var parent_top=p;\n  var artboar_id=p.id;\n  if(parent_top.parent.type!=\"Page\"){\n    \n    while(parent_top.type!=\"Artboard\" && parent_top.type!=\"SymbolMaster\"  && parent_top.type!=\"Page\" ){\n\n      parent_top= parent_top.parent;\n      artboar_id= parent_top.id;\n    }\n  }\n  return artboar_id;\n\n}\nexport function reviewSettings(Settings,  document){\n\n  var all_settings= Settings.settingForKey('Styles');\n\n  console.log(\"Step 0 - Reviewing Settings...\");\n  //console.log(all_settings);\n  var reviewed_settings=[]\n  for(var i=0; i<all_settings.length; i++){\n    var dark_id= all_settings[i].dark;\n    var light_id= all_settings[i].light;\n\n    if(all_settings[i].type==\"text\"){\n      var sharedStyle_light = document.getSharedTextStyleWithID(light_id)\n      var sharedStyle_dark = document.getSharedTextStyleWithID(dark_id)\n    }else{\n      var sharedStyle_light = document.getSharedLayerStyleWithID(light_id)\n      var sharedStyle_dark = document.getSharedLayerStyleWithID(dark_id)\n    }\n      //console.log(sharedStyle_dark);\n      //console.log(sharedStyle_light);\n\n    if(sharedStyle_light===undefined || sharedStyle_dark===undefined){\n     // console.log(\"there is one settings missing\");\n    }else{\n      reviewed_settings.push(all_settings[i]);\n    }\n\n  }\n  return reviewed_settings;\n  \n}\n\nexport function syncLayerwithStyles_best(Settings, sketch, document, page){\n  //var all_layer= sketch.find('*', document.pages[page]);\n  var all_shapes= sketch.find('Shape', document.pages[page]);\n  var all_shapesPaths= sketch.find('ShapePath', document.pages[page]);\n  var all_texts= sketch.find('Text', document.pages[page]);\n\n  var layer_styles = document.sharedLayerStyles;\n  var text_styles = document.sharedTextStyles;\n  var count_added=document.sharedLayerStyles.length+document.sharedTextStyles.length;\n\n\n  var all_settings= Settings.settingForKey('Styles');\n\n  console.log(\"initial styles\"+count_added);\n  console.log(\"Step 1 - Validating...\");\n  \n  var count=0;\n  var colored_containers=[];\n  var new_styles=[];\n  var percentage=0;\n  var count_shapePath_added=0;\n\n  var container_min_width=200;\n  var container_min_height=200;\n\n\n\n  // DO CONTAINERS\n  var percentage=0;\n  var count_shapePath_added=0;\n  for(var i=0; i<all_shapesPaths.length;i++ ){\n    if(all_shapesPaths[i].frame.width>container_min_width && all_shapesPaths[i].frame.height>container_min_height  && all_shapesPaths[i].shapeType==\"Rectangle\"){\n      count++;\n      if(percentage != parseInt(i*100 /all_shapesPaths.length)){\n        console.log(\"Containers 1 - \"+percentage+\"%\");\n        percentage = parseInt(i*100 /all_shapesPaths.length);\n      }\n\n      var count_fills=0;\n      for (var s=0; s<all_shapesPaths[i].style.fills.length; s++){\n        if(all_shapesPaths[i].style.fills[s].enabled==true){\n          var color= all_shapesPaths[i].style.fills[s].color;\n          break;\n        }\n      }\n      var color_rgb= hexToRgba(color);\n      if( Math.abs(color_rgb.r-color_rgb.g)<50 && Math.abs(color_rgb.r-color_rgb.b)<50){\n        var container= \"container_monotone\";\n\n      }else{\n      var container= \"container_color\";\n\n      }\n      //Processing layers and its shared styles \n      var hasStyle= elementHasStyle (layer_styles, all_shapesPaths[i].sharedStyleId) ;\n      var isOutOfSync = true;\n      if(hasStyle!=false){\n        isOutOfSync = all_shapesPaths[i].style.isOutOfSyncWithSharedStyle(hasStyle);\n      }\n      var is_inside_colored_container= false;\n\n     if(!hasStyle || hasStyle && isOutOfSync ){\n       var hasMatchingStyle= elementHasMatchingStyle(layer_styles, all_shapesPaths[i].style);\n\n       // get setting with macthcing style\n       var hasmach_butnot=false;\n        if(hasMatchingStyle){\n          for (var n=0; n<all_settings.length; n++){\n            if(all_settings[n].light==hasMatchingStyle.id){\n              if(all_settings[n].element != container){\n                hasmach_butnot_setting=true;\n                break;\n              }else{\n                break;\n              }\n            }\n          }\n        }\n       if(!hasMatchingStyle || hasmach_butnot){\n         //create new style\n         count_shapePath_added++;\n         layer_styles= addNewStyle(document,\"Shape\",\"Layer\", all_shapesPaths[i].style, count_shapePath_added,layer_styles) ;\n \n         //update element\n         var last =layer_styles.length-1;\n         updateElementStyle(all_shapesPaths[i], layer_styles[last]);\n\n         //Create new setting\n         var element_size=all_shapesPaths[i].frame;     \n         var layer_artboard= getLayerArtboard(all_shapesPaths[i]);\n         if(container== \"container_color\"){\n           var frame_absolute= getFrameAbsoluteFrame(all_shapesPaths[i]);\n           var this_frame= { \"x\":frame_absolute.x, \"y\": frame_absolute.y, \"width\": all_shapesPaths[i].frame.width, \"height\":all_shapesPaths[i].frame.height};\n           colored_containers.push({\"artboard\": layer_artboard, \"container\":this_frame});  \n         }\n         //console.log(\"COLORED CONTAINER!!!\"); \n          \n         new_styles.push({\"action\":\"new\",\"type\": \"layer\",\"element\":container, \"id\":layer_styles[last].id});\n \n       }else{\n         //update element\n         updateElementStyle(all_shapesPaths[i], hasMatchingStyle);\n\n        //add setting if it doesn't exist\n        var element_size=all_shapesPaths[i].frame;\n        var layer_artboard= getLayerArtboard(all_shapesPaths[i]);\n        if(container== \"container_color\"){\n          var frame_absolute= getFrameAbsoluteFrame(all_shapesPaths[i]);\n          var this_frame= { \"x\":frame_absolute.x, \"y\": frame_absolute.y, \"width\": all_shapesPaths[i].frame.width, \"height\":all_shapesPaths[i].frame.height};\n          colored_containers.push({\"artboard\": layer_artboard, \"container\":this_frame}); \n        }\n        //console.log(\"COLORED CONTAINER!!!\"); \n    \n         var hasSettings=ifStylesavedInSettings(document, all_settings,new_styles, hasMatchingStyle.id, \"layer\");\n         if(!hasSettings){\n          new_styles.push({\"action\":\"link\", \"type\": \"layer\",\"element\":container, \"id\":hasMatchingStyle.id});\n         }\n       }\n     //has synced style\n     }else{\n       //update element\n       updateElementStyle(all_shapesPaths[i], hasStyle);\n\n      //add setting if it doesn't exist\n      var element_size=all_shapesPaths[i].frame;\n      var layer_artboard= getLayerArtboard(all_shapesPaths[i]);\n      if(container== \"container_color\"){\n        var frame_absolute= getFrameAbsoluteFrame(all_shapesPaths[i]);\n        var this_frame= { \"x\":frame_absolute.x, \"y\": frame_absolute.y, \"width\": all_shapesPaths[i].frame.width, \"height\":all_shapesPaths[i].frame.height};\n        colored_containers.push({\"artboard\": layer_artboard, \"container\":this_frame});\n      }\n      //console.log(\"COLORED CONTAINER!!!\"); \n       \n      var hasSettings=ifStylesavedInSettings(document, all_settings,new_styles, hasStyle.id, \"layer\");\n      if(!hasSettings){\n        new_styles.push({\"action\":\"save_setting\", \"type\": \"layer\",\"element\":container, \"id\":hasStyle.id});\n        }\n      }\n    }\n  }\n\n  // DO SHAPES PATHS\n  for(var i=0; i<all_shapesPaths.length;i++ ){\n    if(all_shapesPaths[i].frame.width<container_min_width || all_shapesPaths[i].frame.height<container_min_height  || all_shapesPaths[i].shapeType!=\"Rectangle\"){\n    count++;\n    if(percentage != parseInt(i*100 /all_shapesPaths.length)){\n      console.log(\"Shapes paths 1 - \"+percentage+\"%\");\n      percentage = parseInt(i*100 /all_shapesPaths.length);\n    }\n    var count_fills=0;\n    for (var s=0; s<all_shapesPaths[i].style.fills.length; s++){\n      if(all_shapesPaths[i].style.fills[s].enabled==true){\n        count_fills++;\n        break;\n      }\n    }\n    \n    var element_size=\"small\";\n\n     //Processing layers and its shared styles \n     var hasStyle= elementHasStyle (layer_styles, all_shapesPaths[i].sharedStyleId) ;\n     var isOutOfSync = true;\n     if(hasStyle!=false){\n       isOutOfSync = all_shapesPaths[i].style.isOutOfSyncWithSharedStyle(hasStyle);\n     }\n     var is_inside_colored_container= TextinsideColoredContainer(all_shapesPaths[i], colored_containers);\n\n     if(!hasStyle || hasStyle && isOutOfSync ){\n       var hasMatchingStyle= elementHasMatchingStyle(layer_styles, all_shapesPaths[i].style);\n\n       // is has matching style but one is hover a colored container and the other is not\n       var hasmach_butnot=false;\n        if(hasMatchingStyle){\n          for (var n=0; n<new_styles.length; n++){\n            if(new_styles[n].id==hasMatchingStyle.id ){\n              if(new_styles[n].colored_container != is_inside_colored_container){\n                hasmach_butnot=true;\n                break;\n              }else{\n                break;\n              }\n\n            }\n          }\n        }\n        var hasmach_butnot_setting=false;\n        if(hasMatchingStyle && !hasmach_butnot){\n          for (var n=0; n<all_settings.length; n++){\n            if(all_settings[n].light==hasMatchingStyle.id){\n              if(all_settings[n].element != element_size){\n                hasmach_butnot_setting=true;\n                break;\n              }else{\n                break;\n              }\n\n            }\n          }\n        }\n       if(!hasMatchingStyle || hasmach_butnot || hasmach_butnot_setting){\n         //create new style\n         count_shapePath_added++;\n         layer_styles= addNewStyle(document,\"Shape\",\"Layer\", all_shapesPaths[i].style, count_shapePath_added,layer_styles) ;\n \n         //update element\n         var last =layer_styles.length-1;\n         updateElementStyle(all_shapesPaths[i], layer_styles[last]);\n\n         //Create new setting\n         new_styles.push({\"action\":\"new\",\"type\": \"layer\",\"colored_container\":is_inside_colored_container,\"element\":element_size, \"id\":layer_styles[last].id, \"layerName\": all_shapesPaths[i].name});\n \n       }else{\n         //update element\n         updateElementStyle(all_shapesPaths[i], hasMatchingStyle);\n\n         //add setting if it doesn't exist\n         var hasSettings=ifStylesavedInSettings(document, all_settings,new_styles, hasMatchingStyle.id, \"layer\");\n         if(!hasSettings){\n           new_styles.push({\"action\":\"link\", \"type\": \"layer\",\"colored_container\":is_inside_colored_container,\"element\":element_size, \"id\":hasMatchingStyle.id, \"layerName\": all_shapesPaths[i].name});\n         }\n       }\n     //has synced style\n     }else{\n       //update element\n       updateElementStyle(all_shapesPaths[i], hasStyle);\n\n      //add setting if it doesn't exist\n      var hasSettings=ifStylesavedInSettings(document, all_settings,new_styles, hasStyle.id, \"layer\");\n      if(!hasSettings){\n        new_styles.push({\"action\":\"save_setting\", \"type\": \"layer\",\"colored_container\":is_inside_colored_container,\"element\": element_size, \"id\":hasStyle.id, \"layerName\": all_shapesPaths[i].name});\n \n      }\n    }\n  }\n}\n\n  //DO SHAPES\n  var percentage=0;\n  var count_shape_added=0;\n  for(var i=0; i<all_shapes.length;i++ ){\n    count++;\n    //progress\n    if(percentage != parseInt(i*100 /all_shapes.length)){\n      console.log(\"Shapes 1 - \"+percentage+\"%\");\n      percentage = parseInt(i*100 /all_shapes.length);\n    }\n    var element_size=\"small\";\n\n    //Processing layers and its shared styles \n    var hasStyle= elementHasStyle (layer_styles, all_shapes[i].sharedStyleId) ;\n    var isOutOfSync = true;\n    if(hasStyle!=false){\n      isOutOfSync = all_shapes[i].style.isOutOfSyncWithSharedStyle(hasStyle);\n    }\n    var is_inside_colored_container= TextinsideColoredContainer(all_shapes[i], colored_containers);\n\n    if(!hasStyle || hasStyle && isOutOfSync ){\n      var hasMatchingStyle= elementHasMatchingStyle(layer_styles, all_shapes[i].style);\n       // is has matching style but one is hover a colored container and the other is not\n       var hasmach_butnot=false;\n        if(hasMatchingStyle){\n          for (var n=0; n<new_styles.length; n++){\n            if(new_styles[n].id==hasMatchingStyle.id ){\n              if(new_styles[n].colored_container != is_inside_colored_container){\n                hasmach_butnot=true;\n                break;\n              }else{\n                break;\n              }\n\n            }\n            \n            \n          }\n        }\n        var hasmach_butnot_setting=false;\n        if(hasMatchingStyle && !hasmach_butnot){\n          for (var n=0; n<all_settings.length; n++){\n            if(all_settings[n].light==hasMatchingStyle.id){\n              if(all_settings[n].element != element_size){\n                hasmach_butnot_setting=true;\n                break;\n              }else{\n                break;\n              }\n\n            }\n          }\n        }\n       if(!hasMatchingStyle || hasmach_butnot || hasmach_butnot_setting){\n        //create new style\n        count_shape_added++;\n        layer_styles= addNewStyle(document,\"Shape\",\"Layer\", all_shapes[i].style, count_shape_added, layer_styles) ;\n\n        //update element\n        var last =layer_styles.length-1;\n        updateElementStyle(all_shapes[i], layer_styles[last]);\n\n        //Create new setting\n        new_styles.push({\"action\":\"new\",\"type\": \"layer\",\"colored_container\":is_inside_colored_container, \"element\": element_size, \"id\":layer_styles[last].id, \"layerName\": all_shapes[i].name});\n\n      }else{\n        //update element\n        updateElementStyle(all_shapes[i], hasMatchingStyle);\n\n        //add setting if it doesn't exist\n        var hasSettings=ifStylesavedInSettings(document, all_settings,new_styles, hasMatchingStyle.id, \"layer\");\n        if(!hasSettings){\n          new_styles.push({\"action\":\"link\", \"type\": \"layer\",\"colored_container\":is_inside_colored_container, \"element\": element_size, \"id\":hasMatchingStyle.id, \"layerName\": all_shapes[i].name});\n        }\n      }\n    //has synced style\n    }else{\n      //update element\n      updateElementStyle(all_shapes[i], hasStyle);\n\n      //add setting if it doesn't exist\n      var hasSettings=ifStylesavedInSettings(document, all_settings,new_styles, hasStyle.id, \"layer\");\n      if(!hasSettings){\n        new_styles.push({\"action\":\"save_setting\", \"type\": \"layer\", \"colored_container\":is_inside_colored_container, \"element\":element_size, \"id\":hasStyle.id, \"layerName\": all_shapes[i].name});\n\n      }\n    }\n  }\n\n  \n  //DO TEXTS\n  var percentage=0;\n  var count_text_added=0;\n  for(var i=0; i<all_texts.length;i++ ){\n    count++;\n    if(percentage != parseInt(i*100 /all_texts.length)){\n      console.log(\"Texts 1 - \"+percentage+\"%\");\n      percentage = parseInt(i*100 /all_texts.length);\n\n    }\n    //Processing layers and its shared styles \n    var hasStyle= elementHasStyle (text_styles, all_texts[i].sharedStyleId) ;\n    var isOutOfSync = true;\n    if(hasStyle!=false){\n      isOutOfSync = all_texts[i].style.isOutOfSyncWithSharedStyle(hasStyle);\n    }\n    var is_inside_colored_container= TextinsideColoredContainer(all_texts[i], colored_containers);\n\n    if(!hasStyle || hasStyle && isOutOfSync ){\n      var hasMatchingStyle= elementHasMatchingStyle(text_styles, all_texts[i].style);    \n      // is has matching style but one is hover a colored container and the other is not\n      var hasmach_butnot=false;\n      var hasmach_butnot_setting=false;\n\n      //if matching style founf is in new styles\n      if(hasMatchingStyle){\n        for (var n=0; n<new_styles.length; n++){\n          if(new_styles[n].id==hasMatchingStyle.id ){\n            if(new_styles[n].colored_container != is_inside_colored_container){\n              hasmach_butnot=true;\n              break;\n            }else{\n              break;\n            }\n\n          }\n        }\n      }\n      var hasmach_butnot_setting=false;\n      if(hasMatchingStyle && !hasmach_butnot){\n        for (var n=0; n<all_settings.length; n++){\n          if(all_settings[n].light==hasMatchingStyle.id){\n            if(all_settings[n].element != \"text\"){\n              hasmach_butnot_setting=true;\n              break;\n            }else{\n              break;\n            }\n\n          }\n         \n        }\n      }\n     if(!hasMatchingStyle || hasmach_butnot || hasmach_butnot_setting){  \n        //create new style\n        count_text_added++;\n        var layerName;\n        if( all_texts[i].style.fontSize<13){\n          layerName= \"Text-Small\";\n        }else if( all_texts[i].style.fontSize<16){\n          layerName= \"Text-Body\";\n        }else{\n          layerName= \"Text-Heading\";\n        }\n        text_styles= addNewStyle(document,layerName,\"Text\", all_texts[i].style, count_text_added,text_styles) ;\n\n        //update element\n        var last =text_styles.length-1;\n        updateElementStyle(all_texts[i], text_styles[last]);\n\n        //Create new setting\n        new_styles.push({\"action\":\"new\",\"type\": \"text\", \"colored_container\":is_inside_colored_container, \"id\":text_styles[last].id, \"layerName\": all_texts[i].name});\n\n      }else{\n        //update element\n        updateElementStyle(all_texts[i], hasMatchingStyle);\n\n        //add setting if it doesn't exist\n        var hasSettings=ifStylesavedInSettings(document, all_settings,new_styles, hasMatchingStyle.id, \"text\");\n        if(!hasSettings){\n          new_styles.push({\"action\":\"link\", \"type\": \"text\",\"colored_container\":is_inside_colored_container,  \"id\":hasMatchingStyle.id, \"layerName\": all_texts[i].name});\n        \n        }\n      }\n     \n    //has synced style\n    }else{\n      //update element\n      updateElementStyle(all_texts[i], hasStyle);\n\n      //add setting if it doesn't exist\n      var hasSettings=ifStylesavedInSettings(document, all_settings,new_styles, hasStyle.id, \"text\");\n      if(!hasSettings){\n        var is_inside_colored_container= TextinsideColoredContainer(all_texts[i], colored_containers);\n        new_styles.push({\"action\":\"save_setting\", \"type\": \"text\", \"colored_container\":is_inside_colored_container,  \"id\":hasStyle.id, \"layerName\": all_texts[i].name});\n\n      }\n\n   }\n\n  }\n  //new_styles = new_container_styles.concat(new_styles);\n  //console.log(colored_containers);\n  //console.log(\"initial styles\"+count_added);\n  return {\"layer\":layer_styles, \"text\":text_styles, \"new_styles\": new_styles};\n\n}\nfunction TextinsideColoredContainer(text_element, colored_containers){\n  \n  var is_inside_colored_container=false;\n  var layer_artboard= getLayerArtboard(text_element);\n  var same_artboard=false;\n  var frame_absolute= getFrameAbsoluteFrame(text_element);\n\n  for(var c=0; c< colored_containers.length; c++){\n    if(layer_artboard == colored_containers[c].artboard){\n      same_artboard=colored_containers[c];\n     \n      if(frame_absolute.x >= same_artboard.container.x && frame_absolute.x <= (same_artboard.container.x+same_artboard.container.width)\n      && frame_absolute.y >= same_artboard.container.y && frame_absolute.y <= (same_artboard.container.y+same_artboard.container.height)\n      ){\n        is_inside_colored_container=true;\n      }\n  }\n}\n  return is_inside_colored_container;\n}\nfunction getFrameAbsoluteFrame(p){\n  let parent_top=p;\n  let sum_x=p.frame.x;\n  let sum_y=p.frame.y;\n  if(parent_top.parent.type!=\"Page\"){\n    while(parent_top.type!=\"Artboard\" && parent_top.type!=\"SymbolMaster\"  && parent_top.type!=\"Page\"  ){\n      parent_top= parent_top.parent;\n      if(parent_top.type!=\"Artboard\" && parent_top.type!=\"SymbolMaster\"  && parent_top.type!=\"Page\"  ){\n          sum_x+=parent_top.frame.x;\n          sum_y+=parent_top.frame.y;\n      }\n    }\n  }\n  return {\"x\":sum_x, \"y\":sum_y};\n}\nfunction elementHasMatchingStyle(all_styles, style){\n  var repeated=false;\n  //console.log(all_styles);\n \n\n  for(var i= 0; i< all_styles.length; i++){\n    var isOutOfSync = style.isOutOfSyncWithSharedStyle(all_styles[i]);\n    var originLibrary = all_styles[i].getLibrary();\n\n    if(!isOutOfSync && originLibrary==null){\n      repeated=all_styles[i];\n      break;\n    }\n  }\n  \n  return repeated;\n  \n\n}\n\nfunction ifStylesavedInSettings(document, all_settings, new_styles,  style_id, type){\n  var repeated=false;\n  //console.log(all_styles);\n \n  for(var i= 0; i< new_styles.length; i++){ \n    if(style_id == new_styles[i].id ){\n      repeated=i;\n      break;\n    }\n  }\n  //console.log(all_styles);\n  for(var i= 0; i< all_settings.length; i++){ \n   \n    if( style_id == all_settings.light ){\n      /*\n      if(type == \"layer\"){\n        var style_dark=document.getSharedLayerStyleWithID(all_settings.dark );\n        var style_light=document.getSharedLayerStyleWithID(all_settings.light );\n      }else{\n        var style_dark=document.getSharedTextStyleWithID(all_settings.dark );\n        var style_light=document.getSharedTextStyleWithID(all_settings.light );\n        \n      }\n      */\n     if(type == \"layer\"){\n        var style_dark=document.getSharedLayerStyleWithID(all_settings.dark );\n      }else{\n        var style_dark=document.getSharedTextStyleWithID(all_settings.dark );\n        \n    }\n    if(style_dark!=undefined){\n      repeated=all_settings[i];\n    }\n    break;\n    }\n  }\n  return repeated;\n}\n\nexport function createDarkModeStyle(Settings, document,styles_layer,styles_text, new_styles ){\n  sketch.UI.message(' Doing step 2,  Creating Dark Mode......'); \n\n    console.log(\".........................................\");\n    console.log(\"Step 2 - Create Dark Mode Layer Styles...\");\n    var percentage_layer=0;\n    var percentage_text=0;\n    \n    var s_styles= Settings.settingForKey('Styles');\n    //layer color\n    var new_styles_layer= styles_layer;\n    var new_styles_text= styles_text;\n\n    //console.log(\"number of styles\"+new_styles.length);\n    //DO LAYERS\n    for(var i=0; i<new_styles.length; i++){\n      //VIEW OF PROGRESS\n      if(parseInt(percentage_layer) != parseInt(i*100 /new_styles.length)){\n        console.log(\"Step 2 - \"+percentage_layer+\"%\");\n        percentage_layer = parseInt(i*100 /new_styles.length);\n      }\n\n      \n      //CREATE STYLE LAYER\n      if(new_styles[i].type==\"layer\"){\n        //GET SHARED STYLE\n        var shared_style = getStyleById(styles_layer, new_styles[i].id);\n        // var shared_style = document.getSharedLayerStyleWithID(new_styles[i].id);\n        var s_style_name= shared_style.name;\n  \n  \n  \n        //GET CLEAN NAMES\n        if( s_style_name.includes(\"lightMode\")){\n          var clean_name = s_style_name.replace(\"/lightMode\", \"\").replace(\" \", \"\");\n        }else{\n          var clean_name = s_style_name.replace(\" \", \"\");\n          shared_style.name= shared_style.name+\"/lightMode\";\n  \n        }\n        var dark_name = clean_name+\"/DarkMode\";\n \n        new_styles_layer.push({\n            name: dark_name,\n            style: shared_style.style,\n            styleType: \"Layer\",\n            document: document\n        })\n        var last_style=new_styles_layer.length-1;\n        var transformMode;\n        \n         if(new_styles[i].colored_container==true ){\n          transformMode= \"in_colored_container\";\n        }else if(new_styles[i].element == \"small\"){\n          transformMode= \"Shape\";\n        }else{\n          transformMode= \"container\";\n        }\n\n        //change Fill\n        if( shared_style.style.fills.length>0){\n          //loop through all fills\n          for(var f=0; f<shared_style.style.fills.length; f++){\n            //if gradient\n            if(shared_style.style.fills[f].fillType==\"Gradient\"){\n              for(var g=0; g<shared_style.style.fills[f].gradient.stops.length; g++){\n                var newcolor= transformColor(shared_style.style.fills[f].gradient.stops[g].color, transformMode);\n                new_styles_layer[last_style].style.fills[f].gradient.stops[g].color=newcolor;\n              }\n            //normal fill\n            }else{\n              var newcolor= transformColor(shared_style.style.fills[f].color, transformMode);\n              new_styles_layer[last_style].style.fills[f].color= newcolor;\n\n            }\n          }\n        }\n        //change border\n        if( shared_style.style.borders.length>0){\n          //loop through all fills\n          for(var b=0; b<shared_style.style.borders.length; b++){\n            //iff gradient\n            if(shared_style.style.borders[b].fillType==\"Gradient\"){\n              for(var g=0; g<shared_style.style.borders[b].gradient.stops.length; g++){\n                var newcolor= transformColor(shared_style.style.borders[b].gradient.stops[g].color, transformMode);\n                new_styles_layer[last_style].style.borders[b].color=newcolor;\n              }\n            //normal fill\n            }else{\n              var newcolor= transformColor(shared_style.style.borders[b].color, transformMode);\n              new_styles_layer[last_style].style.borders[b].color=newcolor;\n\n            }\n          }\n        }\n\n        //change shadows\n        if( shared_style.style.shadows.length>0){\n          for(var s=0; s<shared_style.style.shadows.length; s++){\n            var newcolor= transformColor(shared_style.style.shadows[s].color, transformMode);\n            new_styles_layer[last_style].style.shadows[s].color= newcolor;\n\n          }\n        }\n\n        //change inner shadows\n        if( shared_style.style.innerShadows.length>0){\n          for(var s=0; s<shared_style.style.innerShadows.length; s++){\n            var newcolor= transformColor(shared_style.style.innerShadows[s].color, transformMode);\n            new_styles_layer[last_style].style.innerShadows[s].color= newcolor;\n\n          }\n        }\n\n        //add setting\n        s_styles.push({\"type\": \"layer\", \"element\":new_styles[i].element, \"light\": shared_style.id, \"dark\":new_styles_layer[last_style].id})\n        //console.log({\"type\": \"layer\", \"light\": shared_style.id, \"dark\":new_styles_layer[last_style].id});\n        //console.log( shared_style.id);\n      //CREATE TEXT LAYER\n      }else{\n        //GET SHARED STYLE\n        var shared_style = getStyleById(styles_text, new_styles[i].id);\n        // var shared_style = document.getSharedLayerStyleWithID(new_styles[i].id);\n       //console.log(shared_style);\n        var s_style_name= shared_style.name;\n        if( s_style_name.includes(\"lightMode\")){\n          var clean_name = s_style_name.replace(\"/lightMode\", \"\").replace(\" \", \"\");\n        }else{\n          var clean_name = s_style_name.replace(\" \", \"\");\n          shared_style.name= shared_style.name+\"/lightMode\";\n  \n        }\n        var dark_name = clean_name+\"/DarkMode\";\n\n\n\n        new_styles_text.push({\n          name: dark_name,\n          style: shared_style.style,\n          styleType: \"Layer\",\n          document: document\n        })\n        var last_style=new_styles_text.length-1;\n\n        if(new_styles[i].colored_container==true ){\n          transformMode= \"in_colored_container\";\n          }else{\n            transformMode= \"Text\";\n          }\n\n        //CHANGE TEXT COLOR\n        var layer_style_color= shared_style.style.textColor;\n\n        var newcolor= transformColor(layer_style_color, transformMode);\n\n        new_styles_text[last_style].style.textColor= newcolor;\n        s_styles.push({\"type\": \"text\", \"element\":\"text\", \"light\": shared_style.id, \"dark\":new_styles_text[last_style].id})\n        \n      }\n    }\n    \n    return {\"layer\":new_styles_layer, \"text\":new_styles_text, \"settings\": s_styles};\n\n}\n\nfunction transformColor(color, type){\n  if(color.length>7){\n    var alpha = color.slice(7, 9);\n  }else{\n    var alpha=\"ff\";\n  }\n  var dark_hex_hex= DarkMode(color,type);\n  var dark_hex= RGBToHex(\"rgb(\"+dark_hex_hex.r+\",\"+dark_hex_hex.g+\",\"+dark_hex_hex.b+\")\");\n  var dark_hex_alpha= dark_hex+alpha;\n\n  return dark_hex_alpha;\n\n}\n\n\nfunction getSettingStyle(id, dark, all_settings){\n  var opositde_mode=false;\n  //console.log(all_styles);\n\n  for(var i= 0; i< all_settings.length; i++){\n    if(i==all_settings.length-1 || i==all_settings.length-2){\n    //console.log(all_settings[i])\n    }\n\n    if(all_settings[i].light== id && dark==true){\n     // console.log(opositde_mode)\n      opositde_mode=all_settings[i].dark;\n      break;\n    }\n    if(all_settings[i].dark== id && dark==false){\n      //console.log(opositde_mode)\n      opositde_mode=all_settings[i].light;\n      break;\n    }\n  }\n  return opositde_mode;\n\n}\n\n\n\nexport function SwitchDarkMode_best(Settings, sketch, document, page , layer_styles, text_styles, dark){\n    console.log(\".........................................\");\n    var all_layer= sketch.find('*', document.pages[page]);      \n    var all_artboards= sketch.find('Artboard', document.pages[page]);\n    var all_shapes= sketch.find('Shape', document.pages[page]);\n    var all_shapesPaths= sketch.find('ShapePath', document.pages[page]);\n    var all_texts= sketch.find('Text', document.pages[page]);\n    var all_settings= Settings.settingForKey( 'Styles');\n\n    if(dark){\n      var this_mode=\"lightMode\";\n      var to_mode=\"DarkMode\";\n    }else{\n      var this_mode=\"DarkMode\";\n      var to_mode=\"lightMode\";\n    }\n    var count_switch=0;\n    console.log(\"Step 4 - Switch to \"+to_mode);\n    var percentage=0;\n    for(var i=0; i<all_shapes.length;i++ ){\n      if(percentage != parseInt(i*100 /all_shapes.length)){\n        console.log(\"Shapes 4 - \"+percentage+\"%\");\n        percentage = parseInt(i*100 /all_shapes.length);\n  \n      }\n      \n      var style_oposite_id= getSettingStyle(all_shapes[i].sharedStyleId , dark,all_settings);\n      if(style_oposite_id!=false){\n        //console.log(style_oposite_id);\n        var style_oposite = document.getSharedLayerStyleWithID(style_oposite_id);\n        //console.log(style_oposite);\n        \n        if(style_oposite!=undefined){\n        \n          all_shapes[i].sharedStyleId=style_oposite.id;\n          all_shapes[i].sharedStyle=style_oposite;\n          all_shapes[i].style=style_oposite.style;\n          all_shapes[i].style.syncWithSharedStyle(style_oposite);\n        }\n\n      }\n    }\n\n    var percentage=0;\n    for(var i=0; i<all_shapesPaths.length;i++ ){\n      if(percentage != parseInt(i*100 /all_shapesPaths.length)){\n        console.log(\"Shapes Paths 4 - \"+percentage+\"%\");\n        percentage = parseInt(i*100 /all_shapesPaths.length);\n  \n\n      }\n      //console.log(\"shape id \"+all_shapesPaths[i].sharedStyleId);\n      \n      var style_oposite_id= getSettingStyle(all_shapesPaths[i].sharedStyleId,dark,all_settings);\n      //console.log(all_shapesPaths[i].sharedStyleId);\n\n      //console.log(\"shape\"+style_oposite_id);\n      if(style_oposite_id!=false){\n        //console.log(\"style_oposite_id\");\n        var style_oposite = document.getSharedLayerStyleWithID(style_oposite_id);\n        if(style_oposite!=undefined){\n\n          all_shapesPaths[i].sharedStyleId=style_oposite.id;\n          all_shapesPaths[i].sharedStyle=style_oposite;\n          all_shapesPaths[i].style=style_oposite.style;\n          all_shapesPaths[i].style.syncWithSharedStyle(style_oposite);\n          count_switch++;\n\n        }\n      }\n    }\n\n    var percentage=0;\n    for(var i=0; i<all_texts.length;i++ ){\n      if(percentage != parseInt(i*100 /all_texts.length)){\n        console.log(\"Texts 4 - \"+percentage+\"%\");\n        percentage = parseInt(i*100 /all_texts.length);\n  \n      }\n\n      var style_oposite_id= getSettingStyle(all_texts[i].sharedStyleId, dark,all_settings);\n      if(style_oposite_id!=false){\n        var style_oposite = document.getSharedTextStyleWithID(style_oposite_id);\n        if(style_oposite!=undefined){\n\n          all_texts[i].sharedStyleId=style_oposite.id;\n          all_texts[i].sharedStyle=style_oposite;\n          all_texts[i].style=style_oposite.style;\n          all_texts[i].style.syncWithSharedStyle(style_oposite);\n          count_switch++;\n\n        }\n      }\n\n    }\n    if(count_switch>0){\n      var percentage=0;\n      for(var i=0; i<all_artboards.length;i++ ){\n        console.log(\"Artboard - \"+i);\n\n        if(percentage != parseInt(i*100 /all_artboards.length)){\n          console.log(\"Artboards 4 - \"+percentage+\"%\");\n          percentage = parseInt(i*100 /all_artboards.length);\n        }\n\n        //CHANGE TEXT COLOR\n        if( all_artboards[i].background.enabled==false){\n          var layer_style_color= \"#ffffff\";\n          \n        }else{\n          var layer_style_color= all_artboards[i].background.color;\n        }\n\n        var alpha=\"ff\";\n        var dark_hex_hex= DarkMode(layer_style_color, \"Artboard\");\n        var dark_hex= RGBToHex(\"rgb(\"+dark_hex_hex.r+\",\"+dark_hex_hex.g+\",\"+dark_hex_hex.b+\")\");\n\n\n        var new_artboard_color=dark_hex+alpha;\n        all_artboards[i].background.color=new_artboard_color;\n        all_artboards[i].background.enabled=true;\n\n      }\n    }\n    return count_switch;\n  \n}","module.exports = require(\"path\");","module.exports = require(\"sketch\");","module.exports = require(\"sketch/dom\");","module.exports = require(\"sketch/settings\");"],"sourceRoot":""}