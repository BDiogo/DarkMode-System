{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./node_modules/balanced-match/index.js","webpack://exports/./node_modules/brace-expansion/index.js","webpack://exports/./node_modules/concat-map/index.js","webpack://exports/./node_modules/minimatch/minimatch.js","webpack://exports/./src/darkmode-system.js","webpack://exports/./src/functions.js","webpack://exports/external \"path\"","webpack://exports/external \"sketch\"","webpack://exports/external \"sketch/dom\"","webpack://exports/external \"sketch/settings\""],"names":["functions","require","page","pageInfo","Rectangle","TextDom","Text","Artboard","Settings","Style","SharedStyle","getSettings","context","DarkModeSystem","deleteAll","documentColors","DeleteAllSettings","switchDark","switchLight","createDarkmode","type","labels_alignments","pluginName","pluginDomain","document","sketch","getSelectedDocument","fieldHeight","fieldWidth","labelHeight","leftColWidth","settingPad","settingX","settingY","switchHeight","textOffset","windowHeight","windowWidth","get_settign_S","documentSettingForKey","setDocumentSettingForKey","get_settign_C","get_settign_L","get_settign_T","console","log","s_styles","s_colors","alert","NSAlert","alloc","init","alertIconPath","plugin","urlForResourceNamed","path","alertIcon","NSImage","initByReferencingFile","alertContent","NSView","initWithFrame","NSMakeRect","col_width","groupdefaultFont_label","createLabel","addSubview","CGRectGetMaxY","subviews","lastObject","frame","createBoldLabel","progress","createColoredBlock","pages_available","i","pages","length","all_shapes","find","all_shapesPaths","all_texts","total","push","name","selected_page","createPopUpButton","setIcon","setMessageText","setInformativeText","accessoryView","buttonOrganize","addButtonWithTitle","buttonCancel","responseCode","runModal","all_settings_l","reviewed_Settings_l","reviewSettings","all_settings_c","reviewed_Settings_c","all_settings_t","reviewed_Settings_t","s_page","indexOfSelectedItem","new_styles","syncLayerwithStyles_best","sharedLayerStyles","layer","sharedTextStyles","text","count_added","new_styles_ids","new_styles_withdark","createDarkModeStyle","settings","settings_c","settings_l","settings_t","count","SwitchDarkMode_best","UI","message","scrolHeight","alertscroll","NSScrollView","setFlipped","setHasVerticalScroller","setDocumentView","col_1","col","title_color_0","title_color_1","title_color_2","title_color_3","light_name","dark_name","colored_container","j","all_settings","k","dark_id","dark","light_id","light","sharedStyle_light","getSharedTextStyleWithID","sharedStyle_dark","element","getSharedLayerStyleWithID","String","undefined","buttonOrganize2","deleted","colors_in_layer_styles","colors_in_layer_styles_names","styles_layer","colors","groupdefaultColorsCode","groupdefaultColorsCode_dark","groupdefaultColorsCode_block","groupdefaultColorsCode_block_dark","groupdefaultColorsName","groupdefaultColorsCode_textstyles","groupdefaultColorsCode_block_textstyles","groupdefaultColorsName_textstyles","groupdefaultColorsCode_layerstyles","groupdefaultColorsCode_block_layerstyles","groupdefaultColorsName_layerstyles","style","fills","layer_style_color","color","repeated","code","styles_list","colors_in_text_styles","text_style_color","textColor","createField","title_color","divider_2","createDivider","alpha","slice","dark_hex_hex","DarkMode","dark_hex","RGBToHex","r","g","b","validated_array","validateColorInput","count_repeated","stringValue","groupdefaultColorsCode_merged","concat","groupdefaultColorsName_merged","getFontIndex","font_name","avail_fonts","index","font_info","font_selected","style_oposite","style_oposite_id","getSpecificFonts","specific_font","fontManager","NSFontManager","sharedFontManager","fonts","family","weights","sys_fonts_families","availableFontFamilies","w","availableMembersOfFontFamily","m","getFonts","sys_fonts","availableFonts","last_font","getFontsOld","getFontName","addTextStyle","styleName","theStyle","sketchVersion","MSApplicationMetadata","metadata","appVersion","textStyles","documentData","layerTextStyles","addSharedStyleWithName_firstInstance","textStyle","MSSharedStyle","initWithName_firstInstance","addSharedObject","initWithName_style","getTextStyleByName","updateTextStyle","create_info","defaultSettings","place","base","ratio","parseFloat","replace","font_family","titleOfSelectedItem","font_weight","font_weight_index","font_color","font_color_name","weights_array","list_weights","count_updated","count_Created","weight_info","getWeightfromPopupButton","initial_size","is_italic","getIs_italic","s_labels","size","Math","pow","label","options","h","s_hierarchy","titleStyle","style_to_update","getTextStyleByNameLabel","fontFamily","fontSize","fontStyle","fontWeight","weight","lineHeight","alignment","borders","new_style","layers","getAllInstancesLayers","syncWithSharedStyle","updateTextStyleLabel","print","createTextStyle","count_existent","selectedPage","placeTextStyles","x","y","layer_width","layer_height","Group","organized_styles","OrganizeArrayTextStyles","layers_artboard","getLayersNamed","artboard","parent","group","styles","rect","sharedStyleId","id","adjustToFit","padding","height","width","art_x","art_y","elementHasStyle","all_styles","exists","ifStyleNameAlreadyExists","getStyleByName","getStyleById","removeStyle","objects","objectAtIndex","removeSharedStyle","updateSettingsWithDocument","value","layerSettingForKey","err","command","valueForKey_onLayer","sketchObject","updateSettingsWithGlobal","defaults","objectForKey","createSelect","items","selectedItemIndex","comboBox","NSComboBox","addItemsWithObjectValues","selectItemAtIndex","setNumberOfVisibleItems","setCompletes","PopUpButton","NSPopUpButton","addItemsWithTitles","setTarget","self","createPopUpButtonWeights","items_names","getIndexforPopupButton","all_weights","toLowerCase","indexOf","str","font","variation","italic","getUserDefaults","domain","NSUserDefaults","initWithSuiteName","NSTextField","setStringValue","setFont","NSFont","boldSystemFontOfSize","setBezeled","setDrawsBackground","setEditable","setSelectable","createNotSelectableInput","systemFontOfSize","createCheckbox","item","flag","checkbox","NSButton","NSOffState","NSOnState","setButtonType","NSSwitchButton","setBezelStyle","setTitle","setTag","setState","darkmode","block","setWantsLayer","color_rgb","hexToRgba","cornerRadius","maskedCorners","setBackgroundColor","CGColorCreateGenericRGB","a","changeColoredBlock","hex","result","exec","substr","parseInt","gray_middle","abs","lightness","RGBToHSL","darkmode_rgb","HSLToRGB","rgb","ex","test","sep","split","R","round","toString","hsl","isPct","s","l","PI","c","mode","cmin","min","cmax","max","delta","toFixed","bi","s_color","transformed_color","lu","HSLToHex","divider","field","delegate","createFieldnoBack","createFieldControl","NSControl","setKeyOrder","order","thisItem","nextItem","setNextKeyView","window","setInitialFirstResponder","code_array","name_array","add","a_length","array","cur_style","cur_style_name","style_fontSize","style_name","style_name_array","s_name","has_group","has_group_id","updateElementStyle","sharedStyle","addNewStyle","style_type","added","this_name","styleType","getLayerArtboard","p","parent_top","artboar_id","reviewed_settings","layer_styles","text_styles","colored_containers","percentage","count_shapePath_added","container_min_width","container_min_height","count_c","count_l","count_t","count_container_added","shapeType","count_fills","enabled","container","hasStyle","isOutOfSync","isOutOfSyncWithSharedStyle","is_inside_colored_container","hasMatchingStyle","elementHasMatchingStyleAndSetting","hasmach_butnot","n","hasmach_butnot_setting","last","element_size","layer_artboard","frame_absolute","getFrameAbsoluteFrame","this_frame","hasSettings","ifStylesavedInSettings","TextinsideColoredContainer","count_shape_added","count_text_added","layerName","text_element","same_artboard","sum_x","sum_y","elementHasMatchingStyle","this_settings","originLibrary","getLibrary","otherSettings","otherSettings_2","is_in_my_setting","is_in_other_Setting","setting_style","style_id","style_dark","styles_text","percentage_layer","percentage_text","s_styles_c","s_styles_l","s_styles_t","new_styles_layer","new_styles_text","shared_style","s_style_name","includes","clean_name","last_style","transformMode","f","fillType","gradient","stops","newcolor","transformColor","shadows","innerShadows","dark_hex_alpha","getSettingStyle","opositde_mode","all_layer","all_artboards","this_mode","to_mode","count_switch","background","new_artboard_color"],"mappings":";;;;;;;;QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;AClFa;AACb;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;AC1DA,gBAAgB,mBAAO,CAAC,sDAAY;AACpC,eAAe,mBAAO,CAAC,8DAAgB;;AAEvC;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uBAAuB;AACvB,uBAAuB;AACvB;AACA;AACA;;AAEA;AACA;AACA,mCAAmC;AACnC,oCAAoC;AACpC;AACA;AACA;;;AAGA;AACA;AACA,wCAAwC,GAAG,IAAI;AAC/C;AACA;AACA;;AAEA;AACA,qBAAqB,KAAK;;AAE1B;AACA;;AAEA;AACA;AACA;AACA;;AAEA,qBAAqB,aAAa;AAClC;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,8BAA8B;AAC9B,uCAAuC,GAAG;AAC1C,YAAY,GAAG,yBAAyB;AACxC;AACA;AACA,8BAA8B;AAC9B,cAAc,GAAG;AACjB;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,WAAW,YAAY;AACvB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,qBAAqB,KAAK;AAC1B;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAQ,EAAE;AACV,2BAA2B;AAC3B,sBAAsB;AACtB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,YAAY,KAAK,QAAQ,EAAE,IAAI,EAAE;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,mBAAmB,YAAY;AAC/B;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,mCAAmC,2BAA2B;AAC9D;;AAEA,iBAAiB,cAAc;AAC/B,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;;ACvMA;AACA;AACA,mBAAmB,eAAe;AAClC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;ACZA;AACA;;AAEA,YAAY;AACZ;AACA,SAAS,mBAAO,CAAC,kBAAM;AACvB,CAAC;;AAED;AACA,aAAa,mBAAO,CAAC,gEAAiB;;AAEtC;AACA,QAAQ,uCAAuC;AAC/C,QAAQ,2BAA2B;AACnC,QAAQ,2BAA2B;AACnC,QAAQ,2BAA2B;AACnC,QAAQ;AACR;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,yCAAyC,IAAI;;AAE7C;AACA;AACA;;AAEA;AACA,gCAAgC;;AAEhC,aAAa;AACb;AACA;AACA;AACA;AACA,GAAG,IAAI;AACP;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,KAAK,IAAI;AACT,KAAK,GAAG;AACR,KAAK,KAAK;AACV,KAAK,IAAI,IAAI,EAAE;AACf,KAAK,IAAI,EAAE,IAAI;AACf;AACA;AACA,KAAK,IAAI,OAAO,IAAI;AACpB,KAAK,EAAE,OAAO,EAAE;AAChB;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,sBAAsB,IAAI;AAC1B;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,IAAI;AACxC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;;AAEA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,IAAI;AACvC;AACA;AACA;AACA,gCAAgC,EAAE,EAAE,KAAK;AACzC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,wCAAwC,QAAQ;AAChD;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe,sBAAsB;AACrC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,6CAA6C;AAC7C;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,wBAAwB,QAAQ;AAChC;AACA;AACA;;AAEA,aAAa,gBAAgB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK,6CAA6C;;AAElD;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP,OAAO;AACP;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,2BAA2B;AAC3B;;;;;;;;;;;;;AC15BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AACA,IAAMA,SAAS,GAAEC,mBAAO,CAAC,0CAAD,CAAxB;;AAEA,IAAIC,IAAJ,EAAUC,QAAV,C,CACA;;AAEA,IAAIC,SAAS,GAAGH,mBAAO,CAAC,8BAAD,CAAP,CAAsBG,SAAtC;;AACA,IAAIC,OAAO,GAAGJ,mBAAO,CAAC,8BAAD,CAAP,CAAsBK,IAApC;;AACA,IAAIC,QAAQ,GAAGN,mBAAO,CAAC,8BAAD,CAAP,CAAsBM,QAArC;;AACA,IAAIC,QAAQ,GAAGP,mBAAO,CAAC,wCAAD,CAAtB;;AACA,IAAIQ,KAAK,GAAGR,mBAAO,CAAC,8BAAD,CAAP,CAAsBQ,KAAlC;;AACA,IAAIC,WAAW,GAAGT,mBAAO,CAAC,8BAAD,CAAP,CAAsBS,WAAxC;;AAGO,SAASC,WAAT,CAAqBC,OA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","file":"__darkmode-system.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/darkmode-system.js\");\n","'use strict';\nmodule.exports = balanced;\nfunction balanced(a, b, str) {\n  if (a instanceof RegExp) a = maybeMatch(a, str);\n  if (b instanceof RegExp) b = maybeMatch(b, str);\n\n  var r = range(a, b, str);\n\n  return r && {\n    start: r[0],\n    end: r[1],\n    pre: str.slice(0, r[0]),\n    body: str.slice(r[0] + a.length, r[1]),\n    post: str.slice(r[1] + b.length)\n  };\n}\n\nfunction maybeMatch(reg, str) {\n  var m = str.match(reg);\n  return m ? m[0] : null;\n}\n\nbalanced.range = range;\nfunction range(a, b, str) {\n  var begs, beg, left, right, result;\n  var ai = str.indexOf(a);\n  var bi = str.indexOf(b, ai + 1);\n  var i = ai;\n\n  if (ai >= 0 && bi > 0) {\n    begs = [];\n    left = str.length;\n\n    while (i >= 0 && !result) {\n      if (i == ai) {\n        begs.push(i);\n        ai = str.indexOf(a, i + 1);\n      } else if (begs.length == 1) {\n        result = [ begs.pop(), bi ];\n      } else {\n        beg = begs.pop();\n        if (beg < left) {\n          left = beg;\n          right = bi;\n        }\n\n        bi = str.indexOf(b, i + 1);\n      }\n\n      i = ai < bi && ai >= 0 ? ai : bi;\n    }\n\n    if (begs.length) {\n      result = [ left, right ];\n    }\n  }\n\n  return result;\n}\n","var concatMap = require('concat-map');\nvar balanced = require('balanced-match');\n\nmodule.exports = expandTop;\n\nvar escSlash = '\\0SLASH'+Math.random()+'\\0';\nvar escOpen = '\\0OPEN'+Math.random()+'\\0';\nvar escClose = '\\0CLOSE'+Math.random()+'\\0';\nvar escComma = '\\0COMMA'+Math.random()+'\\0';\nvar escPeriod = '\\0PERIOD'+Math.random()+'\\0';\n\nfunction numeric(str) {\n  return parseInt(str, 10) == str\n    ? parseInt(str, 10)\n    : str.charCodeAt(0);\n}\n\nfunction escapeBraces(str) {\n  return str.split('\\\\\\\\').join(escSlash)\n            .split('\\\\{').join(escOpen)\n            .split('\\\\}').join(escClose)\n            .split('\\\\,').join(escComma)\n            .split('\\\\.').join(escPeriod);\n}\n\nfunction unescapeBraces(str) {\n  return str.split(escSlash).join('\\\\')\n            .split(escOpen).join('{')\n            .split(escClose).join('}')\n            .split(escComma).join(',')\n            .split(escPeriod).join('.');\n}\n\n\n// Basically just str.split(\",\"), but handling cases\n// where we have nested braced sections, which should be\n// treated as individual members, like {a,{b,c},d}\nfunction parseCommaParts(str) {\n  if (!str)\n    return [''];\n\n  var parts = [];\n  var m = balanced('{', '}', str);\n\n  if (!m)\n    return str.split(',');\n\n  var pre = m.pre;\n  var body = m.body;\n  var post = m.post;\n  var p = pre.split(',');\n\n  p[p.length-1] += '{' + body + '}';\n  var postParts = parseCommaParts(post);\n  if (post.length) {\n    p[p.length-1] += postParts.shift();\n    p.push.apply(p, postParts);\n  }\n\n  parts.push.apply(parts, p);\n\n  return parts;\n}\n\nfunction expandTop(str) {\n  if (!str)\n    return [];\n\n  // I don't know why Bash 4.3 does this, but it does.\n  // Anything starting with {} will have the first two bytes preserved\n  // but *only* at the top level, so {},a}b will not expand to anything,\n  // but a{},b}c will be expanded to [a}c,abc].\n  // One could argue that this is a bug in Bash, but since the goal of\n  // this module is to match Bash's rules, we escape a leading {}\n  if (str.substr(0, 2) === '{}') {\n    str = '\\\\{\\\\}' + str.substr(2);\n  }\n\n  return expand(escapeBraces(str), true).map(unescapeBraces);\n}\n\nfunction identity(e) {\n  return e;\n}\n\nfunction embrace(str) {\n  return '{' + str + '}';\n}\nfunction isPadded(el) {\n  return /^-?0\\d/.test(el);\n}\n\nfunction lte(i, y) {\n  return i <= y;\n}\nfunction gte(i, y) {\n  return i >= y;\n}\n\nfunction expand(str, isTop) {\n  var expansions = [];\n\n  var m = balanced('{', '}', str);\n  if (!m || /\\$$/.test(m.pre)) return [str];\n\n  var isNumericSequence = /^-?\\d+\\.\\.-?\\d+(?:\\.\\.-?\\d+)?$/.test(m.body);\n  var isAlphaSequence = /^[a-zA-Z]\\.\\.[a-zA-Z](?:\\.\\.-?\\d+)?$/.test(m.body);\n  var isSequence = isNumericSequence || isAlphaSequence;\n  var isOptions = m.body.indexOf(',') >= 0;\n  if (!isSequence && !isOptions) {\n    // {a},b}\n    if (m.post.match(/,.*\\}/)) {\n      str = m.pre + '{' + m.body + escClose + m.post;\n      return expand(str);\n    }\n    return [str];\n  }\n\n  var n;\n  if (isSequence) {\n    n = m.body.split(/\\.\\./);\n  } else {\n    n = parseCommaParts(m.body);\n    if (n.length === 1) {\n      // x{{a,b}}y ==> x{a}y x{b}y\n      n = expand(n[0], false).map(embrace);\n      if (n.length === 1) {\n        var post = m.post.length\n          ? expand(m.post, false)\n          : [''];\n        return post.map(function(p) {\n          return m.pre + n[0] + p;\n        });\n      }\n    }\n  }\n\n  // at this point, n is the parts, and we know it's not a comma set\n  // with a single entry.\n\n  // no need to expand pre, since it is guaranteed to be free of brace-sets\n  var pre = m.pre;\n  var post = m.post.length\n    ? expand(m.post, false)\n    : [''];\n\n  var N;\n\n  if (isSequence) {\n    var x = numeric(n[0]);\n    var y = numeric(n[1]);\n    var width = Math.max(n[0].length, n[1].length)\n    var incr = n.length == 3\n      ? Math.abs(numeric(n[2]))\n      : 1;\n    var test = lte;\n    var reverse = y < x;\n    if (reverse) {\n      incr *= -1;\n      test = gte;\n    }\n    var pad = n.some(isPadded);\n\n    N = [];\n\n    for (var i = x; test(i, y); i += incr) {\n      var c;\n      if (isAlphaSequence) {\n        c = String.fromCharCode(i);\n        if (c === '\\\\')\n          c = '';\n      } else {\n        c = String(i);\n        if (pad) {\n          var need = width - c.length;\n          if (need > 0) {\n            var z = new Array(need + 1).join('0');\n            if (i < 0)\n              c = '-' + z + c.slice(1);\n            else\n              c = z + c;\n          }\n        }\n      }\n      N.push(c);\n    }\n  } else {\n    N = concatMap(n, function(el) { return expand(el, false) });\n  }\n\n  for (var j = 0; j < N.length; j++) {\n    for (var k = 0; k < post.length; k++) {\n      var expansion = pre + N[j] + post[k];\n      if (!isTop || isSequence || expansion)\n        expansions.push(expansion);\n    }\n  }\n\n  return expansions;\n}\n\n","module.exports = function (xs, fn) {\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        var x = fn(xs[i], i);\n        if (isArray(x)) res.push.apply(res, x);\n        else res.push(x);\n    }\n    return res;\n};\n\nvar isArray = Array.isArray || function (xs) {\n    return Object.prototype.toString.call(xs) === '[object Array]';\n};\n","module.exports = minimatch\nminimatch.Minimatch = Minimatch\n\nvar path = { sep: '/' }\ntry {\n  path = require('path')\n} catch (er) {}\n\nvar GLOBSTAR = minimatch.GLOBSTAR = Minimatch.GLOBSTAR = {}\nvar expand = require('brace-expansion')\n\nvar plTypes = {\n  '!': { open: '(?:(?!(?:', close: '))[^/]*?)'},\n  '?': { open: '(?:', close: ')?' },\n  '+': { open: '(?:', close: ')+' },\n  '*': { open: '(?:', close: ')*' },\n  '@': { open: '(?:', close: ')' }\n}\n\n// any single thing other than /\n// don't need to escape / when using new RegExp()\nvar qmark = '[^/]'\n\n// * => any number of characters\nvar star = qmark + '*?'\n\n// ** when dots are allowed.  Anything goes, except .. and .\n// not (^ or / followed by one or two dots followed by $ or /),\n// followed by anything, any number of times.\nvar twoStarDot = '(?:(?!(?:\\\\\\/|^)(?:\\\\.{1,2})($|\\\\\\/)).)*?'\n\n// not a ^ or / followed by a dot,\n// followed by anything, any number of times.\nvar twoStarNoDot = '(?:(?!(?:\\\\\\/|^)\\\\.).)*?'\n\n// characters that need to be escaped in RegExp.\nvar reSpecials = charSet('().*{}+?[]^$\\\\!')\n\n// \"abc\" -> { a:true, b:true, c:true }\nfunction charSet (s) {\n  return s.split('').reduce(function (set, c) {\n    set[c] = true\n    return set\n  }, {})\n}\n\n// normalizes slashes.\nvar slashSplit = /\\/+/\n\nminimatch.filter = filter\nfunction filter (pattern, options) {\n  options = options || {}\n  return function (p, i, list) {\n    return minimatch(p, pattern, options)\n  }\n}\n\nfunction ext (a, b) {\n  a = a || {}\n  b = b || {}\n  var t = {}\n  Object.keys(b).forEach(function (k) {\n    t[k] = b[k]\n  })\n  Object.keys(a).forEach(function (k) {\n    t[k] = a[k]\n  })\n  return t\n}\n\nminimatch.defaults = function (def) {\n  if (!def || !Object.keys(def).length) return minimatch\n\n  var orig = minimatch\n\n  var m = function minimatch (p, pattern, options) {\n    return orig.minimatch(p, pattern, ext(def, options))\n  }\n\n  m.Minimatch = function Minimatch (pattern, options) {\n    return new orig.Minimatch(pattern, ext(def, options))\n  }\n\n  return m\n}\n\nMinimatch.defaults = function (def) {\n  if (!def || !Object.keys(def).length) return Minimatch\n  return minimatch.defaults(def).Minimatch\n}\n\nfunction minimatch (p, pattern, options) {\n  if (typeof pattern !== 'string') {\n    throw new TypeError('glob pattern string required')\n  }\n\n  if (!options) options = {}\n\n  // shortcut: comments match nothing.\n  if (!options.nocomment && pattern.charAt(0) === '#') {\n    return false\n  }\n\n  // \"\" only matches \"\"\n  if (pattern.trim() === '') return p === ''\n\n  return new Minimatch(pattern, options).match(p)\n}\n\nfunction Minimatch (pattern, options) {\n  if (!(this instanceof Minimatch)) {\n    return new Minimatch(pattern, options)\n  }\n\n  if (typeof pattern !== 'string') {\n    throw new TypeError('glob pattern string required')\n  }\n\n  if (!options) options = {}\n  pattern = pattern.trim()\n\n  // windows support: need to use /, not \\\n  if (path.sep !== '/') {\n    pattern = pattern.split(path.sep).join('/')\n  }\n\n  this.options = options\n  this.set = []\n  this.pattern = pattern\n  this.regexp = null\n  this.negate = false\n  this.comment = false\n  this.empty = false\n\n  // make the set of regexps etc.\n  this.make()\n}\n\nMinimatch.prototype.debug = function () {}\n\nMinimatch.prototype.make = make\nfunction make () {\n  // don't do it more than once.\n  if (this._made) return\n\n  var pattern = this.pattern\n  var options = this.options\n\n  // empty patterns and comments match nothing.\n  if (!options.nocomment && pattern.charAt(0) === '#') {\n    this.comment = true\n    return\n  }\n  if (!pattern) {\n    this.empty = true\n    return\n  }\n\n  // step 1: figure out negation, etc.\n  this.parseNegate()\n\n  // step 2: expand braces\n  var set = this.globSet = this.braceExpand()\n\n  if (options.debug) this.debug = console.error\n\n  this.debug(this.pattern, set)\n\n  // step 3: now we have a set, so turn each one into a series of path-portion\n  // matching patterns.\n  // These will be regexps, except in the case of \"**\", which is\n  // set to the GLOBSTAR object for globstar behavior,\n  // and will not contain any / characters\n  set = this.globParts = set.map(function (s) {\n    return s.split(slashSplit)\n  })\n\n  this.debug(this.pattern, set)\n\n  // glob --> regexps\n  set = set.map(function (s, si, set) {\n    return s.map(this.parse, this)\n  }, this)\n\n  this.debug(this.pattern, set)\n\n  // filter out everything that didn't compile properly.\n  set = set.filter(function (s) {\n    return s.indexOf(false) === -1\n  })\n\n  this.debug(this.pattern, set)\n\n  this.set = set\n}\n\nMinimatch.prototype.parseNegate = parseNegate\nfunction parseNegate () {\n  var pattern = this.pattern\n  var negate = false\n  var options = this.options\n  var negateOffset = 0\n\n  if (options.nonegate) return\n\n  for (var i = 0, l = pattern.length\n    ; i < l && pattern.charAt(i) === '!'\n    ; i++) {\n    negate = !negate\n    negateOffset++\n  }\n\n  if (negateOffset) this.pattern = pattern.substr(negateOffset)\n  this.negate = negate\n}\n\n// Brace expansion:\n// a{b,c}d -> abd acd\n// a{b,}c -> abc ac\n// a{0..3}d -> a0d a1d a2d a3d\n// a{b,c{d,e}f}g -> abg acdfg acefg\n// a{b,c}d{e,f}g -> abdeg acdeg abdeg abdfg\n//\n// Invalid sets are not expanded.\n// a{2..}b -> a{2..}b\n// a{b}c -> a{b}c\nminimatch.braceExpand = function (pattern, options) {\n  return braceExpand(pattern, options)\n}\n\nMinimatch.prototype.braceExpand = braceExpand\n\nfunction braceExpand (pattern, options) {\n  if (!options) {\n    if (this instanceof Minimatch) {\n      options = this.options\n    } else {\n      options = {}\n    }\n  }\n\n  pattern = typeof pattern === 'undefined'\n    ? this.pattern : pattern\n\n  if (typeof pattern === 'undefined') {\n    throw new TypeError('undefined pattern')\n  }\n\n  if (options.nobrace ||\n    !pattern.match(/\\{.*\\}/)) {\n    // shortcut. no need to expand.\n    return [pattern]\n  }\n\n  return expand(pattern)\n}\n\n// parse a component of the expanded set.\n// At this point, no pattern may contain \"/\" in it\n// so we're going to return a 2d array, where each entry is the full\n// pattern, split on '/', and then turned into a regular expression.\n// A regexp is made at the end which joins each array with an\n// escaped /, and another full one which joins each regexp with |.\n//\n// Following the lead of Bash 4.1, note that \"**\" only has special meaning\n// when it is the *only* thing in a path portion.  Otherwise, any series\n// of * is equivalent to a single *.  Globstar behavior is enabled by\n// default, and can be disabled by setting options.noglobstar.\nMinimatch.prototype.parse = parse\nvar SUBPARSE = {}\nfunction parse (pattern, isSub) {\n  if (pattern.length > 1024 * 64) {\n    throw new TypeError('pattern is too long')\n  }\n\n  var options = this.options\n\n  // shortcuts\n  if (!options.noglobstar && pattern === '**') return GLOBSTAR\n  if (pattern === '') return ''\n\n  var re = ''\n  var hasMagic = !!options.nocase\n  var escaping = false\n  // ? => one single character\n  var patternListStack = []\n  var negativeLists = []\n  var stateChar\n  var inClass = false\n  var reClassStart = -1\n  var classStart = -1\n  // . and .. never match anything that doesn't start with .,\n  // even when options.dot is set.\n  var patternStart = pattern.charAt(0) === '.' ? '' // anything\n  // not (start or / followed by . or .. followed by / or end)\n  : options.dot ? '(?!(?:^|\\\\\\/)\\\\.{1,2}(?:$|\\\\\\/))'\n  : '(?!\\\\.)'\n  var self = this\n\n  function clearStateChar () {\n    if (stateChar) {\n      // we had some state-tracking character\n      // that wasn't consumed by this pass.\n      switch (stateChar) {\n        case '*':\n          re += star\n          hasMagic = true\n        break\n        case '?':\n          re += qmark\n          hasMagic = true\n        break\n        default:\n          re += '\\\\' + stateChar\n        break\n      }\n      self.debug('clearStateChar %j %j', stateChar, re)\n      stateChar = false\n    }\n  }\n\n  for (var i = 0, len = pattern.length, c\n    ; (i < len) && (c = pattern.charAt(i))\n    ; i++) {\n    this.debug('%s\\t%s %s %j', pattern, i, re, c)\n\n    // skip over any that are escaped.\n    if (escaping && reSpecials[c]) {\n      re += '\\\\' + c\n      escaping = false\n      continue\n    }\n\n    switch (c) {\n      case '/':\n        // completely not allowed, even escaped.\n        // Should already be path-split by now.\n        return false\n\n      case '\\\\':\n        clearStateChar()\n        escaping = true\n      continue\n\n      // the various stateChar values\n      // for the \"extglob\" stuff.\n      case '?':\n      case '*':\n      case '+':\n      case '@':\n      case '!':\n        this.debug('%s\\t%s %s %j <-- stateChar', pattern, i, re, c)\n\n        // all of those are literals inside a class, except that\n        // the glob [!a] means [^a] in regexp\n        if (inClass) {\n          this.debug('  in class')\n          if (c === '!' && i === classStart + 1) c = '^'\n          re += c\n          continue\n        }\n\n        // if we already have a stateChar, then it means\n        // that there was something like ** or +? in there.\n        // Handle the stateChar, then proceed with this one.\n        self.debug('call clearStateChar %j', stateChar)\n        clearStateChar()\n        stateChar = c\n        // if extglob is disabled, then +(asdf|foo) isn't a thing.\n        // just clear the statechar *now*, rather than even diving into\n        // the patternList stuff.\n        if (options.noext) clearStateChar()\n      continue\n\n      case '(':\n        if (inClass) {\n          re += '('\n          continue\n        }\n\n        if (!stateChar) {\n          re += '\\\\('\n          continue\n        }\n\n        patternListStack.push({\n          type: stateChar,\n          start: i - 1,\n          reStart: re.length,\n          open: plTypes[stateChar].open,\n          close: plTypes[stateChar].close\n        })\n        // negation is (?:(?!js)[^/]*)\n        re += stateChar === '!' ? '(?:(?!(?:' : '(?:'\n        this.debug('plType %j %j', stateChar, re)\n        stateChar = false\n      continue\n\n      case ')':\n        if (inClass || !patternListStack.length) {\n          re += '\\\\)'\n          continue\n        }\n\n        clearStateChar()\n        hasMagic = true\n        var pl = patternListStack.pop()\n        // negation is (?:(?!js)[^/]*)\n        // The others are (?:<pattern>)<type>\n        re += pl.close\n        if (pl.type === '!') {\n          negativeLists.push(pl)\n        }\n        pl.reEnd = re.length\n      continue\n\n      case '|':\n        if (inClass || !patternListStack.length || escaping) {\n          re += '\\\\|'\n          escaping = false\n          continue\n        }\n\n        clearStateChar()\n        re += '|'\n      continue\n\n      // these are mostly the same in regexp and glob\n      case '[':\n        // swallow any state-tracking char before the [\n        clearStateChar()\n\n        if (inClass) {\n          re += '\\\\' + c\n          continue\n        }\n\n        inClass = true\n        classStart = i\n        reClassStart = re.length\n        re += c\n      continue\n\n      case ']':\n        //  a right bracket shall lose its special\n        //  meaning and represent itself in\n        //  a bracket expression if it occurs\n        //  first in the list.  -- POSIX.2 2.8.3.2\n        if (i === classStart + 1 || !inClass) {\n          re += '\\\\' + c\n          escaping = false\n          continue\n        }\n\n        // handle the case where we left a class open.\n        // \"[z-a]\" is valid, equivalent to \"\\[z-a\\]\"\n        if (inClass) {\n          // split where the last [ was, make sure we don't have\n          // an invalid re. if so, re-walk the contents of the\n          // would-be class to re-translate any characters that\n          // were passed through as-is\n          // TODO: It would probably be faster to determine this\n          // without a try/catch and a new RegExp, but it's tricky\n          // to do safely.  For now, this is safe and works.\n          var cs = pattern.substring(classStart + 1, i)\n          try {\n            RegExp('[' + cs + ']')\n          } catch (er) {\n            // not a valid class!\n            var sp = this.parse(cs, SUBPARSE)\n            re = re.substr(0, reClassStart) + '\\\\[' + sp[0] + '\\\\]'\n            hasMagic = hasMagic || sp[1]\n            inClass = false\n            continue\n          }\n        }\n\n        // finish up the class.\n        hasMagic = true\n        inClass = false\n        re += c\n      continue\n\n      default:\n        // swallow any state char that wasn't consumed\n        clearStateChar()\n\n        if (escaping) {\n          // no need\n          escaping = false\n        } else if (reSpecials[c]\n          && !(c === '^' && inClass)) {\n          re += '\\\\'\n        }\n\n        re += c\n\n    } // switch\n  } // for\n\n  // handle the case where we left a class open.\n  // \"[abc\" is valid, equivalent to \"\\[abc\"\n  if (inClass) {\n    // split where the last [ was, and escape it\n    // this is a huge pita.  We now have to re-walk\n    // the contents of the would-be class to re-translate\n    // any characters that were passed through as-is\n    cs = pattern.substr(classStart + 1)\n    sp = this.parse(cs, SUBPARSE)\n    re = re.substr(0, reClassStart) + '\\\\[' + sp[0]\n    hasMagic = hasMagic || sp[1]\n  }\n\n  // handle the case where we had a +( thing at the *end*\n  // of the pattern.\n  // each pattern list stack adds 3 chars, and we need to go through\n  // and escape any | chars that were passed through as-is for the regexp.\n  // Go through and escape them, taking care not to double-escape any\n  // | chars that were already escaped.\n  for (pl = patternListStack.pop(); pl; pl = patternListStack.pop()) {\n    var tail = re.slice(pl.reStart + pl.open.length)\n    this.debug('setting tail', re, pl)\n    // maybe some even number of \\, then maybe 1 \\, followed by a |\n    tail = tail.replace(/((?:\\\\{2}){0,64})(\\\\?)\\|/g, function (_, $1, $2) {\n      if (!$2) {\n        // the | isn't already escaped, so escape it.\n        $2 = '\\\\'\n      }\n\n      // need to escape all those slashes *again*, without escaping the\n      // one that we need for escaping the | character.  As it works out,\n      // escaping an even number of slashes can be done by simply repeating\n      // it exactly after itself.  That's why this trick works.\n      //\n      // I am sorry that you have to see this.\n      return $1 + $1 + $2 + '|'\n    })\n\n    this.debug('tail=%j\\n   %s', tail, tail, pl, re)\n    var t = pl.type === '*' ? star\n      : pl.type === '?' ? qmark\n      : '\\\\' + pl.type\n\n    hasMagic = true\n    re = re.slice(0, pl.reStart) + t + '\\\\(' + tail\n  }\n\n  // handle trailing things that only matter at the very end.\n  clearStateChar()\n  if (escaping) {\n    // trailing \\\\\n    re += '\\\\\\\\'\n  }\n\n  // only need to apply the nodot start if the re starts with\n  // something that could conceivably capture a dot\n  var addPatternStart = false\n  switch (re.charAt(0)) {\n    case '.':\n    case '[':\n    case '(': addPatternStart = true\n  }\n\n  // Hack to work around lack of negative lookbehind in JS\n  // A pattern like: *.!(x).!(y|z) needs to ensure that a name\n  // like 'a.xyz.yz' doesn't match.  So, the first negative\n  // lookahead, has to look ALL the way ahead, to the end of\n  // the pattern.\n  for (var n = negativeLists.length - 1; n > -1; n--) {\n    var nl = negativeLists[n]\n\n    var nlBefore = re.slice(0, nl.reStart)\n    var nlFirst = re.slice(nl.reStart, nl.reEnd - 8)\n    var nlLast = re.slice(nl.reEnd - 8, nl.reEnd)\n    var nlAfter = re.slice(nl.reEnd)\n\n    nlLast += nlAfter\n\n    // Handle nested stuff like *(*.js|!(*.json)), where open parens\n    // mean that we should *not* include the ) in the bit that is considered\n    // \"after\" the negated section.\n    var openParensBefore = nlBefore.split('(').length - 1\n    var cleanAfter = nlAfter\n    for (i = 0; i < openParensBefore; i++) {\n      cleanAfter = cleanAfter.replace(/\\)[+*?]?/, '')\n    }\n    nlAfter = cleanAfter\n\n    var dollar = ''\n    if (nlAfter === '' && isSub !== SUBPARSE) {\n      dollar = '$'\n    }\n    var newRe = nlBefore + nlFirst + nlAfter + dollar + nlLast\n    re = newRe\n  }\n\n  // if the re is not \"\" at this point, then we need to make sure\n  // it doesn't match against an empty path part.\n  // Otherwise a/* will match a/, which it should not.\n  if (re !== '' && hasMagic) {\n    re = '(?=.)' + re\n  }\n\n  if (addPatternStart) {\n    re = patternStart + re\n  }\n\n  // parsing just a piece of a larger pattern.\n  if (isSub === SUBPARSE) {\n    return [re, hasMagic]\n  }\n\n  // skip the regexp for non-magical patterns\n  // unescape anything in it, though, so that it'll be\n  // an exact match against a file etc.\n  if (!hasMagic) {\n    return globUnescape(pattern)\n  }\n\n  var flags = options.nocase ? 'i' : ''\n  try {\n    var regExp = new RegExp('^' + re + '$', flags)\n  } catch (er) {\n    // If it was an invalid regular expression, then it can't match\n    // anything.  This trick looks for a character after the end of\n    // the string, which is of course impossible, except in multi-line\n    // mode, but it's not a /m regex.\n    return new RegExp('$.')\n  }\n\n  regExp._glob = pattern\n  regExp._src = re\n\n  return regExp\n}\n\nminimatch.makeRe = function (pattern, options) {\n  return new Minimatch(pattern, options || {}).makeRe()\n}\n\nMinimatch.prototype.makeRe = makeRe\nfunction makeRe () {\n  if (this.regexp || this.regexp === false) return this.regexp\n\n  // at this point, this.set is a 2d array of partial\n  // pattern strings, or \"**\".\n  //\n  // It's better to use .match().  This function shouldn't\n  // be used, really, but it's pretty convenient sometimes,\n  // when you just want to work with a regex.\n  var set = this.set\n\n  if (!set.length) {\n    this.regexp = false\n    return this.regexp\n  }\n  var options = this.options\n\n  var twoStar = options.noglobstar ? star\n    : options.dot ? twoStarDot\n    : twoStarNoDot\n  var flags = options.nocase ? 'i' : ''\n\n  var re = set.map(function (pattern) {\n    return pattern.map(function (p) {\n      return (p === GLOBSTAR) ? twoStar\n      : (typeof p === 'string') ? regExpEscape(p)\n      : p._src\n    }).join('\\\\\\/')\n  }).join('|')\n\n  // must match entire pattern\n  // ending in a * or ** will make it less strict.\n  re = '^(?:' + re + ')$'\n\n  // can match anything, as long as it's not this.\n  if (this.negate) re = '^(?!' + re + ').*$'\n\n  try {\n    this.regexp = new RegExp(re, flags)\n  } catch (ex) {\n    this.regexp = false\n  }\n  return this.regexp\n}\n\nminimatch.match = function (list, pattern, options) {\n  options = options || {}\n  var mm = new Minimatch(pattern, options)\n  list = list.filter(function (f) {\n    return mm.match(f)\n  })\n  if (mm.options.nonull && !list.length) {\n    list.push(pattern)\n  }\n  return list\n}\n\nMinimatch.prototype.match = match\nfunction match (f, partial) {\n  this.debug('match', f, this.pattern)\n  // short-circuit in the case of busted things.\n  // comments, etc.\n  if (this.comment) return false\n  if (this.empty) return f === ''\n\n  if (f === '/' && partial) return true\n\n  var options = this.options\n\n  // windows: need to use /, not \\\n  if (path.sep !== '/') {\n    f = f.split(path.sep).join('/')\n  }\n\n  // treat the test path as a set of pathparts.\n  f = f.split(slashSplit)\n  this.debug(this.pattern, 'split', f)\n\n  // just ONE of the pattern sets in this.set needs to match\n  // in order for it to be valid.  If negating, then just one\n  // match means that we have failed.\n  // Either way, return on the first hit.\n\n  var set = this.set\n  this.debug(this.pattern, 'set', set)\n\n  // Find the basename of the path by looking for the last non-empty segment\n  var filename\n  var i\n  for (i = f.length - 1; i >= 0; i--) {\n    filename = f[i]\n    if (filename) break\n  }\n\n  for (i = 0; i < set.length; i++) {\n    var pattern = set[i]\n    var file = f\n    if (options.matchBase && pattern.length === 1) {\n      file = [filename]\n    }\n    var hit = this.matchOne(file, pattern, partial)\n    if (hit) {\n      if (options.flipNegate) return true\n      return !this.negate\n    }\n  }\n\n  // didn't get any hits.  this is success if it's a negative\n  // pattern, failure otherwise.\n  if (options.flipNegate) return false\n  return this.negate\n}\n\n// set partial to true to test if, for example,\n// \"/a/b\" matches the start of \"/*/b/*/d\"\n// Partial means, if you run out of file before you run\n// out of pattern, then that's fine, as long as all\n// the parts match.\nMinimatch.prototype.matchOne = function (file, pattern, partial) {\n  var options = this.options\n\n  this.debug('matchOne',\n    { 'this': this, file: file, pattern: pattern })\n\n  this.debug('matchOne', file.length, pattern.length)\n\n  for (var fi = 0,\n      pi = 0,\n      fl = file.length,\n      pl = pattern.length\n      ; (fi < fl) && (pi < pl)\n      ; fi++, pi++) {\n    this.debug('matchOne loop')\n    var p = pattern[pi]\n    var f = file[fi]\n\n    this.debug(pattern, p, f)\n\n    // should be impossible.\n    // some invalid regexp stuff in the set.\n    if (p === false) return false\n\n    if (p === GLOBSTAR) {\n      this.debug('GLOBSTAR', [pattern, p, f])\n\n      // \"**\"\n      // a/**/b/**/c would match the following:\n      // a/b/x/y/z/c\n      // a/x/y/z/b/c\n      // a/b/x/b/x/c\n      // a/b/c\n      // To do this, take the rest of the pattern after\n      // the **, and see if it would match the file remainder.\n      // If so, return success.\n      // If not, the ** \"swallows\" a segment, and try again.\n      // This is recursively awful.\n      //\n      // a/**/b/**/c matching a/b/x/y/z/c\n      // - a matches a\n      // - doublestar\n      //   - matchOne(b/x/y/z/c, b/**/c)\n      //     - b matches b\n      //     - doublestar\n      //       - matchOne(x/y/z/c, c) -> no\n      //       - matchOne(y/z/c, c) -> no\n      //       - matchOne(z/c, c) -> no\n      //       - matchOne(c, c) yes, hit\n      var fr = fi\n      var pr = pi + 1\n      if (pr === pl) {\n        this.debug('** at the end')\n        // a ** at the end will just swallow the rest.\n        // We have found a match.\n        // however, it will not swallow /.x, unless\n        // options.dot is set.\n        // . and .. are *never* matched by **, for explosively\n        // exponential reasons.\n        for (; fi < fl; fi++) {\n          if (file[fi] === '.' || file[fi] === '..' ||\n            (!options.dot && file[fi].charAt(0) === '.')) return false\n        }\n        return true\n      }\n\n      // ok, let's see if we can swallow whatever we can.\n      while (fr < fl) {\n        var swallowee = file[fr]\n\n        this.debug('\\nglobstar while', file, fr, pattern, pr, swallowee)\n\n        // XXX remove this slice.  Just pass the start index.\n        if (this.matchOne(file.slice(fr), pattern.slice(pr), partial)) {\n          this.debug('globstar found match!', fr, fl, swallowee)\n          // found a match.\n          return true\n        } else {\n          // can't swallow \".\" or \"..\" ever.\n          // can only swallow \".foo\" when explicitly asked.\n          if (swallowee === '.' || swallowee === '..' ||\n            (!options.dot && swallowee.charAt(0) === '.')) {\n            this.debug('dot detected!', file, fr, pattern, pr)\n            break\n          }\n\n          // ** swallows a segment, and continue.\n          this.debug('globstar swallow a segment, and continue')\n          fr++\n        }\n      }\n\n      // no match was found.\n      // However, in partial mode, we can't say this is necessarily over.\n      // If there's more *pattern* left, then\n      if (partial) {\n        // ran out of file\n        this.debug('\\n>>> no match, partial?', file, fr, pattern, pr)\n        if (fr === fl) return true\n      }\n      return false\n    }\n\n    // something other than **\n    // non-magic patterns just have to match exactly\n    // patterns with magic have been turned into regexps.\n    var hit\n    if (typeof p === 'string') {\n      if (options.nocase) {\n        hit = f.toLowerCase() === p.toLowerCase()\n      } else {\n        hit = f === p\n      }\n      this.debug('string match', p, f, hit)\n    } else {\n      hit = f.match(p)\n      this.debug('pattern match', p, f, hit)\n    }\n\n    if (!hit) return false\n  }\n\n  // Note: ending in / means that we'll get a final \"\"\n  // at the end of the pattern.  This can only match a\n  // corresponding \"\" at the end of the file.\n  // If the file ends in /, then it can only match a\n  // a pattern that ends in /, unless the pattern just\n  // doesn't have any more for it. But, a/b/ should *not*\n  // match \"a/b/*\", even though \"\" matches against the\n  // [^/]*? pattern, except in partial mode, where it might\n  // simply not be reached yet.\n  // However, a/b/ should still satisfy a/*\n\n  // now either we fell off the end of the pattern, or we're done.\n  if (fi === fl && pi === pl) {\n    // ran out of pattern and filename at the same time.\n    // an exact hit!\n    return true\n  } else if (fi === fl) {\n    // ran out of file, but still had pattern left.\n    // this is ok if we're doing the match as part of\n    // a glob fs traversal.\n    return partial\n  } else if (pi === pl) {\n    // ran out of pattern, still have file left.\n    // this is only acceptable if we're on the very last\n    // empty segment of a file with a trailing slash.\n    // a/* should match a/b/\n    var emptyFileEnd = (fi === fl - 1) && (file[fi] === '')\n    return emptyFileEnd\n  }\n\n  // should be unreachable.\n  throw new Error('wtf?')\n}\n\n// replace stuff like \\* with *\nfunction globUnescape (s) {\n  return s.replace(/\\\\(.)/g, '$1')\n}\n\nfunction regExpEscape (s) {\n  return s.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&')\n}\n","import sketch from 'sketch';\nconst functions= require('./functions.js');\n\nvar page, pageInfo;\n// Config\n\nlet Rectangle = require('sketch/dom').Rectangle;\nlet TextDom = require('sketch/dom').Text;\nlet Artboard = require('sketch/dom').Artboard\nlet Settings = require('sketch/settings');\nlet Style = require('sketch/dom').Style;\nlet SharedStyle = require('sketch/dom').SharedStyle;\n\n\nexport function getSettings(context) {\n  DarkModeSystem(context,\"settings\");\n  \n}\nexport function deleteAll(context) {\n  DarkModeSystem(context,\"delete\");\n  \n}\nexport function documentColors(context) {\n  DarkModeSystem(context,\"colors\");\n  \n}\nexport function DeleteAllSettings(context) {\n  DarkModeSystem(context,\"deletesettings\");\n}\n\nexport function switchDark(context) {\n  DarkModeSystem(context,\"switchDark\");\n}\nexport function switchLight(context) {\n  DarkModeSystem(context,\"switchLight\");\n}\n\n\nexport function createDarkmode(context) {\n  DarkModeSystem(context,\"darkmode\");\n  \n}\n\n\nfunction DarkModeSystem(context,type) {\n  /*\n  if(document.colorSpace !== ColorSpace.P3){\n    document.changeColorSpace(ColorSpace.P3, true);\n  }\n  */\n  var labels_alignments =[ \"Left\", \"Right\", \"Center\"];\n\n  var pluginName = \"DarkMode System\",\n\tpluginDomain = \"DarkModeSystem\";\n\n  var document = sketch.getSelectedDocument();\n  \n  \n  var fieldHeight = 22,\n  fieldWidth = 60,\n  labelHeight = 16,\n  leftColWidth = 120,\n  settingPad = 10,\n  settingX = 0,\n  settingY = 30,\n  switchHeight = 16,\n  textOffset = 2,\n  windowHeight =(labelHeight*7)+(settingPad*7)+50,\n  windowWidth = 600;\n  \n  \n  // Setting variables\n  var get_settign_S=Settings.documentSettingForKey(document, 'Styles');\n  if(get_settign_S == null){\n    Settings.setDocumentSettingForKey(document, 'Styles', []);\n\n  }\n\n\n  // Setting variables\n  var get_settign_C=Settings.documentSettingForKey(document, 'Styles_Containers');\n  if(get_settign_C == null){\n    Settings.setDocumentSettingForKey(document, 'Styles_Containers', []);\n\n  }\n\n  // Setting variables\n  var get_settign_L=Settings.documentSettingForKey(document, 'Styles_Layers');\n  if(get_settign_L == null){\n    Settings.setDocumentSettingForKey(document, 'Styles_Layers', []);\n\n  }\n\n  // Setting variables\n  var get_settign_T=Settings.documentSettingForKey(document, 'Styles_Texts');\n  if(get_settign_T == null){\n    Settings.setDocumentSettingForKey(document, 'Styles_Texts', []);\n\n  }\n\n\n  // ------- ------- ------- -------\n  // darkmode AREA\n\t// ------- ------- ------- -------  \n\tif (type && type == \"darkmode\") {\n    console.log(\"entered darkmode\");\n    var document = sketch.getSelectedDocument();\n    var s_styles= Settings.documentSettingForKey(document, 'Styles');\n    //Settings.setDocumentSettingForKey(document, 'Font', groupdefaultFont.indexOfSelectedItem());\n    \n    \n    //create Modal\n    var s_colors= Settings.documentSettingForKey(document, 'colors');\n\n\t\tvar alert = NSAlert.alloc().init(),\n\t\talertIconPath = context.plugin.urlForResourceNamed(\"icon.png\").path(),\n\t\talertIcon = NSImage.alloc().initByReferencingFile(alertIconPath),\n\t\talertContent = NSView.alloc().init();\n    alertContent = NSView.alloc().initWithFrame(NSMakeRect(0, 0, windowWidth, windowHeight));\n\n\n    //explaining process\n    //FONT FAMILY\n    var col_width= windowWidth/4 - 10;\n      var groupdefaultFont_label = functions.createLabel(\"Clean Unvalid Settings\",12,NSMakeRect(0,settingY + textOffset,col_width,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n    var groupdefaultFont_label = functions.createLabel(\"Sync Layers with SharedStyles\",12,NSMakeRect(col_width+10,settingY + textOffset,col_width,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n    var groupdefaultFont_label = functions.createLabel(\"Create DarkMode Version\",12,NSMakeRect((col_width+10)*2,settingY + textOffset,col_width,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n    var groupdefaultFont_label = functions.createLabel(\"Switch to DarkMode \",12,NSMakeRect((col_width+10)*3,settingY + textOffset,col_width,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + 5;\n    var groupdefaultFont_label = functions.createBoldLabel(\"Step 1\",12,NSMakeRect(0,settingY + textOffset,col_width,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n    var groupdefaultFont_label = functions.createBoldLabel(\"Step 2\",12,NSMakeRect((col_width+10),settingY + textOffset,col_width,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n    var groupdefaultFont_label = functions.createBoldLabel(\"Step 3\",12,NSMakeRect((col_width+10)*2,settingY + textOffset,col_width,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n    var groupdefaultFont_label = functions.createBoldLabel(\"Step 4\",12,NSMakeRect((col_width+10)*3,settingY + textOffset,col_width,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var progress = functions.createColoredBlock(\"#fa6a00\", NSMakeRect(0,settingY,col_width,12), false);\n    alertContent.addSubview(progress);\n    var progress = functions.createColoredBlock(\"#b25f29\", NSMakeRect((col_width+10),settingY,col_width,12), false);\n    alertContent.addSubview(progress);\n    var progress = functions.createColoredBlock(\"#66422c\", NSMakeRect((col_width+10)*2,settingY,col_width,12), false);\n    alertContent.addSubview(progress);\n    var progress = functions.createColoredBlock(\"#2d2e38\", NSMakeRect((col_width+10)*3,settingY,col_width,12), false);\n    alertContent.addSubview(progress);\n\n\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var groupdefaultFont_label = functions.createBoldLabel(\"Process Overview\",15,NSMakeRect(0,settingY + textOffset,windowWidth,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n\n\n\n    //FONT FAMILY\n    var pages_available=[];\n    for(var i=0; i<document.pages.length; i++){\n      var all_shapes= sketch.find('Shape', document.pages[i]).length;\n      var all_shapesPaths= sketch.find('ShapePath', document.pages[i]).length;\n      var all_texts= sketch.find('Text', document.pages[i]).length;\n      var total= all_shapes+all_shapesPaths+all_texts;\n      pages_available.push(document.pages[i].name+\" - \"+total);\n    }\n\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + (settingPad*3);\n    var selected_page = functions.createPopUpButton(pages_available,0,NSMakeRect(0,settingY,(windowWidth/2),fieldHeight));\n    alertContent.addSubview(selected_page);\n    \n\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var groupdefaultFont_label = functions.createBoldLabel(\"Select Page to Transform\",15,NSMakeRect(0,settingY + textOffset,windowWidth,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n\n    \n\n\t\talert.setIcon(alertIcon);\n\t\talert.setMessageText(\"Create Dark Mode System\");\n\t\talert.setInformativeText(\"This might take a while....\");\n\n    alert.accessoryView = alertContent;\n\n      //BUTTONS\n      var buttonOrganize = alert.addButtonWithTitle(\"Create Dark Mode\");\n      var buttonCancel = alert.addButtonWithTitle(\"Cancel\");\n      var responseCode = alert.runModal();\n  \n  \n      if (responseCode == 1000) { //create dark mode \n          var all_settings_l= Settings.documentSettingForKey(document, 'Styles_Layers');\n          var reviewed_Settings_l= functions.reviewSettings( document, all_settings_l);\n          Settings.setDocumentSettingForKey(document, 'Styles_Layers', reviewed_Settings_l);\n\n\n          var all_settings_c= Settings.documentSettingForKey(document, 'Styles_Containers');\n          var reviewed_Settings_c= functions.reviewSettings( document, all_settings_c);\n          Settings.setDocumentSettingForKey(document, 'Styles_Containers', reviewed_Settings_c);\n\n          var all_settings_t= Settings.documentSettingForKey(document, 'Styles_Texts');\n          var reviewed_Settings_t= functions.reviewSettings( document, all_settings_t);\n          Settings.setDocumentSettingForKey(document, 'Styles_Texts', reviewed_Settings_t);\n\n          \n\n        \n          var s_page= selected_page.indexOfSelectedItem();\n          \n          var all_shapes= sketch.find('Shape', document.pages[s_page]);\n          var all_shapesPaths= sketch.find('ShapePath', document.pages[s_page]);\n          var all_texts= sketch.find('Text', document.pages[s_page]);\n\n\n          var new_styles= functions.syncLayerwithStyles_best(Settings, sketch, document, s_page);\n\n          document.sharedLayerStyles= new_styles.layer;\n          document.sharedTextStyles= new_styles.text;\n\n          var count_added=document.sharedLayerStyles.length+document.sharedTextStyles.length;\n\n          var new_styles_ids=new_styles.new_styles;      \n          var new_styles_withdark= functions.createDarkModeStyle(Settings, document, new_styles.layer, new_styles.text, new_styles.new_styles);\n\n          Settings.setDocumentSettingForKey(document, 'Styles', new_styles_withdark.settings);\n          Settings.setDocumentSettingForKey(document, 'Styles_Containers', new_styles_withdark.settings_c);\n          Settings.setDocumentSettingForKey(document, 'Styles_Layers', new_styles_withdark.settings_l);\n          Settings.setDocumentSettingForKey(document, 'Styles_Texts', new_styles_withdark.settings_t);\n\n          document.sharedLayerStyles=  new_styles_withdark.layer; \n          document.sharedTextStyles=  new_styles_withdark.text; \n\n         // functions.SwitchDarkMode(document ,layers, new_styles_withdark.layer, new_styles_withdark.text, true);\n         var count= functions.SwitchDarkMode_best(Settings, sketch, document, s_page , new_styles_withdark.layer, new_styles_withdark.text, true);\n\n        if(count>0){\n          sketch.UI.message(' Created Dark Mode version in '+count+' Layers Sucessfully!'); \n        }else{\n          sketch.UI.message(\" All layers are already in Light Mode or haven't created a DarkMode System\"); \n\n        }   \n\n      }\n  }\n  \n\n\n\n\n\n\n\n\n\t// ------- ------- ------- -------\n  // switchLight AREA\n\t// ------- ------- ------- -------  \n\telse if (type && type == \"switchDark\") {\n    windowHeight = 90;\n    windowWidth = 300;\n\n    var document = sketch.getSelectedDocument();\n    var s_styles= Settings.documentSettingForKey(document, 'Styles');\n    //Settings.setDocumentSettingForKey(document, 'Font', groupdefaultFont.indexOfSelectedItem());\n    \n    \n    //create Modal\n    var s_colors= Settings.documentSettingForKey(document, 'colors');\n\n\n\t\tvar alert = NSAlert.alloc().init(),\n\t\talertIconPath = context.plugin.urlForResourceNamed(\"icon.png\").path(),\n\t\talertIcon = NSImage.alloc().initByReferencingFile(alertIconPath),\n\t\talertContent = NSView.alloc().init();\n    alertContent = NSView.alloc().initWithFrame(NSMakeRect(0, 0, windowWidth, windowHeight));\n\n\n\n    //FONT FAMILY\n    var pages_available=[];\n    for(var i=0; i<document.pages.length; i++){\n      //var all_shapes= sketch.find('Shape', document.pages[i]).length;\n      //var all_shapesPaths= sketch.find('ShapePath', document.pages[i]).length;\n      //var all_texts= sketch.find('Text', document.pages[i]).length;\n      //var total= all_shapes+all_shapesPaths+all_texts;\n      pages_available.push(document.pages[i].name);\n    }\n\n    var selected_page = functions.createPopUpButton(pages_available,0,NSMakeRect(0,settingY,windowWidth,fieldHeight));\n    alertContent.addSubview(selected_page);\n    \n\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var groupdefaultFont_label = functions.createBoldLabel(\"Select Page to Transform\",15,NSMakeRect(0,settingY + textOffset,windowWidth,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n\n    \n\n\t\talert.setIcon(alertIcon);\n\t\talert.setMessageText(\"Switch to Light Mode \");\n    alert.accessoryView = alertContent;\n\n      //BUTTONS\n      var buttonOrganize = alert.addButtonWithTitle(\"Switch Dark\");\n      var buttonCancel = alert.addButtonWithTitle(\"Cancel\");\n      var responseCode = alert.runModal();\n  \n  \n      if (responseCode == 1000) { //create dark mode \n        var s_page= selected_page.indexOfSelectedItem();\n        //functions.SwitchDarkMode(document ,layers, new_styles_withdark.layer, new_styles_withdark.text, false);\n        var count= functions.SwitchDarkMode_best(Settings, sketch, document, s_page , document.sharedLayerStyles, document.sharedTextStyles, true);\n\n        if(count>0){\n          sketch.UI.message(' Switched '+count+' Layers to Dark Mode Sucessfully!'); \n        }else{\n          sketch.UI.message(\" All layers are already in Dark Mode or haven't created a DarkMode System\"); \n\n        }\n    }\n  }\n\n  \n\n  \t// ------- ------- ------- -------\n  // switchLight AREA\n\t// ------- ------- ------- -------  \n\telse if (type && type == \"switchLight\") {\n    windowHeight = 90;\n    windowWidth = 300;\n\n    var document = sketch.getSelectedDocument();\n    var s_styles= Settings.documentSettingForKey(document, 'Styles');\n    //Settings.setDocumentSettingForKey(document, 'Font', groupdefaultFont.indexOfSelectedItem());\n    \n    \n    //create Modal\n    var s_colors= Settings.documentSettingForKey(document, 'colors');\n\n\n\t\tvar alert = NSAlert.alloc().init(),\n\t\talertIconPath = context.plugin.urlForResourceNamed(\"icon.png\").path(),\n\t\talertIcon = NSImage.alloc().initByReferencingFile(alertIconPath),\n\t\talertContent = NSView.alloc().init();\n    alertContent = NSView.alloc().initWithFrame(NSMakeRect(0, 0, windowWidth, windowHeight));\n\n\n\n    //FONT FAMILY\n    var pages_available=[];\n    for(var i=0; i<document.pages.length; i++){\n      //var all_shapes= sketch.find('Shape', document.pages[i]).length;\n      //var all_shapesPaths= sketch.find('ShapePath', document.pages[i]).length;\n      //var all_texts= sketch.find('Text', document.pages[i]).length;\n      //var total= all_shapes+all_shapesPaths+all_texts;\n      pages_available.push(document.pages[i].name);\n    }\n\n    var selected_page = functions.createPopUpButton(pages_available,0,NSMakeRect(0,settingY,windowWidth,fieldHeight));\n    alertContent.addSubview(selected_page);\n    \n\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var groupdefaultFont_label = functions.createBoldLabel(\"Select Page to Transform\",15,NSMakeRect(0,settingY + textOffset,windowWidth,labelHeight));\n    alertContent.addSubview(groupdefaultFont_label);\n\n    \n\n\t\talert.setIcon(alertIcon);\n\t\talert.setMessageText(\"Switch to Light Mode \");\n    alert.accessoryView = alertContent;\n\n      //BUTTONS\n      var buttonOrganize = alert.addButtonWithTitle(\"Switch Light\");\n      var buttonCancel = alert.addButtonWithTitle(\"Cancel\");\n      var responseCode = alert.runModal();\n  \n  \n      if (responseCode == 1000) { //create dark mode \n        var s_page= selected_page.indexOfSelectedItem();\n        //functions.SwitchDarkMode(document ,layers, new_styles_withdark.layer, new_styles_withdark.text, false);\n        var count= functions.SwitchDarkMode_best(Settings, sketch, document, s_page , document.sharedLayerStyles, document.sharedTextStyles, false);\n\n        if(count>0){\n          sketch.UI.message(' Switched '+count+' Layers to Light Mode Sucessfully!'); \n        }else{\n          sketch.UI.message(\" All layers are already in Light Mode or haven't created a DarkMode System\"); \n\n        }\n    }\n  }\n\n\n\n\n  \n\t// ------- ------- ------- -------\n  // SETTINGS AREA\n\t// ------- ------- ------- -------  \n\telse if (type && type == \"settings\") {\n\n    windowHeight = 460;\n    windowWidth = 800;\n    var all_settings_c= Settings.documentSettingForKey(document, 'Styles_Containers');\n    var all_settings_l= Settings.documentSettingForKey(document, 'Styles_Layers');\n    var all_settings_t= Settings.documentSettingForKey(document, 'Styles_Texts');\n    var scrolHeight= (((all_settings_c.length+all_settings_l.length+all_settings_t.length)*(labelHeight+settingPad)))*2;\n\n\t\tvar alert = NSAlert.alloc().init(),\n\t\talertIconPath = context.plugin.urlForResourceNamed(\"icon.png\").path(),\n    alertIcon = NSImage.alloc().initByReferencingFile(alertIconPath),\n\n    //scroll\n    alertscroll = NSScrollView.alloc().initWithFrame(NSMakeRect(0, 0, windowWidth, windowHeight)),\n    \n    //content\n    alertContent = NSView.alloc().initWithFrame(NSMakeRect(0, 0, windowWidth, scrolHeight));\n    alertContent.setFlipped(1);\n\n\n    alertscroll.setHasVerticalScroller(1);\n    alertscroll.setDocumentView(alertContent);  \n    \n    var col_1=440\n    var col=(windowWidth/2)-(col_1/2)-10+100;\n\n    //LABELS\n    var title_color_0 = functions.createBoldLabel(\"Type\",12,NSMakeRect(0,settingY ,col_1,labelHeight));\n    alertContent.addSubview(title_color_0);\n    var title_color_1 = functions.createBoldLabel(\"In Colored\",12,NSMakeRect(120,settingY ,col_1,labelHeight));\n    alertContent.addSubview(title_color_1);\n    var title_color_2 = functions.createBoldLabel(\"Light Style\",12,NSMakeRect((col_1/2)-10,settingY ,col,labelHeight));\n    alertContent.addSubview(title_color_2);\n    var title_color_3 = functions.createBoldLabel(\"Dark Style\",12,NSMakeRect((col+(col_1/2)-10),settingY ,col,labelHeight));\n    alertContent.addSubview(title_color_3);\n\n    var light_name=[];\n    var dark_name=[];\n    var type=[];\n    var colored_container=[];\n    //console.log(all_settings);\n\n    for(var j=0; j<3; j++){\n      var i=0;\n      var all_settings;\n\n      if(j==0){\n            all_settings= all_settings_c;\n      }else if(j==1){\n            all_settings= all_settings_l;\n      }else{\n            all_settings= all_settings_t;\n      }\n      for(var k=0; k<all_settings.length;k++){\n        settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n        \n        var dark_id= all_settings[i].dark;\n        var light_id= all_settings[i].light;\n    \n        if(all_settings[i].type==\"text\"){\n          var sharedStyle_light = document.getSharedTextStyleWithID(light_id);\n          var sharedStyle_dark = document.getSharedTextStyleWithID(dark_id);\n          type[i] = functions.createLabel(all_settings[i].element,12,NSMakeRect(0,settingY + textOffset,col_1,labelHeight));\n          alertContent.addSubview(type[i]);\n        }else{\n          var sharedStyle_light = document.getSharedLayerStyleWithID(light_id);\n          var sharedStyle_dark = document.getSharedLayerStyleWithID(dark_id);\n          type[i] = functions.createLabel(all_settings[i].element,12,NSMakeRect(0,settingY + textOffset,col_1,labelHeight));\n          alertContent.addSubview(type[i]);\n          \n        }\n          //console.log(sharedStyle_dark);\n          //console.log(sharedStyle_light);\n          colored_container[i] = functions.createLabel(String(all_settings[i].colored_container),12,NSMakeRect(120,settingY + textOffset,col_1,labelHeight));\n          alertContent.addSubview(colored_container[i]);\n\n        if(sharedStyle_light===undefined || sharedStyle_dark===undefined){\n          light_name[i] = functions.createLabel(\"-\",12,NSMakeRect((col_1/2)-10,settingY + textOffset,windowWidth-leftColWidth,labelHeight));\n          alertContent.addSubview(light_name[i]);\n          dark_name[i] = functions.createLabel(\"-\",12,NSMakeRect((col+(col_1/2)-10),settingY + textOffset,windowWidth-leftColWidth,labelHeight));\n          alertContent.addSubview(dark_name[i]);\n        // console.log(\"there is one settings missing\");\n        }else{\n          light_name[i] = functions.createLabel(sharedStyle_light.name,12,NSMakeRect((col_1/2)-10,settingY + textOffset,windowWidth-leftColWidth,labelHeight));\n          alertContent.addSubview(light_name[i]);\n          dark_name[i] = functions.createLabel(sharedStyle_dark.name,12,NSMakeRect((col+(col_1/2)-10),settingY + textOffset,windowWidth-leftColWidth,labelHeight));\n          alertContent.addSubview(dark_name[i]);\n        }\n        i++;\n      }\n\n    }\n\n    alert.setIcon(alertIcon);\n\t\talert.setMessageText(\"Edit Settings\");\n\t\talert.setInformativeText(\"Here you can setup some of the variables that help you generate and edit your DarkMode Systems.\");\n\n\t\talert.accessoryView = alertscroll;\n\t\tvar responseCode = alert.runModal();\n\n\t\tif (responseCode == 1000) {\n      return false;\n\t\t\t\n\t\t} else return false;\n  }\n\n\n\n\n\n\n\n\n\n\n\n\n // ------------------------------------------------\n  // create a Delete All Style System\n  // ------------------------------------------------\n  else if (type && type == \"deletesettings\") {\n    windowHeight = 10;\n    windowWidth = 400;\n    \n    var alert = NSAlert.alloc().init(),\n    alertIconPath = context.plugin.urlForResourceNamed(\"icon.png\").path(),\n    alertIcon = NSImage.alloc().initByReferencingFile(alertIconPath),\n    alertContent = NSView.alloc().init();\n    alertContent = NSView.alloc().initWithFrame(NSMakeRect(0, 0, windowWidth, windowHeight));\n\n    alert.setIcon(alertIcon);\n    alert.setMessageText(\"Delete All Settings \");\n    alert.setInformativeText(\"Are you Sure You want to delete all \"+get_settign_S.length+\" styles? This will not delete the shared styles connected to the layers, but the setting connecting the 2.\");\n    alert.accessoryView = alertContent;\n\n\n    //BUTTONS\n    var buttonOrganize = alert.addButtonWithTitle(\"Delete All\");\n    var buttonOrganize2 = alert.addButtonWithTitle(\"Delete Unused\");\n    var buttonCancel = alert.addButtonWithTitle(\"Cancel\");\n    // RUN MODAL\n    var responseCode = alert.runModal();\n   // log(styles_list);\n    if (responseCode == 1000) {\n      var all_settings_c= Settings.documentSettingForKey(document, 'Styles_Containers');\n      var all_settings_l= Settings.documentSettingForKey(document, 'Styles_Layers');\n      var all_settings_t= Settings.documentSettingForKey(document, 'Styles_Texts');\n\n\n      Settings.setDocumentSettingForKey(document, 'Styles_Containers', []);\n      Settings.setDocumentSettingForKey(document, 'Styles_Layers', []);\n      Settings.setDocumentSettingForKey(document, 'Styles_Texts', []);\n\n\n   \n      sketch.UI.message(' Deleted All! '+all_settings_c.length+' '+all_settings_l.length+' '+all_settings_t.length+' stylesmmm, sucessfully!');\n\n\n    }else if (responseCode == 1001) {\n      var all_settings_l= Settings.documentSettingForKey(document, 'Styles_Layers');\n      var reviewed_Settings_l= functions.reviewSettings( document, all_settings_l);\n      Settings.setDocumentSettingForKey(document, 'Styles_Layers', reviewed_Settings_l);\n\n\n      var all_settings_c= Settings.documentSettingForKey(document, 'Styles_Containers');\n      var reviewed_Settings_c= functions.reviewSettings( document, all_settings_c);\n      Settings.setDocumentSettingForKey(document, 'Styles_Containers', reviewed_Settings_c);\n\n      var all_settings_t= Settings.documentSettingForKey(document, 'Styles_Texts');\n      var reviewed_Settings_t= functions.reviewSettings( document, all_settings_t);\n      Settings.setDocumentSettingForKey(document, 'Styles_Texts', reviewed_Settings_t);\n\n      var deleted= (all_settings_c.length-reviewed_Settings_c.length)+ (all_settings_t.length-reviewed_Settings_t.length)+ (all_settings_l.length-reviewed_Settings_l.length);\n\n      sketch.UI.message(' Deleted '+deleted+' Settings , sucessfully! You now have '+(reviewed_Settings_c.length+reviewed_Settings_t.length+reviewed_Settings_l.length)+\" Settings!\");\n\n    }\n\n  }\n\n\n      \n  // ------- ------- ------- -------\n  // Colors AREA\n\t// ------- ------- ------- -------  \n\telse if (type && type == \"colors\") {\n    var count=0;\n   \n   \n    //Layer styles COlors\n    var colors_in_layer_styles= [];\n    var colors_in_layer_styles_names= [];\n    var styles_layer = document.sharedLayerStyles;\n    var s_colors= Settings.documentSettingForKey(document, 'colors');\n\n    //console.log(styles_layer);\n\n\n    //COLORS\n    var colors= s_colors;\n    var groupdefaultColorsCode = [];\n    var groupdefaultColorsCode_dark = [];\n    var groupdefaultColorsCode_block = [];\n    var groupdefaultColorsCode_block_dark = [];\n    var groupdefaultColorsName = [];\n\n    var groupdefaultColorsCode_textstyles = [];\n    var groupdefaultColorsCode_block_textstyles = [];\n    var groupdefaultColorsName_textstyles = [];\n\n    var groupdefaultColorsCode_layerstyles = [];\n    var groupdefaultColorsCode_block_layerstyles = [];\n    var groupdefaultColorsName_layerstyles = [];\n\n\n\n    for(var i=0; i<styles_layer.length; i++){\n      if( styles_layer[i].style.fills.length>0){\n\n        var layer_style_color= styles_layer[i].style.fills[0].color;\n        var repeated=0;\n        \n        for( var j=0; j<colors.length; j++){\n          if( layer_style_color == colors[j].code){\n            repeated++;\n            break;\n          }\n\n        }\n\n        for( var k=0; k<colors_in_layer_styles.length; k++){\n          if( layer_style_color == colors_in_layer_styles[k]){\n            repeated++;\n            break;\n          }\n        }\n        if(repeated==0){\n          colors_in_layer_styles.push(layer_style_color);\n          colors_in_layer_styles_names.push(styles_layer[i].name);\n        }\n\n\n    }\n  }\n\n\n    //Text styles COlors\n    var styles_list = document.sharedTextStyles;\n    var colors_in_text_styles= [];\n\n    for(var i=0; i<styles_list.length; i++){\n      var text_style_color= styles_list[i].style.textColor;\n      //console.log(text_style_color);\n      var repeated=0;\n      \n      for( var j=0; j<colors.length; j++){\n        if( text_style_color == colors[j].code){\n          repeated++;\n          break;\n        }\n\n      }\n\n      for( var k=0; k<colors_in_text_styles.length; k++){\n        if( text_style_color == colors_in_text_styles[k]){\n          repeated++;\n          break;\n        }\n      }\n      \n      if(repeated==0 && text_style_color!=undefined){\n        colors_in_text_styles.push(text_style_color);\n      }\n\n    }\n   // Settings.setDocumentSettingForKey(document, 'colors', []);\n\n\n    windowHeight = 100 + (s_colors.length*(fieldHeight+settingPad)\n                    +(colors_in_layer_styles.length* (fieldHeight+settingPad))\n                    +(colors_in_text_styles.length* (fieldHeight+settingPad))+100);\n    windowWidth = 600;\n\n\t\tvar alert = NSAlert.alloc().init(),\n\t\talertIconPath = context.plugin.urlForResourceNamed(\"icon.png\").path(),\n\t\talertIcon = NSImage.alloc().initByReferencingFile(alertIconPath),\n\t\talertContent = NSView.alloc().init();\n    alertContent = NSView.alloc().initWithFrame(NSMakeRect(0, 0, windowWidth, windowHeight));\n\n\t\talert.setIcon(alertIcon);\n\t\talert.setMessageText(\"Edit Document Colors\");\n\t\talert.setInformativeText(\"Here you can setup some of the variables that help you generate and edit your DarkMode Systems.\");\n\n    alert.accessoryView = alertContent;\n\n\n\n    groupdefaultColorsCode[colors.length] = functions.createField(\"\", NSMakeRect(40,settingY,(windowWidth/2)-50,fieldHeight));\n    alertContent.addSubview(groupdefaultColorsCode[colors.length]);\n\n    groupdefaultColorsName[colors.length] = functions.createField(\"\", NSMakeRect(windowWidth/2,settingY,windowWidth/2,fieldHeight));\n    alertContent.addSubview(groupdefaultColorsName[colors.length]);\n\n   \n    //TITLES\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var title_color_1 = functions.createLabel(\"Color Code\",12,NSMakeRect(40,settingY,(windowWidth/2)-50,fieldHeight));\n    alertContent.addSubview(title_color_1);\n\n    var title_color_2 = functions.createLabel(\"Color Name\",12,NSMakeRect(windowWidth/2,settingY,windowWidth/2,fieldHeight));\n    alertContent.addSubview(title_color_2);\n\n\n    //TITLES\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var title_color = functions.createBoldLabel(\"Add New Color\",12,NSMakeRect(0,settingY + textOffset,windowWidth-leftColWidth,labelHeight));\n    alertContent.addSubview(title_color);\n\n    // DIVIDER\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var divider_2 = functions.createDivider(NSMakeRect(0,settingY,windowWidth,1));\n    alertContent.addSubview(divider_2);\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n \n\n\n\n\n    for( var i=colors_in_layer_styles.length-1; i>=0; i--){\n      settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n      \n      groupdefaultColorsCode_block_layerstyles[i] = functions.createColoredBlock(colors_in_layer_styles[i], NSMakeRect(0,settingY,fieldHeight,fieldHeight), false);\n      alertContent.addSubview(groupdefaultColorsCode_block_layerstyles[i]);\n\n      groupdefaultColorsCode_layerstyles[i] = functions.createField(colors_in_layer_styles[i], NSMakeRect(40,settingY,(windowWidth/2)-50,fieldHeight));\n      alertContent.addSubview(groupdefaultColorsCode_layerstyles[i]);\n\n      groupdefaultColorsName_layerstyles[i] = functions.createField(colors_in_layer_styles_names[i], NSMakeRect(windowWidth/2,settingY,windowWidth/2,fieldHeight));\n      alertContent.addSubview(groupdefaultColorsName_layerstyles[i]);\n    \n    }\n    //TITLES\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var title_color = functions.createBoldLabel(\"New Colors from Layer Styles\",12,NSMakeRect(0,settingY + textOffset,windowWidth-leftColWidth,labelHeight));\n    alertContent.addSubview(title_color);\n    \n\n\n    // DIVIDER\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var divider_2 = functions.createDivider(NSMakeRect(0,settingY,windowWidth,1));\n    alertContent.addSubview(divider_2);\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n \n\n    //console.log(styles[]);\n    for( var i=colors_in_text_styles.length-1; i>=0; i--){\n      settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n      \n      groupdefaultColorsCode_block_textstyles[i] = functions.createColoredBlock(colors_in_text_styles[i], NSMakeRect(0,settingY,fieldHeight,fieldHeight),false);\n      alertContent.addSubview(groupdefaultColorsCode_block_textstyles[i]);\n\n      groupdefaultColorsCode_textstyles[i] = functions.createField(colors_in_text_styles[i], NSMakeRect(40,settingY,(windowWidth/2)-50,fieldHeight));\n      alertContent.addSubview(groupdefaultColorsCode_textstyles[i]);\n\n      groupdefaultColorsName_textstyles[i] = functions.createField(colors_in_text_styles[i], NSMakeRect(windowWidth/2,settingY,windowWidth/2,fieldHeight));\n      alertContent.addSubview(groupdefaultColorsName_textstyles[i]);\n    \n    }\n\n    \n    //TITLES\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var title_color = functions.createBoldLabel(\"New Colors from Text Styles\",12,NSMakeRect(0,settingY + textOffset,windowWidth-leftColWidth,labelHeight));\n    alertContent.addSubview(title_color);\n    \n\n\n    // DIVIDER\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var divider_2 = functions.createDivider(NSMakeRect(0,settingY,windowWidth,1));\n    alertContent.addSubview(divider_2);\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n \n\n    for( var i=colors.length-1; i>=0; i--){\n        settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n      \n        groupdefaultColorsCode_block[i] = functions.createColoredBlock(colors[i].code, NSMakeRect(0,settingY,fieldHeight,fieldHeight), false);\n        alertContent.addSubview(groupdefaultColorsCode_block[i]);\n\n        groupdefaultColorsCode[i] = functions.createField(colors[i].code, NSMakeRect(50,settingY,(windowWidth/3)-50,fieldHeight));\n        alertContent.addSubview(groupdefaultColorsCode[i]);\n\n        groupdefaultColorsName[i] = functions.createField(colors[i].name, NSMakeRect(windowWidth/3,settingY,windowWidth/3,fieldHeight));\n        alertContent.addSubview(groupdefaultColorsName[i]);\n\n\n        groupdefaultColorsCode_block_dark[i] = functions.createColoredBlock(colors[i].code, NSMakeRect(windowWidth/3*2+40,settingY,fieldHeight,fieldHeight), true);\n        alertContent.addSubview(groupdefaultColorsCode_block_dark[i]);\n\n        var color= colors[i].code;\n        if(color.length>7){\n          var alpha = color.slice(7, 9);\n        }else{\n          var alpha=\"ff\";\n        }\n        var dark_hex_hex= functions.DarkMode(color,\"Shape_Fill\");\n        var dark_hex= functions.RGBToHex(\"rgb(\"+dark_hex_hex.r+\",\"+dark_hex_hex.g+\",\"+dark_hex_hex.b+\")\");\n        groupdefaultColorsCode_dark[i] = functions.createLabel(dark_hex+alpha,12, NSMakeRect(windowWidth/3*2+90,settingY,(windowWidth/3*3)-90,fieldHeight));\n        alertContent.addSubview(groupdefaultColorsCode_dark[i]);\n      \n    }\n\n    //TITLES\n    settingY = CGRectGetMaxY(alertContent.subviews().lastObject().frame()) + settingPad;\n    var title_color = functions.createBoldLabel(\"Colors\",12,NSMakeRect(0,settingY + textOffset,windowWidth-leftColWidth,labelHeight));\n    alertContent.addSubview(title_color);\n\n\n\n\t\talert.accessoryView = alertContent;\n    //BUTTONS\n\t\tvar buttonOrganize = alert.addButtonWithTitle(\"Update Colors\");\n\t\tvar buttonOrganize = alert.addButtonWithTitle(\"Add Color\");\n\t\tvar buttonOrganize = alert.addButtonWithTitle(\"Add Text Colors\");\n\t\tvar buttonCancel = alert.addButtonWithTitle(\"Cancel\");\n\t\tvar responseCode = alert.runModal();\n\n\n    if (responseCode == 1000) { //update color\n      var validated_array = functions.validateColorInput(groupdefaultColorsCode, groupdefaultColorsName, false);\n      Settings.setDocumentSettingForKey(document, 'colors', validated_array);\n    }\n    else if (responseCode == 1001) {  //add color\n\n      var count_repeated=0;\n      for(var j=0; j<colors.length; j++){\n        if( groupdefaultColorsCode[colors.length].stringValue()==colors[j].code){\n          count_repeated++;\n          break;\n\n        }\n      }\n      if( count_repeated==0){\n        var validated_array = functions.validateColorInput( groupdefaultColorsCode, groupdefaultColorsName, true);\n        Settings.setDocumentSettingForKey(document, 'colors', validated_array);\n        sketch.UI.message('Color added!');\n\n      }else{\n        \n        sketch.UI.message(' That Color code already exists! Color not added.');\n\n      }\n\n    }\n    else if (responseCode == 1002) {  //add color from text\n      var groupdefaultColorsCode_merged = groupdefaultColorsCode.concat(groupdefaultColorsCode_textstyles);\n      var groupdefaultColorsName_merged = groupdefaultColorsName.concat(groupdefaultColorsName_textstyles);\n\n      var validated_array = functions.validateColorInput(groupdefaultColorsCode_merged, groupdefaultColorsName_merged, true);\n      Settings.setDocumentSettingForKey(document, 'colors', validated_array);\n\n      //console.log(validated_array);\n\n    }\n  }\n\n}\n\n\n\n","import sketch from 'sketch';\nimport M from 'minimatch';\n\n// ------------------\n//inputs\n// ------------------\nexport function getFontIndex(font_name,avail_fonts) {\n    var index=0;\n    //has to convert them to normal array, as {sys_fonts} is array-like object, and is persistent, so when modified, changes stay between runs of script\n    for (var i = 0; i < avail_fonts.length; i++) {\n        var font_info = avail_fonts[i];\n\n        var font_selected = font_name;\n        var style_oposite = document.getSharedTextStyleWithID(style_oposite_id);\n\n        if(font_info==font_selected && style_oposite!=null){\n            index=i;\n            break;\n        }\n    }\n    return index;\n}\n\nexport function getSpecificFonts(specific_font) {\n  var fontManager = NSFontManager.sharedFontManager();\n  var fonts = {\n      family : [],\n      weights : []\n  }\n  var sys_fonts_families = fontManager.availableFontFamilies();\n\n  for (var i = 0; i < sys_fonts_families.length; i++) {\n    if(sys_fonts_families[i]== specific_font){\n      fonts.family.push(sys_fonts_families[i]);\n\n      var w= fontManager.availableMembersOfFontFamily(sys_fonts_families[i]);\n      var weights =[];\n      //log(w);\n      for(var m=0; m<w.length; m++){\n          \n          weights.push({\"name\": w[m][1],\"font\": w[m][0], \"weight\": w[m][2], \"variation\":w[m][3]});\n\n      }\n      if(w.length.length==0){\n          weights.push({\"name\": \"plain\",\"font\": sys_fonts_families[i], \"weight\":\"5\", \"variation\":0});\n\n      }\n      fonts.weights.push(weights);\n    }\n  }\n  return fonts;\n}\n\n\n\nexport function getFonts() {\n    var fontManager = NSFontManager.sharedFontManager();\n    var fonts = {\n        family : [],\n        weights : []\n    }\n    var sys_fonts = fontManager.availableFonts();\n    var sys_fonts_families = fontManager.availableFontFamilies();\n\n   var w= fontManager.availableMembersOfFontFamily(sys_fonts_families[0]);\n\n    var last_font;\n\n\n    for (var i = 0; i < sys_fonts_families.length; i++) {\n        fonts.family.push(sys_fonts_families[i]);\n\n        var w= fontManager.availableMembersOfFontFamily(sys_fonts_families[i]);\n        var weights =[];\n        //log(w);\n        for(var m=0; m<w.length; m++){\n            \n            weights.push({\"name\": w[m][1],\"font\": w[m][0], \"weight\": w[m][2], \"variation\":w[m][3]});\n\n        }\n        if(w.length.length==0){\n            weights.push({\"name\": \"plain\",\"font\": sys_fonts_families[i], \"weight\":\"5\", \"variation\":0});\n\n        }\n        fonts.weights.push(weights);\n    }\n    return fonts;\n  }\n\n\n  export function getFontsOld() {\n    var fontManager = NSFontManager.sharedFontManager();\n    var fonts = [];\n    var sys_fonts = fontManager.availableFonts();\n    //has to convert them to normal array, as {sys_fonts} is array-like object, and is persistent, so when modified, changes stay between runs of script\n    for (var i = 0; i < sys_fonts.length; i++) {\n        fonts.push(sys_fonts[i] );\n    }\n    return fonts;\n  }\n  /*\n  export function getFontIndex(font) {\n    var fontManager = NSFontManager.sharedFontManager();\n    var font_name ;\n    var sys_fonts = fontManager.availableFonts();\n    //has to convert them to normal array, as {sys_fonts} is array-like object, and is persistent, so when modified, changes stay between runs of script\n    for (var i = 0; i < sys_fonts.length; ++i) {\n        if(sys_fonts[i]==font){\n            font_name=i;\n            break;\n\n        }\n    }\n    return font_name;\n  }\n  */\n  export function getFontName(index) {\n    var fontManager = NSFontManager.sharedFontManager();\n    var font_name ;\n    var sys_fonts = fontManager.availableFonts();\n    //has to convert them to normal array, as {sys_fonts} is array-like object, and is persistent, so when modified, changes stay between runs of script\n    for (var i = 0; i < sys_fonts.length; ++i) {\n        if(i==index){\n            font_name=sys_fonts[i];\n            break;\n\n        }\n    }\n    return font_name;\n  }\n\n\n// ------------------\n// text style\n// ------------------\n\nexport function addTextStyle(context,styleName,theStyle) {\n\tvar sketchVersion = MSApplicationMetadata.metadata().appVersion;\n\tvar textStyles = context.document.documentData().layerTextStyles();\n\n\tif (textStyles.addSharedStyleWithName_firstInstance) {\n\t\ttextStyles.addSharedStyleWithName_firstInstance(styleName,theStyle.style());\n\t} else if (sketchVersion < 52) {\n\t\tvar textStyle = MSSharedStyle.alloc().initWithName_firstInstance(styleName,theStyle.style());\n\n\t\ttextStyles.addSharedObject(textStyle);\n\t} else {\n\t\tvar textStyle = MSSharedStyle.alloc().initWithName_style(styleName,theStyle.style());\n\n\t\ttextStyles.addSharedObject(textStyle);\n\t}\n\n\treturn getTextStyleByName(context,styleName);\n}\n\n\n/*\nfunction updateTextStyle(context,styleName,theStyle) {\n\tvar textStyles = context.document.documentData().layerTextStyles(),\n\t\tcurrentStyle = getTextStyleByName(context,styleName);\n\n\tif (textStyles.updateValueOfSharedObject_byCopyingInstance) {\n\t\ttextStyles.updateValueOfSharedObject_byCopyingInstance(currentStyle,theStyle.style());\n\t} else {\n\t\tcurrentStyle.updateToMatch(theStyle.style());\n\t}\n\n\treturn getTextStyleByName(context,styleName);\n}\n*/\n/*\nexport function createTextStyle(styleData,frame) {\n\tvar textStyle = MSTextLayer.alloc().initWithFrame(frame);\n\ttextStyle.setFontSize(styleData.fontSize);\n\ttextStyle.setLineHeight(styleData.lineHeight);\n\ttextStyle.setTextAlignment(styleData.textAlignment);\n\ttextStyle.setFontPostscriptName(styleData.fontFace);\n\ttextStyle.setTextColor(MSImmutableColor.colorWithSVGString(\"#\" + styleData.fontColor));\n\n\treturn textStyle;\n}\n*/\n\nexport function updateTextStyle(document, Text, Rectangle, create_info,defaultSettings , place){\n    var base = create_info.base.stringValue();\n    var ratio = parseFloat(create_info.ratio.stringValue().replace(\",\", \".\"));\n    var font_family = create_info.font_family.titleOfSelectedItem();\n    var font_weight = create_info.font_weight.titleOfSelectedItem();\n    var font_weight_index = create_info.font_weight.indexOfSelectedItem();\n    var font_color = create_info.color.indexOfSelectedItem();\n    var font_color_name = create_info.color.titleOfSelectedItem();\n    var color = defaultSettings.s_colors[font_color].code;\n    var weights_array= create_info.list_weights;\n    var labels_alignments= create_info.labels_alignments;\n      \n    var count=[];\n    var count_updated=0;\n    var count_Created=0;\n\n    var weight_info= getWeightfromPopupButton(font_weight_index,font_weight,weights_array);\n      \n    var i=0;\n    var initial_size = base/ratio/ratio/ratio;\n    var is_italic= getIs_italic(weight_info[0].name);\n\n    while (i< defaultSettings.s_labels.length){\n        var size = initial_size* Math.pow(ratio, i+1);\n        var label= defaultSettings.s_labels.length -i-1;\n\n        for (var j=0; j<3; j++){\n          var options = [defaultSettings.s_labels[label], font_family, weight_info[0].name, font_color_name, labels_alignments[j]];\n          var h= defaultSettings.s_hierarchy;\n          var styleName= options[h[0]]+\"/\"+options[h[1]]+\"/\"+options[h[2]]+\"/\"+options[h[3]]+\"/\"+options[h[4]];\n          \n         // var styleName=defaultSettings.s_labels[label]+\"/\"+font_color_name+\"/\"+weight_info[0].name+\"/\"+labels_alignments[j];\n          var titleStyle = getTextStyleByName(context,styleName);\n          // If title style does not exist...\n          let styles_list = document.sharedTextStyles;\n\n          var style_to_update= getTextStyleByNameLabel(styleName, styles_list)\n          if (!titleStyle) {\n            count_Created++; \n            document.sharedTextStyles.push({\n              name: styleName,\n              style:{\n                fontFamily: font_family ,\n                fontSize : size,\n                fontStyle: is_italic,\n                fontWeight : weight_info[0].weight,\n                textColor : color+\"ff\",\n                lineHeight :(size*1.2),\n                alignment : j,\n                borders : [],\n                fills : []\n              }\n            })\n            \n          }else{\n            count_updated++;\n            var new_style ={\n                fontFamily: font_family ,\n                fontSize : size,\n                fontStyle: is_italic,\n                fontWeight : weight_info[0].weight,\n                textColor : color+\"ff\",\n                lineHeight :(size*1.2),\n                alignment : j,\n                borders : [],\n                fills : []\n              };\n              //log(titleStyle);\n              //log(style_to_update);\n              style_to_update.style.fontFamily= font_family;\n              style_to_update.style.fontSize= size;\n              style_to_update.style.fontStyle= is_italic;\n              style_to_update.style.fontWeight= weight_info[0].weight;\n              style_to_update.style.lineHeight= (size*1.2);\n\n              var layers = style_to_update.getAllInstancesLayers();\n              //log(\"NEW CHANge\");\n              for(var m=0; m< layers.length; m++){\n                  layers[m].style.syncWithSharedStyle(style_to_update);\n\n              }\n          }\n\n        }\n        i++;\n    }\n    if(place>0){\n        //placeTextStyles(document, Text, Rectangle);\n        \n    }\n\n    var count=[count_Created,count_updated];\n    return count;\n}\n\n\n\n\n\nexport function updateTextStyleLabel(document, Text, Rectangle, create_info,defaultSettings , place){\n  var base = create_info.base.stringValue();\n  var ratio = parseFloat(create_info.ratio.stringValue().replace(\",\", \".\"));\n  var font_family = create_info.font_family.titleOfSelectedItem();\n  var font_weight = create_info.font_weight.titleOfSelectedItem();\n  var font_weight_index = create_info.font_weight.indexOfSelectedItem();\n  var font_color = create_info.color.indexOfSelectedItem();\n  var font_color_name = create_info.color.titleOfSelectedItem();\n\n  var color = defaultSettings.s_colors[font_color].code;\n  var weights_array= create_info.list_weights;\n  var labels_alignments= create_info.labels_alignments;\n    \n  print(ratio);\n  var count=[];\n  var count_updated=0;\n  var count_Created=0;\n\n  var weight_info= getWeightfromPopupButton(font_weight_index,font_weight,weights_array);\n    \n  var i=0;\n  var initial_size = base/ratio/ratio/ratio;\n  var is_italic= getIs_italic(weight_info[0].name);\n\n  while (i< defaultSettings.s_labels.length){\n      var size = initial_size* Math.pow(ratio, i+1);\n      var label= defaultSettings.s_labels.length -i-1;\n\n      for (var j=0; j<3; j++){\n        var options = [defaultSettings.s_labels[label], font_family, weight_info[0].name, font_color_name, labels_alignments[j]];\n        var h= defaultSettings.s_hierarchy;\n        var styleName= options[h[0]]+\"/\"+options[h[1]]+\"/\"+options[h[2]]+\"/\"+options[h[3]]+\"/\"+options[h[4]];\n        \n       // var styleName=defaultSettings.s_labels[label]+\"/\"+font_color_name+\"/\"+weight_info[0].name+\"/\"+labels_alignments[j];\n        var titleStyle = getTextStyleByName(context,styleName);\n        // If title style does not exist...\n        let styles_list = document.sharedTextStyles;\n\n        var style_to_update= getTextStyleByNameLabel(styleName, styles_list)\n        if (!titleStyle) {\n          count_Created++; \n          document.sharedTextStyles.push({\n            name: styleName,\n            style:{\n              fontFamily: font_family ,\n              fontSize : size,\n              fontStyle: is_italic,\n              fontWeight : weight_info[0].weight,\n              textColor : color+\"ff\",\n              lineHeight :(size*1.2),\n              alignment : j,\n              borders : [],\n              fills : []\n            }\n          })\n          \n        }else{\n          count_updated++;\n          var new_style ={\n              fontFamily: font_family ,\n              fontSize : size,\n              fontStyle: is_italic,\n              fontWeight : weight_info[0].weight,\n              textColor : color+\"ff\",\n              lineHeight :(size*1.2),\n              alignment : j,\n              borders : [],\n              fills : []\n            };\n            //log(titleStyle);\n            //log(style_to_update);\n            style_to_update.style.fontFamily= font_family;\n            style_to_update.style.fontSize= size;\n            style_to_update.style.fontStyle= is_italic;\n            style_to_update.style.fontWeight= weight_info[0].weight;\n            style_to_update.style.lineHeight= (size*1.2);\n\n            var layers = style_to_update.getAllInstancesLayers();\n            //log(\"NEW CHANge\");\n            for(var m=0; m< layers.length; m++){\n                layers[m].style.syncWithSharedStyle(style_to_update);\n\n            }\n        }\n\n      }\n      i++;\n  }\n  if(place>0){\n      //placeTextStyles(document, Text, Rectangle);\n      \n  }\n\n  var count=[count_Created,count_updated];\n  return count;\n}\n\n\n\nexport function createTextStyle(document, Text, Rectangle, create_info,defaultSettings , place){\n    var base = create_info.base.stringValue();\n    var ratio = parseFloat(create_info.ratio.stringValue().replace(\",\", \".\"));\n    var font_family = create_info.font_family.titleOfSelectedItem();\n    var font_weight = create_info.font_weight.titleOfSelectedItem();\n    var font_weight_index = create_info.font_weight.indexOfSelectedItem();\n    var font_color = create_info.color.indexOfSelectedItem();\n    var font_color_name = create_info.color.titleOfSelectedItem();\n    var color = defaultSettings.s_colors[font_color].code;\n    var weights_array= create_info.list_weights;\n    var labels_alignments= create_info.labels_alignments;\n  print(ratio);\n      \n    var count=[];\n    var count_existent=0;\n      var weight_info= getWeightfromPopupButton(font_weight_index,font_weight,weights_array);\n      \n\n      var i=0;\n      var initial_size = base/ratio/ratio/ratio;\n      var count_Created=0;\n      var is_italic= getIs_italic(weight_info[0].name);\n\n\n      while (i< defaultSettings.s_labels.length){\n        var size = initial_size* Math.pow(ratio, i+1);\n        var label= defaultSettings.s_labels.length -i-1;\n\n        for (var j=0; j<3; j++){\n\n\n          //HIERARQUIA\n          var options = [defaultSettings.s_labels[label], font_family, weight_info[0].name, font_color_name, labels_alignments[j]];\n          var h= defaultSettings.s_hierarchy;\n          var styleName= options[h[0]]+\"/\"+options[h[1]]+\"/\"+options[h[2]]+\"/\"+options[h[3]]+\"/\"+options[h[4]];\n          //var styleName=defaultSettings.s_labels[label]+\"/\"+font_family+\"/\"+weight_info[0].name+\"/\"+font_color_name+\"/\"+labels_alignments[j];\n          var titleStyle = getTextStyleByName(context,styleName);\n          // If title style does not exist...\n          if (!titleStyle) {\n            count_Created++; \n\n            const page = document.selectedPage;\n            document.sharedTextStyles.push({\n              name: styleName,\n              style:{\n                fontFamily: font_family ,\n                fontSize : size,\n                fontStyle: is_italic,\n                fontWeight : weight_info[0].weight,\n                textColor : color+\"ff\",\n                lineHeight :(size*1.2),\n                alignment : j,\n                borders : [],\n                fills : []\n              }\n            })\n            \n          }else{\n            count_existent++;\n          }\n\n        }\n        i++;\n      }\n    if(place>0){\n        placeTextStyles(document, Text, Rectangle);\n    }\n    var count=[count_Created,count_existent];\n\n    return count;\n}\n\n\nexport function placeTextStyles(document, Text, Rectangle){\n\n    var x=0;\n    var y=0;\n    var layer_width= 800;\n    var layer_height= 70;\n\n\n    var styles_list = document.sharedTextStyles;\n    var page = document.selectedPage;\n    var Group = require('sketch/dom').Group;\n\n    var Artboard = require('sketch/dom').Artboard;\n\n    var organized_styles= OrganizeArrayTextStyles(styles_list);\n\n    var layers_artboard = document.getLayersNamed(\"TypeSystem\");\n    if (layers_artboard.length) {\n      //  layers[0].remove();\n        var artboard =layers_artboard[0];\n        artboard.layers=[];\n    }else{\n        var artboard = new Artboard({\n            name: 'TypeSystem',\n            parent: page\n        });\n    }\n    \n\n    var layers = document.getLayersNamed(\"Group TypeSystem\");\n    if (layers.length) {\n      //  layers[0].remove();\n        var group =layers[0];\n        group.layers=[];\n    }else{\n        var group = new Group({\n            name: 'Group TypeSystem',\n            parent: artboard\n        });\n    }\n    \n    // log (organized_styles);\n    if(organized_styles.length>0){\n        for(var j=0; j<organized_styles.length; j++){\n            y=j*(layer_height+10);\n            // STYLES INDIVIDUALLY\n            var styles= organized_styles[j].styles;\n            for(var i=0; i<styles.length; i++){\n                x=i*(layer_width+100);\n\n                var rect = new Rectangle(x, y, layer_width, layer_height);\n                var text = new Text({\n                    text: styles[i].name,\n                    sharedStyleId:styles[i].id,\n                    frame: rect,\n                    parent: group,\n                    style: styles[i].style\n                })\n                //document.centerOnLayer(text);\n\n            }\n           \n        }\n        sketch.UI.message(' Placed '+styles_list.length+' text styles, sucessfully!');\n        group.adjustToFit();\n        artboard.adjustToFit();\n        var padding =100;\n        var h= artboard.frame.height+(padding*2);\n        var w= artboard.frame.width+(padding*2);\n        var art_x= artboard.frame.x -padding;\n        var art_y= artboard.frame.y - padding;\n\n        artboard.frame.height=h;\n        artboard.frame.width=w;\n        artboard.frame.x=art_x;\n        artboard.frame.y=art_y;\n\n        group.frame.x=padding;\n        group.frame.y=padding;\n\n\n    }else{\n        sketch.UI.message('No Styles to Place :( Try creating them first.');    \n    }\n}\n\nexport function elementHasStyle(all_styles, id){\n  var exists=false;\n  //console.log(all_styles);\n\n\n  for(var i= 0; i< all_styles.length; i++){\n    if(id==all_styles[i].id){\n      exists=all_styles[i];\n      break;\n    }\n  }\n  return exists;\n\n}\n\n\nexport function ifStyleNameAlreadyExists(all_styles, name){\n  var exists=false;\n  //console.log(all_styles);\n\n  for(var i= 0; i< all_styles.length; i++){\n    if(name.replace(\" \",\"\")==all_styles[i].name.replace(\" \",\"\")){\n      exists=true;\n      break;\n    }\n  }\n  return exists;\n\n}\n\nexport function getStyleByName(all_styles, name){\n  var style=false;\n  //console.log(all_styles);\n\n  for(var i= 0; i< all_styles.length; i++){\n    if(name.replace(\" \", \"\")==all_styles[i].name.replace(\" \", \"\")){\n      style=all_styles[i];\n      break;\n    }\n  }\n  return style;\n\n}\n\n\n\nexport function getStyleById(all_styles, id){\n  var style=false;\n  //console.log(all_styles);\n\n  for(var i= 0; i< all_styles.length; i++){\n    if(id==all_styles[i].id){\n      style=all_styles[i];\n      break;\n    }\n  }\n  return style;\n\n}\n\n\n\nexport function getTextStyleByName(context,styleName,removeStyle) {\n\tvar textStyles = context.document.documentData().layerTextStyles().objects();\n\n\tif (textStyles) {\n\t\tfor (var i = 0; i < textStyles.count(); i++) {\n\t\t\tif (textStyles.objectAtIndex(i).name() == styleName) {\n\t\t\t\tif (removeStyle && removeStyle == 1) {\n\t\t\t\t\tcontext.document.documentData().layerTextStyles().removeSharedStyle(textStyles.objectAtIndex(i));\n\t\t\t\t\treturn false;\n\t\t\t\t} else {\n\t\t\t\t\treturn textStyles.objectAtIndex(i);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn false;\n}\n\n// ------------------\n// functions\n// ------------------\nexport function updateSettingsWithDocument(context,settings, page) {\n    var i;\n      for (i in settings) {\n          try {\n              var value = sketch.Settings.layerSettingForKey(page,i);\n          } catch (err) {\n              log('Could not JSON.parse value, using old method');\n  \n              var value = context.command.valueForKey_onLayer(i,page.sketchObject);\n          }\n  \n          if (value != null) settings[i] = value;\n      }\n  \n      return settings;\n  }\nexport function updateSettingsWithGlobal(defaults,settings) {\n    var i;\n      for (i in settings) {\n          var value = defaults.objectForKey(i);\n          if (value) settings[i] = value;\n      }\n  \n      return settings;\n  }\n  \nexport function createSelect(items,selectedItemIndex,frame) {\n\tvar comboBox = NSComboBox.alloc().initWithFrame(frame),\n\t\tselectedItemIndex = (selectedItemIndex > -1) ? selectedItemIndex : 0;\n\n\tcomboBox.addItemsWithObjectValues(items);\n\tcomboBox.selectItemAtIndex(selectedItemIndex);\n\tcomboBox.setNumberOfVisibleItems(16);\n    comboBox.setCompletes(1);\n    \n\treturn comboBox;\n}\n\n\n  \nexport function createPopUpButton(items,selectedItemIndex,frame) {\n\tvar PopUpButton = NSPopUpButton.alloc().initWithFrame(frame),\n\t\tselectedItemIndex = (selectedItemIndex > -1) ? selectedItemIndex : 0;\n\n    PopUpButton.addItemsWithTitles(items);\n    PopUpButton.selectItemAtIndex(selectedItemIndex);\n    PopUpButton.setTarget=self;\n\n\treturn PopUpButton;\n}\n\n\nexport function createPopUpButtonWeights(items,selectedItemIndex,frame) {\n\tvar PopUpButton = NSPopUpButton.alloc().initWithFrame(frame),\n        selectedItemIndex = (selectedItemIndex > -1) ? selectedItemIndex : 0;\n        \n    var items_names=[];\n    \n    for(var i=0; i<items.length; i++){\n        items_names.push(items[i].name);\n    }\n    //log(items);\n    PopUpButton.addItemsWithTitles(items_names);\n    PopUpButton.selectItemAtIndex(selectedItemIndex);\n    PopUpButton.setTarget=self;\n\n\treturn PopUpButton;\n}\n\n\nexport function getIndexforPopupButton(weight, style, all_weights){\n    var index=0;\n   // log(all_weights);\n    for(var i=0; i<all_weights.length; i++){\n        if (style == null && all_weights[i].weight == weight ) { \n            index=i;\n            break;\n        }\n        else if (all_weights[i].name.toLowerCase().indexOf(style) !== -1 && all_weights[i].weight == weight ) { \n            index=i;\n            break;\n        }\n        \n    }\n    return index;\n}\n\n\nexport function getWeightfromPopupButton(index, name, all_weights){\n    var weight=[];\n    if(all_weights.length>0){\n        for(var i=0; i<all_weights.length; i++){\n            var str =  name.replace(\" \", \"\");\n\n            if (all_weights[i].name ==name) {\n                weight.push({\"name\": all_weights[index].name, \"font\": all_weights[index].font, \"weight\": all_weights[index].weight, \"variation\": all_weights[index].variation});\n                break;\n            }\n        }\n    }else{\n        weight=5;\n    }\n    return weight;\n}\nexport function getIs_italic(font_name){\n    var italic= undefined;\n    if (font_name.toLowerCase().indexOf(\"italic\") !== -1 ) {\n        italic =\"italic\";\n    }\n    return italic;\n\n}\nexport function getTextStyleByNameLabel(name, styles_list){\n    var style=[];\n    for(var i=0; i<styles_list.length; i++){\n        if(styles_list[i].name==name){\n            style.push(styles_list[i]); \n            break;\n        }\n    }\n    return style[0];\n\n\n}\nexport function getUserDefaults(domain) {\n\treturn NSUserDefaults.alloc().initWithSuiteName(domain);\n}\n\n\nexport function createBoldLabel(text,size,frame) {\n\tvar label = NSTextField.alloc().initWithFrame(frame);\n\n\tlabel.setStringValue(text);\n\tlabel.setFont(NSFont.boldSystemFontOfSize(size));\n\tlabel.setBezeled(false);\n\tlabel.setDrawsBackground(false);\n\tlabel.setEditable(false);\n\tlabel.setSelectable(false);\n\n\treturn label;\n}\n\nexport function createNotSelectableInput(text,size,frame) {\n\tvar label = NSTextField.alloc().initWithFrame(frame);\n\n\tlabel.setStringValue(text);\n\tlabel.setFont(NSFont.systemFontOfSize(size));\n\tlabel.setBezeled(false);\n\tlabel.setEditable(false);\n\tlabel.setSelectable(false);\n\n\treturn label;\n}\nexport function createLabel(text,size,frame) {\n\tvar label = NSTextField.alloc().initWithFrame(frame);\n\n\tlabel.setStringValue(text);\n\tlabel.setFont(NSFont.systemFontOfSize(size));\n\tlabel.setBezeled(false);\n\tlabel.setDrawsBackground(false);\n\tlabel.setEditable(false);\n\tlabel.setSelectable(false);\n\n\treturn label;\n}\n\nexport function createCheckbox(item,flag,frame) {\n\tvar checkbox = NSButton.alloc().initWithFrame(frame),\n\t\tflag = (flag == false) ? NSOffState : NSOnState;\n\n\tcheckbox.setButtonType(NSSwitchButton);\n\tcheckbox.setBezelStyle(0);\n\tcheckbox.setTitle(item.name);\n\tcheckbox.setTag(item.value);\n\tcheckbox.setState(flag);\n\n\treturn checkbox;\n}\n\nexport function createColoredBlock(color, frame, darkmode) {\n\tvar block = NSView.alloc().initWithFrame(frame);\n\n    block.setWantsLayer(1);\n    if(darkmode){\n      var color_rgb=DarkMode(color,\"Shape\"); \n\n    }else{\n       var color_rgb=hexToRgba(color); \n\n    }\n   //console.log(color_rgb);\n    //console.log(color_rgb);\n    block.layer().cornerRadius = 2;\n    block.layer().maskedCorners=true;\n\t  block.layer().setBackgroundColor(CGColorCreateGenericRGB(color_rgb.r/255,color_rgb.g/255,color_rgb.b/255,color_rgb.a/255));\n    \n    return block;\n    //NSRectFill\n}\n\nexport function changeColoredBlock(block, color) {\n    var color_rgb=hexToRgba(color); \n\t  block.layer().setBackgroundColor(CGColorCreateGenericRGB(color_rgb.r/255,color_rgb.g/255,color_rgb.b/255,color_rgb.a/255));\n}\n\n\nexport function DarkMode(hex, element){\n   // var hex = h.substr(0, 7);\n   var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex.substr(0, 7));\n   if(hex.length>7){\n     var alpha = parseInt(hex.slice(7, 9), 16);\n   }else{\n     var alpha=255;\n   }\n   var r=  parseInt(result[1], 16);\n   var g=  parseInt(result[2], 16);\n   var b=  parseInt(result[3], 16);\n   var gray_middle=127;\n\n\n   // IF IS MONOTONE\n   if( Math.abs(r-g)<50 && Math.abs(r-b)<50){\n    var lightness= (r * 0.299 + g * 0.587 + b * 0.114);\n    if (lightness > gray_middle){\n      //console.log(\"is light\"+lightness);\n      //(lightness* -100)/255\n      if(element==\"container\"){\n        var darkmode= RGBToHSL(\"rgb(255,255,255)\", \"container\", \"light\");\n      }else if(element==\"in_colored_container\"){\n        var darkmode= RGBToHSL(\"rgb(5,5,5)\", \"text\", \"dark\");\n      }else if(element==\"Shape\"){\n        var darkmode= RGBToHSL(\"rgb(\"+r+\",\"+g+\",\"+b+\")\", \"container\", \"light\");\n      }else{\n        var darkmode= RGBToHSL(\"rgb(\"+r+\",\"+g+\",\"+b+\")\", \"text\" ,\"light\");\n      }\n\n    }else{\n      if(element==\"container\"){\n        var darkmode= RGBToHSL(\"rgb(255,255,255)\", \"container\", \"light\");\n      }else if(element==\"in_colored_container\"){\n        var darkmode= RGBToHSL(\"rgb(5,5,5)\", \"text\", \"dark\");\n      } else if(element==\"Shape\"){\n        var darkmode= RGBToHSL(\"rgb(\"+r+\",\"+g+\",\"+b+\")\", \"container\", \"dark\");\n      }else{\n        //180- (90+((lightness* 100)/gray_middle));\n        var darkmode= RGBToHSL(\"rgb(\"+r+\",\"+g+\",\"+b+\")\", \"text\", \"dark\" );\n      }\n\n    }\n    var darkmode_rgb= HSLToRGB(darkmode, false);\n\n  //IF IS COLOR\n  }else{\n      //console.log(\"ITS COLORED\");\n      //console.log(element);\n\n    //console.log(\"original rgb(\"+r+\",\"+g+\",\"+b+\")\");\n    //var darkmode = RGBToHSL(\"rgb(\" + r + \",\" + g + \",\" + b + \")\", 0, -50);\n    if(element==\"container\"){\n      var darkmode= RGBToHSL(\"rgb(255,255,255)\", \"container\", \"light\");\n    }else if(element==\"Shape\" || element==\"in_colored_container\"){\n      var darkmode= RGBToHSL(\"rgb(\"+r+\",\"+g+\",\"+b+\")\", \"container\", \"color\");\n    }else{\n      var darkmode= RGBToHSL(\"rgb(\"+r+\",\"+g+\",\"+b+\")\", \"text\", \"color\");\n    }\n    var darkmode_rgb= HSLToRGB(darkmode, false);\n\n  }\n  //console.log(\"---------------------\");\n    return result ? {\n      r: darkmode_rgb.r,\n      g: darkmode_rgb.g,\n      b: darkmode_rgb.b,\n      a: alpha\n    } : null;\n\n    \n}\nexport function RGBToHex(rgb) {\n  let ex = /^rgb\\((((((((1?[1-9]?\\d)|10\\d|(2[0-4]\\d)|25[0-5]),\\s?)){2}|((((1?[1-9]?\\d)|10\\d|(2[0-4]\\d)|25[0-5])\\s)){2})((1?[1-9]?\\d)|10\\d|(2[0-4]\\d)|25[0-5]))|((((([1-9]?\\d(\\.\\d+)?)|100|(\\.\\d+))%,\\s?){2}|((([1-9]?\\d(\\.\\d+)?)|100|(\\.\\d+))%\\s){2})(([1-9]?\\d(\\.\\d+)?)|100|(\\.\\d+))%))\\)$/i;\n  if (ex.test(rgb)) {\n      // choose correct separator\n      let sep = rgb.indexOf(\",\") > -1 ? \",\" : \" \";\n      // turn \"rgb(r,g,b)\" into [r,g,b]\n      rgb = rgb.substr(4).split(\")\")[0].split(sep);\n\n      // convert %s to 0255\n      for (let R in rgb) {\n          let r = rgb[R];\n          if (r.indexOf(\"%\") > -1)\n              rgb[R] = Math.round(r.substr(0,r.length - 1) / 100 * 255);\n              /* Example:\n              75% -> 191\n              75/100 = 0.75, * 255 = 191.25 -> 191\n              */\n      }\n\n      let r = (+rgb[0]).toString(16),\n          g = (+rgb[1]).toString(16),\n          b = (+rgb[2]).toString(16);\n\n      if (r.length == 1)\n          r = \"0\" + r;\n      if (g.length == 1)\n          g = \"0\" + g;\n      if (b.length == 1)\n          b = \"0\" + b;\n      \n      return \"#\" + r + g + b;\n\n  } else {\n      return \"Invalid input color\";\n  }\n}\n\nfunction HSLToRGB(hsl,isPct) {\n  let ex = /^hsl\\(((((([12]?[1-9]?\\d)|[12]0\\d|(3[0-5]\\d))(\\.\\d+)?)|(\\.\\d+))(deg)?|(0|0?\\.\\d+)turn|(([0-6](\\.\\d+)?)|(\\.\\d+))rad)((,\\s?(([1-9]?\\d(\\.\\d+)?)|100|(\\.\\d+))%){2}|(\\s(([1-9]?\\d(\\.\\d+)?)|100|(\\.\\d+))%){2})\\)$/i;\n  if (ex.test(hsl)) {\n    \n      let sep = hsl.indexOf(\",\") > -1 ? \",\" : \" \";\n      hsl = hsl.substr(4).split(\")\")[0].split(sep);\n      isPct = isPct === true;\n\n      let h = hsl[0],\n          s = hsl[1].substr(0,hsl[1].length - 1) / 100,\n          l = hsl[2].substr(0,hsl[2].length - 1) / 100;\n\n      // strip label and convert to degrees (if necessary)\n      if (h.indexOf(\"deg\") > -1)\n          h = h.substr(0,h.length - 3);\n      else if (h.indexOf(\"rad\") > -1)\n          h = Math.round(h.substr(0,h.length - 3) / (2 * Math.PI) * 360);\n      else if (h.indexOf(\"turn\") > -1)\n          h = Math.round(h.substr(0,h.length - 4) * 360);\n      // keep hue fraction of 360 if ending up over\n      if (h >= 360)\n          h %= 360;\n      \n      let c = (1 - Math.abs(2 * l - 1)) * s,\n          x = c * (1 - Math.abs((h / 60) % 2 - 1)),\n          m = l - c/2,\n          r = 0,\n          g = 0,\n          b = 0;\n      \n      if (0 <= h && h < 60) {\n          r = c; g = x; b = 0;\n      } else if (60 <= h && h < 120) {\n          r = x; g = c; b = 0;\n      } else if (120 <= h && h < 180) {\n          r = 0; g = c; b = x;\n      } else if (180 <= h && h < 240) {\n          r = 0; g = x; b = c;\n      } else if (240 <= h && h < 300) {\n          r = x; g = 0; b = c;\n      } else if (300 <= h && h < 360) {\n          r = c; g = 0; b = x;\n      }\n\n      r = Math.round((r + m) * 255);\n      g = Math.round((g + m) * 255);\n      b = Math.round((b + m) * 255);\n      return{\n        r: r,\n        g: g,\n        b: b\n      } ;\n\n  } else {\n      return \"Invalid input color\";\n  }\n}\n\nfunction RGBToHSL(rgb,  type, mode) {\n  let ex = /^rgb\\((((((((1?[1-9]?\\d)|10\\d|(2[0-4]\\d)|25[0-5]),\\s?)){2}|((((1?[1-9]?\\d)|10\\d|(2[0-4]\\d)|25[0-5])\\s)){2})((1?[1-9]?\\d)|10\\d|(2[0-4]\\d)|25[0-5]))|((((([1-9]?\\d(\\.\\d+)?)|100|(\\.\\d+))%,\\s?){2}|((([1-9]?\\d(\\.\\d+)?)|100|(\\.\\d+))%\\s){2})(([1-9]?\\d(\\.\\d+)?)|100|(\\.\\d+))%))\\)$/i;\n  if (ex.test(rgb)) {\n      let sep = rgb.indexOf(\",\") > -1 ? \",\" : \" \";\n      rgb = rgb.substr(4).split(\")\")[0].split(sep);\n      \n      // convert %s to 0255\n      for (let R in rgb) {\n          let r = rgb[R];\n          if (r.indexOf(\"%\") > -1)\n              rgb[R] = Math.round(r.substr(0,r.length - 1) / 100 * 255);\n      }\n\n      // make r, g, and b fractions of 1\n      let r = rgb[0] / 255,\n          g = rgb[1] / 255,\n          b = rgb[2] / 255,\n\n      // find greatest and smallest channel values\n          cmin = Math.min(r,g,b),\n          cmax = Math.max(r,g,b),\n          delta = cmax - cmin,\n          h = 0,\n          s = 0,\n          l = 0;\n\n      // calculate hue\n      // no difference\n      if (delta == 0)\n          h = 0;\n      // red is max\n      else if (cmax == r)\n          h = ((g - b) / delta) % 6;\n      // green is max\n      else if (cmax == g)\n          h = (b - r) / delta + 2;\n      // blue is max\n      else\n          h = (r - g) / delta + 4;\n\n      h = Math.round(h * 60);\n\n      // make negative hues positive behind 360\n      if (h < 0)\n          h += 360;\n\n      // calculate lightness\n      l = (cmax + cmin) / 2;\n\n      // calculate saturation\n      s = delta == 0 ? 0 : delta / (1 - Math.abs(2 * l - 1));\n\n      // multiply l and s by 100\n      s = +(s * 100).toFixed(1);\n      l = +(l * 100).toFixed(1);\n      \n\n\n      if(mode==\"light\"){\n        if(type==\"container\"){\n          \n          var x = 100-l;\n          var a=10;\n          var c=2;\n          var bi=0.96;\n          var y= a*(Math.pow(bi, x))+c;\n          l=y;\n\n          //l = 100-l;\n\n        }else{\n          l = 100-l;\n\n        }\n        //(lightness* -100)/255\n      }else if(mode==\"dark\"){\n       \n        if(type==\"text\"){\n          var x = 100-l;\n          var a=10;\n          var c=5;\n          var bi=0.96;\n          var y= a*(Math.pow(bi, x))+c;\n          l=100-y;\n\n          //l = 100-l;\n\n        }else{\n          l = 100-l;\n        }\n\n      }else{\n\n        //dont exced limits\n        var s_color= -50;\n        var transformed_color= s+s_color;\n        if(transformed_color>=100){\n          s=100;\n        }else if(transformed_color<=0){\n          s=0;\n        }else{\n          s+=s_color;\n        }\n        s=75;\n        l=65;\n        \n      }\n      //l_darkmode, s_color,\n      if(l>100){\n        var lu= 100;\n      }else{\n        var lu= l;\n\n      }\n\n     // console.log(\"transformed hsl(\" + h + \",\" + s + \"%,\" + lu + \"%)\");\n      return \"hsl(\" + h + \",\" + s + \"%,\" + lu + \"%)\";\n\n  } else {\n      return \"Invalid input color\";\n  }\n}\n\n\n\n\nfunction HSLToHex(hsl) {\n  let ex = /^hsl\\(((((([12]?[1-9]?\\d)|[12]0\\d|(3[0-5]\\d))(\\.\\d+)?)|(\\.\\d+))(deg)?|(0|0?\\.\\d+)turn|(([0-6](\\.\\d+)?)|(\\.\\d+))rad)((,\\s?(([1-9]?\\d(\\.\\d+)?)|100|(\\.\\d+))%){2}|(\\s(([1-9]?\\d(\\.\\d+)?)|100|(\\.\\d+))%){2})\\)$/i;\n  if (ex.test(hsl)) {\n      let sep = hsl.indexOf(\",\") > -1 ? \",\" : \" \";\n      hsl = hsl.substr(4).split(\")\")[0].split(sep);\n\n      let h = hsl[0],\n          s = hsl[1].substr(0,hsl[1].length - 1) / 100,\n          l = hsl[2].substr(0,hsl[2].length - 1) / 100;\n  \n      // strip label and convert to degrees (if necessary)\n      if (h.indexOf(\"deg\") > -1)\n          h = h.substr(0,h.length - 3);\n      else if (h.indexOf(\"rad\") > -1)\n          h = Math.round(h.substr(0,h.length - 3) * (180 / Math.PI));\n      else if (h.indexOf(\"turn\") > -1)\n          h = Math.round(h.substr(0,h.length - 4) * 360);\n      if (h >= 360)\n          h %= 360;\n      \n      let c = (1 - Math.abs(2 * l - 1)) * s,\n          x = c * (1 - Math.abs((h / 60) % 2 - 1)),\n          m = l - c/2,\n          r = 0,\n          g = 0,\n          b = 0;\n      \n      if (0 <= h && h < 60) {\n          r = c; g = x; b = 0;\n      } else if (60 <= h && h < 120) {\n          r = x; g = c; b = 0;\n      } else if (120 <= h && h < 180) {\n          r = 0; g = c; b = x;\n      } else if (180 <= h && h < 240) {\n          r = 0; g = x; b = c;\n      } else if (240 <= h && h < 300) {\n          r = x; g = 0; b = c;\n      } else if (300 <= h && h < 360) {\n          r = c; g = 0; b = x;\n      }\n      // having obtained RGB, convert channels to hex\n      r = Math.round((r + m) * 255).toString(16);\n      g = Math.round((g + m) * 255).toString(16);\n      b = Math.round((b + m) * 255).toString(16);\n      \n      // prepend 0s if necessary\n      if (r.length == 1)\n          r = \"0\" + r;\n      if (g.length == 1)\n          g = \"0\" + g;\n      if (b.length == 1)\n          b = \"0\" + b;\n      \n      return \"#\" + r + g + b;\n\n  } else {\n      return \"Invalid input color\";\n  }\n}\n\nfunction hexToRgba(hex) {\n\n   // var hex = h.substr(0, 7);\n    var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex.substr(0, 7));\n    if(hex.length>7){\n      var alpha = parseInt(hex.slice(7, 9), 16);\n    }else{\n      var alpha=255;\n    }\n\n    return result ? {\n      r: parseInt(result[1], 16),\n      g: parseInt(result[2], 16),\n      b: parseInt(result[3], 16),\n      a: alpha\n    } : null;\n\n  }\nexport function createDivider(frame) {\n\tvar divider = NSView.alloc().initWithFrame(frame);\n\n\tdivider.setWantsLayer(1);\n\tdivider.layer().setBackgroundColor(CGColorCreateGenericRGB(204/255,204/255,204/255,1.0));\n\n\treturn divider;\n}\nexport function createField(value,frame) {\n\tvar field = NSTextField.alloc().initWithFrame(frame);\n\n\tfield.setStringValue(value);\n    field.delegate = self\n\n\treturn field;\n}\nexport function createFieldnoBack(value,frame) {\n\tvar field = NSTextField.alloc().initWithFrame(frame);\n\n    field.setStringValue(value);\n    field.setDrawsBackground(false);\n    field.delegate = self\n\n\treturn field;\n}\nexport function createFieldControl(value,frame) {\n\tvar field = NSControl.alloc().initWithFrame(frame);\n\n\tfield.setStringValue(value);\n    field.delegate = self\n\n\treturn field;\n}\nexport function setKeyOrder(alert,order) {\n\tfor (var i = 0; i < order.length; i++) {\n\t\tvar thisItem = order[i],\n\t\t\tnextItem = order[i+1];\n\n\t\tif (nextItem) thisItem.setNextKeyView(nextItem);\n\t}\n\n\talert.window().setInitialFirstResponder(order[0]);\n}\n\nexport function validateColorInput( code_array, name_array, add){  \n    \n    var validated_array=[];\n    if(add){\n      var a_length=code_array.length;\n    }else{\n      var a_length=code_array.length-1;\n\n    }\n    for(var i=0; i<a_length ; i++){\n        var count_repeated=0;\n        var code= code_array[i].stringValue();\n/*\n        for(var j=0; j<validated_array.length; j++){\n          if(code==validated_array[j]){\n            count_repeated++;\n            break;\n\n          }\n        }\n        */\n\n        if(count_repeated==0){\n          if(/^#[0-9A-F]{8}$/i.test(code) || /^#[0-9A-F]{6}$/i.test(code)){\n              validated_array.push({\"name\":name_array[i].stringValue() , \"code\":code_array[i].stringValue() });\n\n          }\n        }\n    }\n   \n    return validated_array;\n}\n\n\nexport function OrganizeArrayTextStyles(styles){\n    var array=[];\n    var cur_style, cur_style_name;\n\n    for(var i=0; i<styles.length; i++){\n      \n      var style_fontSize= styles[i].style.fontSize;\n      var style_name= styles[i].name;\n\n      if(style_name.indexOf(\"/\") !== -1){\n        var style_name_array= style_name.split(\"/\");\n        var s_name= style_name_array[0];\n\n      }else{\n        var s_name= style_name;\n\n\n      }\n        if(array.length==0){\n            array.push({\"group\": s_name ,\"styles\": [styles[i]], \"group_size\":style_fontSize});\n            cur_style_name=s_name;\n\n        }else{\n          var has_group=false;\n          var has_group_id=0;\n          for(var j=0; j<array.length; j++){\n            if(s_name==array[j].group){\n              has_group=true;\n              has_group_id=j;\n              break;\n            }\n          }\n          if(has_group){\n            array[has_group_id].styles.push( styles[i]);\n\n          }else{\n            array.push({\"group\": s_name ,\"styles\": [styles[i]], \"group_size\":style_fontSize});\n            cur_style_name=s_name;\n\n          }\n        }\n\n      }\n    \n    return array;\n}\n\n\n\n\nfunction updateElementStyle(element, style){\n  element.sharedStyleId=style.id;\n  element.sharedStyle=style;\n  element.style=style.style;\n  element.style.syncWithSharedStyle(style);\n\n}\n\nfunction addNewStyle(document,element ,style_type, style, added, styles){\n  var this_name= \"DarkModeSystem/\"+element+\"-\"+added+\"/lightMode\";\n  styles.push({\n    name: this_name,\n    style: style,\n    styleType: style_type,\n    document: document\n  })\n  return styles;\n}\n\nfunction getLayerArtboard(p){\n  var parent_top=p;\n  var artboar_id=p.id;\n  if(parent_top.parent.type!=\"Page\"){\n    \n    while(parent_top.type!=\"Artboard\" && parent_top.type!=\"SymbolMaster\"  && parent_top.type!=\"Page\" ){\n\n      parent_top= parent_top.parent;\n      artboar_id= parent_top.id;\n    }\n  }\n  return artboar_id;\n\n}\nexport function reviewSettings( document , all_settings){\n  console.log(\"Step 0 - Reviewing Settings...\");\n  //console.log(all_settings);\n  var reviewed_settings=[]\n  for(var i=0; i<all_settings.length; i++){\n    var dark_id= all_settings[i].dark;\n    var light_id= all_settings[i].light;\n\n    if(all_settings[i].type==\"text\"){\n      var sharedStyle_light = document.getSharedTextStyleWithID(light_id)\n      var sharedStyle_dark = document.getSharedTextStyleWithID(dark_id)\n    }else{\n      var sharedStyle_light = document.getSharedLayerStyleWithID(light_id)\n      var sharedStyle_dark = document.getSharedLayerStyleWithID(dark_id)\n    }\n      //console.log(sharedStyle_dark);\n      //console.log(sharedStyle_light);\n\n    if(sharedStyle_light===undefined || sharedStyle_dark===undefined){\n     // console.log(\"there is one settings missing\");\n    }else{\n      reviewed_settings.push(all_settings[i]);\n    }\n\n  }\n  return reviewed_settings;\n  \n}\n\nexport function syncLayerwithStyles_best(Settings, sketch, document, page){\n  //var all_layer= sketch.find('*', document.pages[page]);\n  var all_shapes= sketch.find('Shape', document.pages[page]);\n  var all_shapesPaths= sketch.find('ShapePath', document.pages[page]);\n  var all_texts= sketch.find('Text', document.pages[page]);\n\n  var layer_styles = document.sharedLayerStyles;\n  var text_styles = document.sharedTextStyles;\n  var count_added=document.sharedLayerStyles.length+document.sharedTextStyles.length;\n\n\n  var all_settings= Settings.documentSettingForKey(document,'Styles');\n  var all_settings_c= Settings.documentSettingForKey(document,'Styles_Containers');\n  var all_settings_l= Settings.documentSettingForKey(document,'Styles_Layers');\n  var all_settings_t= Settings.documentSettingForKey(document,'Styles_Texts');\n\n  console.log(\"initial styles\"+count_added);\n  console.log(\"Step 1 - Validating...\");\n  \n  var count=0;\n  var colored_containers=[];\n  var new_styles=[];\n  var percentage=0;\n  var count_shapePath_added=0;\n\n  var container_min_width=200;\n  var container_min_height=200;\n\n\n  var count_c= all_settings_c.length;\n  var count_l= all_settings_l.length;\n  var count_t= all_settings_t.length;\n\n  // DO CONTAINERS\n  var percentage=0;\n  var count_container_added=count_c;\n  for(var i=0; i<all_shapesPaths.length;i++ ){\n    if(all_shapesPaths[i].frame.width>container_min_width && all_shapesPaths[i].frame.height>container_min_height  && all_shapesPaths[i].shapeType==\"Rectangle\"){\n      count++;\n      if(percentage != parseInt(i*100 /all_shapesPaths.length)){\n        console.log(\"Containers 1 - \"+percentage+\"%\");\n        percentage = parseInt(i*100 /all_shapesPaths.length);\n      }\n\n      var count_fills=0;\n      for (var s=0; s<all_shapesPaths[i].style.fills.length; s++){\n        if(all_shapesPaths[i].style.fills[s].enabled==true){\n          var color= all_shapesPaths[i].style.fills[s].color;\n          break;\n        }\n      }\n      var color_rgb= hexToRgba(color);\n      if( Math.abs(color_rgb.r-color_rgb.g)<50 && Math.abs(color_rgb.r-color_rgb.b)<50){\n        var container= \"container_monotone\";\n\n      }else{\n      var container= \"container_color\";\n\n      }\n      //Processing layers and its shared styles \n      var hasStyle= elementHasStyle (layer_styles, all_shapesPaths[i].sharedStyleId) ;\n      var isOutOfSync = true;\n      if(hasStyle!=false){\n        isOutOfSync = all_shapesPaths[i].style.isOutOfSyncWithSharedStyle(hasStyle);\n      }\n      var is_inside_colored_container= false;\n\n     if(!hasStyle || hasStyle && isOutOfSync ){\n      \n       var hasMatchingStyle= elementHasMatchingStyleAndSetting(document,layer_styles, all_shapesPaths[i].style, all_settings_c, all_settings_l, all_settings_t, undefined, [\"layer\",\"layer\",\"text\"]);\n       //var hasMatchingStyle= elementHasMatchingStyle(layer_styles, all_shapesPaths[i].style);\n\n       // get setting with macthcing style\n       var hasmach_butnot=false;\n        if(hasMatchingStyle){\n          for (var n=0; n<all_settings_c.length; n++){\n            if(all_settings_c[n].light==hasMatchingStyle.id){\n              if(all_settings_c[n].element != container){\n                hasmach_butnot_setting=true;\n                break;\n              }else{\n                break;\n              }\n            }\n          }\n        }\n       if(!hasMatchingStyle || hasmach_butnot){\n         //create new style\n         count_container_added++;\n         layer_styles= addNewStyle(document,\"Contsainer\",\"Layer\", all_shapesPaths[i].style, count_container_added,layer_styles) ;\n \n         //update element\n         var last =layer_styles.length-1;\n         updateElementStyle(all_shapesPaths[i], layer_styles[last]);\n\n         //Create new setting\n         var element_size=all_shapesPaths[i].frame;     \n         var layer_artboard= getLayerArtboard(all_shapesPaths[i]);\n         if(container== \"container_color\"){\n           var frame_absolute= getFrameAbsoluteFrame(all_shapesPaths[i]);\n           var this_frame= { \"x\":frame_absolute.x, \"y\": frame_absolute.y, \"width\": all_shapesPaths[i].frame.width, \"height\":all_shapesPaths[i].frame.height};\n           colored_containers.push({\"artboard\": layer_artboard, \"container\":this_frame});  \n         }\n         //console.log(\"COLORED CONTAINER!!!\"); \n          \n         new_styles.push({\"action\":\"new\",\"type\": \"layer\",\"element\":container, \"id\":layer_styles[last].id});\n \n       }else{\n         //update element\n         updateElementStyle(all_shapesPaths[i], hasMatchingStyle);\n\n        //add setting if it doesn't exist\n        var element_size=all_shapesPaths[i].frame;\n        var layer_artboard= getLayerArtboard(all_shapesPaths[i]);\n        if(container== \"container_color\"){\n          var frame_absolute= getFrameAbsoluteFrame(all_shapesPaths[i]);\n          var this_frame= { \"x\":frame_absolute.x, \"y\": frame_absolute.y, \"width\": all_shapesPaths[i].frame.width, \"height\":all_shapesPaths[i].frame.height};\n          colored_containers.push({\"artboard\": layer_artboard, \"container\":this_frame}); \n        }\n        //console.log(\"COLORED CONTAINER!!!\"); \n    \n         var hasSettings=ifStylesavedInSettings(document, all_settings_c,new_styles, hasMatchingStyle.id, \"layer\");\n         if(!hasSettings){\n          new_styles.push({\"action\":\"link\", \"type\": \"layer\",\"element\":container, \"id\":hasMatchingStyle.id});\n         }\n       }\n     //has synced style\n     }else{\n       //update element\n       updateElementStyle(all_shapesPaths[i], hasStyle);\n\n      //add setting if it doesn't exist\n      var element_size=all_shapesPaths[i].frame;\n      var layer_artboard= getLayerArtboard(all_shapesPaths[i]);\n      if(container== \"container_color\"){\n        var frame_absolute= getFrameAbsoluteFrame(all_shapesPaths[i]);\n        var this_frame= { \"x\":frame_absolute.x, \"y\": frame_absolute.y, \"width\": all_shapesPaths[i].frame.width, \"height\":all_shapesPaths[i].frame.height};\n        colored_containers.push({\"artboard\": layer_artboard, \"container\":this_frame});\n      }\n      //console.log(\"COLORED CONTAINER!!!\"); \n       \n      var hasSettings=ifStylesavedInSettings(document, all_settings_c,new_styles, hasStyle.id, \"layer\");\n      if(!hasSettings){\n        new_styles.push({\"action\":\"save_setting\", \"type\": \"layer\",\"element\":container, \"id\":hasStyle.id});\n        }\n      }\n    }\n  }\n\n\n  var count_shapePath_added=count_l;\n  // DO SHAPES PATHS\n  for(var i=0; i<all_shapesPaths.length;i++ ){\n    if(all_shapesPaths[i].frame.width<container_min_width || all_shapesPaths[i].frame.height<container_min_height  || all_shapesPaths[i].shapeType!=\"Rectangle\"){\n    count++;\n    if(percentage != parseInt(i*100 /all_shapesPaths.length)){\n      console.log(\"Shapes paths 1 - \"+percentage+\"%\");\n      percentage = parseInt(i*100 /all_shapesPaths.length);\n    }\n    var count_fills=0;\n    for (var s=0; s<all_shapesPaths[i].style.fills.length; s++){\n      if(all_shapesPaths[i].style.fills[s].enabled==true){\n        count_fills++;\n        break;\n      }\n    }\n    \n    var element_size=\"small\";\n\n     //Processing layers and its shared styles \n     var hasStyle= elementHasStyle (layer_styles, all_shapesPaths[i].sharedStyleId) ;\n     var isOutOfSync = true;\n     if(hasStyle!=false){\n       isOutOfSync = all_shapesPaths[i].style.isOutOfSyncWithSharedStyle(hasStyle);\n     }\n     var is_inside_colored_container= TextinsideColoredContainer(all_shapesPaths[i], colored_containers);\n\n     if(!hasStyle || hasStyle && isOutOfSync ){\n       //var hasMatchingStyle= elementHasMatchingStyle(layer_styles, all_shapesPaths[i].style);\n       var hasMatchingStyle= elementHasMatchingStyleAndSetting(document,layer_styles, all_shapesPaths[i].style, all_settings_l, all_settings_c, all_settings_t, is_inside_colored_container, [\"layer\",\"layer\",\"text\"]);\n\n       // is has matching style but one is hover a colored container and the other is not\n       var hasmach_butnot=false;\n        if(hasMatchingStyle){\n          for (var n=0; n<new_styles.length; n++){\n            if(new_styles[n].id==hasMatchingStyle.id ){\n              if(new_styles[n].colored_container != is_inside_colored_container){\n                hasmach_butnot=true;\n                break;\n              }else{\n                break;\n              }\n\n            }\n          }\n        }\n        \n       if(!hasMatchingStyle || hasmach_butnot ){\n         //create new style\n         count_shapePath_added++;\n         layer_styles= addNewStyle(document,\"ShapePath\",\"Layer\", all_shapesPaths[i].style, count_shapePath_added,layer_styles) ;\n \n         //update element\n         var last =layer_styles.length-1;\n         updateElementStyle(all_shapesPaths[i], layer_styles[last]);\n\n         //Create new setting\n         new_styles.push({\"action\":\"new\",\"type\": \"layer\",\"colored_container\":is_inside_colored_container,\"element\":element_size, \"id\":layer_styles[last].id, \"layerName\": all_shapesPaths[i].name});\n \n       }else{\n         //update element\n         updateElementStyle(all_shapesPaths[i], hasMatchingStyle);\n\n         //add setting if it doesn't exist\n         var hasSettings=ifStylesavedInSettings(document, all_settings_l,new_styles, hasMatchingStyle.id, \"layer\");\n         if(!hasSettings){\n           new_styles.push({\"action\":\"link\", \"type\": \"layer\",\"colored_container\":is_inside_colored_container,\"element\":element_size, \"id\":hasMatchingStyle.id, \"layerName\": all_shapesPaths[i].name});\n         }\n       }\n     //has synced style\n     }else{\n       //update element\n       updateElementStyle(all_shapesPaths[i], hasStyle);\n\n      //add setting if it doesn't exist\n      var hasSettings=ifStylesavedInSettings(document, all_settings_l,new_styles, hasStyle.id, \"layer\");\n      if(!hasSettings){\n        new_styles.push({\"action\":\"save_setting\", \"type\": \"layer\",\"colored_container\":is_inside_colored_container,\"element\": element_size, \"id\":hasStyle.id, \"layerName\": all_shapesPaths[i].name});\n \n      }\n    }\n  }\n}\n\n  //DO SHAPES\n  var percentage=0;\n  var count_shape_added=count_shapePath_added;\n  for(var i=0; i<all_shapes.length;i++ ){\n    count++;\n    //progress\n    if(percentage != parseInt(i*100 /all_shapes.length)){\n      console.log(\"Shapes 1 - \"+percentage+\"%\");\n      percentage = parseInt(i*100 /all_shapes.length);\n    }\n    var element_size=\"small\";\n\n    //Processing layers and its shared styles \n    var hasStyle= elementHasStyle (layer_styles, all_shapes[i].sharedStyleId) ;\n    var isOutOfSync = true;\n    if(hasStyle!=false){\n      isOutOfSync = all_shapes[i].style.isOutOfSyncWithSharedStyle(hasStyle);\n    }\n    var is_inside_colored_container= TextinsideColoredContainer(all_shapes[i], colored_containers);\n\n    if(!hasStyle || hasStyle && isOutOfSync ){\n      //var hasMatchingStyle= elementHasMatchingStyle(layer_styles, all_shapes[i].style);\n      var hasMatchingStyle= elementHasMatchingStyleAndSetting(document,layer_styles, all_shapes[i].style, all_settings_l, all_settings_c, all_settings_t, is_inside_colored_container, [\"layer\",\"layer\",\"text\"]);\n\n       // is has matching style but one is hover a colored container and the other is not\n       var hasmach_butnot=false;\n        if(hasMatchingStyle){\n          for (var n=0; n<new_styles.length; n++){\n            if(new_styles[n].id==hasMatchingStyle.id ){\n              if(new_styles[n].colored_container != is_inside_colored_container){\n                hasmach_butnot=true;\n                break;\n              }else{\n                break;\n              }\n\n            }\n            \n            \n          }\n        }\n       if(!hasMatchingStyle || hasmach_butnot ){\n        //create new style\n        count_shape_added++;\n        layer_styles= addNewStyle(document,\"Shape\",\"Layer\", all_shapes[i].style, count_shape_added, layer_styles) ;\n\n        //update element\n        var last =layer_styles.length-1;\n        updateElementStyle(all_shapes[i], layer_styles[last]);\n\n        //Create new setting\n        new_styles.push({\"action\":\"new\",\"type\": \"layer\",\"colored_container\":is_inside_colored_container, \"element\": element_size, \"id\":layer_styles[last].id, \"layerName\": all_shapes[i].name});\n\n      }else{\n        //update element\n        updateElementStyle(all_shapes[i], hasMatchingStyle);\n\n        //add setting if it doesn't exist\n        var hasSettings=ifStylesavedInSettings(document, all_settings_l,new_styles, hasMatchingStyle.id, \"layer\");\n        if(!hasSettings){\n          new_styles.push({\"action\":\"link\", \"type\": \"layer\",\"colored_container\":is_inside_colored_container, \"element\": element_size, \"id\":hasMatchingStyle.id, \"layerName\": all_shapes[i].name});\n        }\n      }\n    //has synced style\n    }else{\n      //update element\n      updateElementStyle(all_shapes[i], hasStyle);\n\n      //add setting if it doesn't exist\n      var hasSettings=ifStylesavedInSettings(document, all_settings_l,new_styles, hasStyle.id, \"layer\");\n      if(!hasSettings){\n        new_styles.push({\"action\":\"save_setting\", \"type\": \"layer\", \"colored_container\":is_inside_colored_container, \"element\":element_size, \"id\":hasStyle.id, \"layerName\": all_shapes[i].name});\n\n      }\n    }\n  }\n\n  \n  //DO TEXTS\n  var percentage=0;\n  var count_text_added=count_t;\n  for(var i=0; i<all_texts.length;i++ ){\n    count++;\n    if(percentage != parseInt(i*100 /all_texts.length)){\n      console.log(\"Texts 1 - \"+percentage+\"%\");\n      percentage = parseInt(i*100 /all_texts.length);\n\n    }\n    //Processing layers and its shared styles \n    var hasStyle= elementHasStyle (text_styles, all_texts[i].sharedStyleId) ;\n    var isOutOfSync = true;\n    if(hasStyle!=false){\n      isOutOfSync = all_texts[i].style.isOutOfSyncWithSharedStyle(hasStyle);\n    }\n    var is_inside_colored_container= TextinsideColoredContainer(all_texts[i], colored_containers);\n\n    if(!hasStyle || hasStyle && isOutOfSync ){\n      //var hasMatchingStyle= elementHasMatchingStyle(text_styles, all_texts[i].style); \n      var hasMatchingStyle= elementHasMatchingStyleAndSetting(document,text_styles, all_texts[i].style, all_settings_t, all_settings_c, all_settings_l, is_inside_colored_container, [\"text\",\"layer\",\"layer\"]);\n\n      // is has matching style but one is hover a colored container and the other is not\n      var hasmach_butnot=false;\n      var hasmach_butnot_setting=false;\n\n      //if matching style founf is in new styles\n      if(hasMatchingStyle){\n        for (var n=0; n<new_styles.length; n++){\n          if(new_styles[n].id==hasMatchingStyle.id ){\n            if(new_styles[n].colored_container != is_inside_colored_container){\n              hasmach_butnot=true;\n              break;\n            }else{\n              break;\n            }\n\n          }\n        }\n      }\n      var hasmach_butnot_setting=false;\n      if(hasMatchingStyle && !hasmach_butnot){\n        for (var n=0; n<all_settings_t.length; n++){\n          if(all_settings_t[n].light==hasMatchingStyle.id){\n            if(all_settings_t[n].element != \"text\"){\n              hasmach_butnot_setting=true;\n              break;\n            }else{\n              break;\n            }\n\n          }\n         \n        }\n      }\n     if(!hasMatchingStyle || hasmach_butnot || hasmach_butnot_setting){  \n        //create new style\n        count_text_added++;\n        var layerName;\n        if( all_texts[i].style.fontSize<13){\n          layerName= \"Text-Small\";\n        }else if( all_texts[i].style.fontSize<16){\n          layerName= \"Text-Body\";\n        }else{\n          layerName= \"Text-Heading\";\n        }\n        text_styles= addNewStyle(document,layerName,\"Text\", all_texts[i].style, count_text_added,text_styles) ;\n\n        //update element\n        var last =text_styles.length-1;\n        updateElementStyle(all_texts[i], text_styles[last]);\n\n        //Create new setting\n        new_styles.push({\"action\":\"new\",\"type\": \"text\", \"colored_container\":is_inside_colored_container, \"id\":text_styles[last].id, \"layerName\": all_texts[i].name});\n\n      }else{\n        //update element\n        updateElementStyle(all_texts[i], hasMatchingStyle);\n\n        //add setting if it doesn't exist\n        var hasSettings=ifStylesavedInSettings(document, all_settings_t,new_styles, hasMatchingStyle.id, \"text\");\n        if(!hasSettings){\n          new_styles.push({\"action\":\"link\", \"type\": \"text\",\"colored_container\":is_inside_colored_container,  \"id\":hasMatchingStyle.id, \"layerName\": all_texts[i].name});\n        \n        }\n      }\n     \n    //has synced style\n    }else{\n      //update element\n      updateElementStyle(all_texts[i], hasStyle);\n\n      //add setting if it doesn't exist\n      var hasSettings=ifStylesavedInSettings(document, all_settings_t,new_styles, hasStyle.id, \"text\");\n      if(!hasSettings){\n        var is_inside_colored_container= TextinsideColoredContainer(all_texts[i], colored_containers);\n        new_styles.push({\"action\":\"save_setting\", \"type\": \"text\", \"colored_container\":is_inside_colored_container,  \"id\":hasStyle.id, \"layerName\": all_texts[i].name});\n\n      }\n\n   }\n\n  }\n  //new_styles = new_container_styles.concat(new_styles);\n  //console.log(colored_containers);\n  //console.log(\"initial styles\"+count_added);\n  return {\"layer\":layer_styles, \"text\":text_styles, \"new_styles\": new_styles};\n\n}\nfunction TextinsideColoredContainer(text_element, colored_containers){\n  \n  var is_inside_colored_container=false;\n  var layer_artboard= getLayerArtboard(text_element);\n  var same_artboard=false;\n  var frame_absolute= getFrameAbsoluteFrame(text_element);\n\n  for(var c=0; c< colored_containers.length; c++){\n    if(layer_artboard == colored_containers[c].artboard){\n      same_artboard=colored_containers[c];\n     \n      if(frame_absolute.x >= same_artboard.container.x && frame_absolute.x <= (same_artboard.container.x+same_artboard.container.width)\n      && frame_absolute.y >= same_artboard.container.y && frame_absolute.y <= (same_artboard.container.y+same_artboard.container.height)\n      ){\n        is_inside_colored_container=true;\n      }\n  }\n}\n  return is_inside_colored_container;\n}\nfunction getFrameAbsoluteFrame(p){\n  let parent_top=p;\n  let sum_x=p.frame.x;\n  let sum_y=p.frame.y;\n  if(parent_top.parent.type!=\"Page\"){\n    while(parent_top.type!=\"Artboard\" && parent_top.type!=\"SymbolMaster\"  && parent_top.type!=\"Page\"  ){\n      parent_top= parent_top.parent;\n      if(parent_top.type!=\"Artboard\" && parent_top.type!=\"SymbolMaster\"  && parent_top.type!=\"Page\"  ){\n          sum_x+=parent_top.frame.x;\n          sum_y+=parent_top.frame.y;\n      }\n    }\n  }\n  return {\"x\":sum_x, \"y\":sum_y};\n}\nfunction elementHasMatchingStyle(all_styles, style, this_settings){\n  var repeated=false;\n  //console.log(all_styles);\n \n\n  for(var i= 0; i< all_styles.length; i++){\n    var isOutOfSync = style.isOutOfSyncWithSharedStyle(all_styles[i]);\n    var originLibrary = all_styles[i].getLibrary();\n\n    if(!isOutOfSync && originLibrary==null){\n      repeated=all_styles[i];\n      break;\n    }\n  }\n  \n  return repeated;\n  \n\n}\n\nfunction elementHasMatchingStyleAndSetting(document, all_styles, style, this_settings, otherSettings, otherSettings_2, is_inside_colored_container, type){\n  var repeated=false;\n  var is_in_my_setting=false;\n  var is_in_other_Setting=false;\n  //console.log(all_styles);\n  for (var n=0; n<this_settings.length; n++){\n      if(type[0] == \"layer\"){\n        var setting_style= document.getSharedLayerStyleWithID(this_settings[n].light);\n      }else{\n        var setting_style= document.getSharedTextStyleWithID(this_settings[n].light);\n      }\n      var isOutOfSync = style.isOutOfSyncWithSharedStyle(setting_style);\n\n      if(!isOutOfSync && this_settings[n].colored_container == is_inside_colored_container){\n        is_in_my_setting=true;\n        repeated=setting_style;\n        break;\n      }\n  }\n  if(!is_in_my_setting){\n    for (var n=0; n<otherSettings.length; n++){\n      if(type[1] == \"layer\"){\n        var setting_style= document.getSharedLayerStyleWithID(otherSettings[n].light);\n      }else{\n        var setting_style= document.getSharedTextStyleWithID(otherSettings[n].light);\n      }\n      var isOutOfSync = style.isOutOfSyncWithSharedStyle(setting_style);\n      //var originLibrary = all_styles[i].getLibrary();\n      if(!isOutOfSync){\n        is_in_other_Setting=true;\n        break;\n        }\n    }\n  }\n  if(!is_in_my_setting && !is_in_other_Setting){\n    for (var n=0; n<otherSettings_2.length; n++){\n      if(type[2] == \"layer\"){\n        var setting_style= document.getSharedLayerStyleWithID(otherSettings_2[n].light);\n      }else{\n        var setting_style= document.getSharedTextStyleWithID(otherSettings_2[n].light);\n      }\n      var isOutOfSync = style.isOutOfSyncWithSharedStyle(setting_style);\n      //var originLibrary = all_styles[i].getLibrary();\n      if(!isOutOfSync){\n        is_in_other_Setting=true;\n        break;\n        }\n    }\n  }\n\n  if(!is_in_my_setting && !is_in_other_Setting ){\n    for(var i= 0; i< all_styles.length; i++){\n      var isOutOfSync = style.isOutOfSyncWithSharedStyle(all_styles[i]);\n      var originLibrary = all_styles[i].getLibrary();\n\n      if(!isOutOfSync && originLibrary==null){\n        repeated=all_styles[i];\n        break;\n      }\n    }\n  }\n  \n  return repeated;\n  \n\n}\n\n\nfunction ifStylesavedInSettings(document, all_settings, new_styles,  style_id, type){\n  var repeated=false;\n  //console.log(all_styles);\n \n  for(var i= 0; i< new_styles.length; i++){ \n    if(style_id == new_styles[i].id ){\n      repeated=i;\n      break;\n    }\n  }\n  //console.log(all_styles);\n  for(var i= 0; i< all_settings.length; i++){ \n   \n    if( style_id == all_settings.light ){\n      /*\n      if(type == \"layer\"){\n        var style_dark=document.getSharedLayerStyleWithID(all_settings.dark );\n        var style_light=document.getSharedLayerStyleWithID(all_settings.light );\n      }else{\n        var style_dark=document.getSharedTextStyleWithID(all_settings.dark );\n        var style_light=document.getSharedTextStyleWithID(all_settings.light );\n        \n      }\n      */\n     if(type == \"layer\"){\n        var style_dark=document.getSharedLayerStyleWithID(all_settings.dark );\n      }else{\n        var style_dark=document.getSharedTextStyleWithID(all_settings.dark );\n        \n    }\n    if(style_dark!=undefined){\n      repeated=all_settings[i];\n    }\n    break;\n    }\n  }\n  return repeated;\n}\n\nexport function createDarkModeStyle(Settings, document,styles_layer,styles_text, new_styles ){\n\n    console.log(\".........................................\");\n    console.log(\"Step 2 - Create Dark Mode Layer Styles...\");\n    var percentage_layer=0;\n    var percentage_text=0;\n    \n    var s_styles= Settings.documentSettingForKey(document,'Styles');\n    var s_styles_c= Settings.documentSettingForKey(document,'Styles_Containers');\n    var s_styles_l= Settings.documentSettingForKey(document,'Styles_Layers');\n    var s_styles_t= Settings.documentSettingForKey(document,'Styles_Texts');\n\n \n    //layer color\n    var new_styles_layer= styles_layer;\n    var new_styles_text= styles_text;\n\n    //console.log(\"number of styles\"+new_styles.length);\n    //DO LAYERS\n    for(var i=0; i<new_styles.length; i++){\n      //VIEW OF PROGRESS\n      if(parseInt(percentage_layer) != parseInt(i*100 /new_styles.length)){\n        console.log(\"Step 2 - \"+percentage_layer+\"%\");\n        percentage_layer = parseInt(i*100 /new_styles.length);\n      }\n\n      \n      //CREATE STYLE LAYER\n      if(new_styles[i].type==\"layer\"){\n        //GET SHARED STYLE\n        var shared_style = getStyleById(styles_layer, new_styles[i].id);\n        // var shared_style = document.getSharedLayerStyleWithID(new_styles[i].id);\n        var s_style_name= shared_style.name;\n  \n  \n  \n        //GET CLEAN NAMES\n        if( s_style_name.includes(\"lightMode\")){\n          var clean_name = s_style_name.replace(\"/lightMode\", \"\").replace(\" \", \"\");\n        }else{\n          var clean_name = s_style_name.replace(\" \", \"\");\n          shared_style.name= shared_style.name+\"/lightMode\";\n  \n        }\n        var dark_name = clean_name+\"/DarkMode\";\n \n        new_styles_layer.push({\n            name: dark_name,\n            style: shared_style.style,\n            styleType: \"Layer\",\n            document: document\n        })\n        var last_style=new_styles_layer.length-1;\n        var transformMode;\n        \n         if(new_styles[i].colored_container==true ){\n          transformMode= \"in_colored_container\";\n        }else if(new_styles[i].element == \"small\"){\n          transformMode= \"Shape\";\n        }else{\n          transformMode= \"container\";\n        }\n\n        //change Fill\n        if( shared_style.style.fills.length>0){\n          //loop through all fills\n          for(var f=0; f<shared_style.style.fills.length; f++){\n            //if gradient\n            if(shared_style.style.fills[f].fillType==\"Gradient\"){\n              for(var g=0; g<shared_style.style.fills[f].gradient.stops.length; g++){\n                var newcolor= transformColor(shared_style.style.fills[f].gradient.stops[g].color, transformMode);\n                new_styles_layer[last_style].style.fills[f].gradient.stops[g].color=newcolor;\n              }\n            //normal fill\n            }else{\n              var newcolor= transformColor(shared_style.style.fills[f].color, transformMode);\n              new_styles_layer[last_style].style.fills[f].color= newcolor;\n\n            }\n          }\n        }\n        //change border\n        if( shared_style.style.borders.length>0){\n          //loop through all fills\n          for(var b=0; b<shared_style.style.borders.length; b++){\n            //iff gradient\n            if(shared_style.style.borders[b].fillType==\"Gradient\"){\n              for(var g=0; g<shared_style.style.borders[b].gradient.stops.length; g++){\n                var newcolor= transformColor(shared_style.style.borders[b].gradient.stops[g].color, transformMode);\n                new_styles_layer[last_style].style.borders[b].color=newcolor;\n              }\n            //normal fill\n            }else{\n              var newcolor= transformColor(shared_style.style.borders[b].color, transformMode);\n              new_styles_layer[last_style].style.borders[b].color=newcolor;\n\n            }\n          }\n        }\n\n        //change shadows\n        if( shared_style.style.shadows.length>0){\n          for(var s=0; s<shared_style.style.shadows.length; s++){\n            var newcolor= transformColor(shared_style.style.shadows[s].color, transformMode);\n            new_styles_layer[last_style].style.shadows[s].color= newcolor;\n\n          }\n        }\n\n        //change inner shadows\n        if( shared_style.style.innerShadows.length>0){\n          for(var s=0; s<shared_style.style.innerShadows.length; s++){\n            var newcolor= transformColor(shared_style.style.innerShadows[s].color, transformMode);\n            new_styles_layer[last_style].style.innerShadows[s].color= newcolor;\n\n          }\n        }\n\n        //add setting\n        s_styles.push({\"type\": \"layer\",\"colored_container\": new_styles[i].colored_container, \"element\":new_styles[i].element, \"light\": shared_style.id, \"dark\":new_styles_layer[last_style].id})\n\n        if(new_styles[i].element===\"small\" ){\n          s_styles_l.push({\"type\": \"layer\",\"colored_container\": new_styles[i].colored_container, \"element\":new_styles[i].element, \"light\": shared_style.id, \"dark\":new_styles_layer[last_style].id})\n        }else{\n          s_styles_c.push({\"type\": \"layer\", \"colored_container\": new_styles[i].colored_container, \"element\":new_styles[i].element, \"light\": shared_style.id, \"dark\":new_styles_layer[last_style].id})\n\n        }\n        //console.log({\"type\": \"layer\", \"light\": shared_style.id, \"dark\":new_styles_layer[last_style].id});\n        //console.log( shared_style.id);\n      //CREATE TEXT LAYER\n      }else{\n        //GET SHARED STYLE\n        var shared_style = getStyleById(styles_text, new_styles[i].id);\n        // var shared_style = document.getSharedLayerStyleWithID(new_styles[i].id);\n       //console.log(shared_style);\n        var s_style_name= shared_style.name;\n        if( s_style_name.includes(\"lightMode\")){\n          var clean_name = s_style_name.replace(\"/lightMode\", \"\").replace(\" \", \"\");\n        }else{\n          var clean_name = s_style_name.replace(\" \", \"\");\n          shared_style.name= shared_style.name+\"/lightMode\";\n  \n        }\n        var dark_name = clean_name+\"/DarkMode\";\n\n\n\n        new_styles_text.push({\n          name: dark_name,\n          style: shared_style.style,\n          styleType: \"Layer\",\n          document: document\n        })\n        var last_style=new_styles_text.length-1;\n\n        if(new_styles[i].colored_container==true ){\n            transformMode= \"in_colored_container\";\n          }else{\n            transformMode= \"Text\";\n          }\n\n        //CHANGE TEXT COLOR\n        var layer_style_color= shared_style.style.textColor;\n\n        var newcolor= transformColor(layer_style_color, transformMode);\n\n        new_styles_text[last_style].style.textColor= newcolor;\n        s_styles.push({\"type\": \"text\",\"colored_container\":new_styles[i].colored_container,  \"element\":\"text\", \"light\": shared_style.id, \"dark\":new_styles_text[last_style].id})\n        s_styles_t.push({\"type\": \"text\",\"colored_container\": new_styles[i].colored_container, \"element\":\"text\", \"light\": shared_style.id, \"dark\":new_styles_text[last_style].id})\n        \n      }\n    }\n    \n    return {\"layer\":new_styles_layer, \"text\":new_styles_text, \"settings\": s_styles, \"settings_c\": s_styles_c , \"settings_l\": s_styles_l, \"settings_t\": s_styles_t};\n\n}\n\nfunction transformColor(color, type){\n  if(color.length>7){\n    var alpha = color.slice(7, 9);\n  }else{\n    var alpha=\"ff\";\n  }\n  var dark_hex_hex= DarkMode(color,type);\n  var dark_hex= RGBToHex(\"rgb(\"+dark_hex_hex.r+\",\"+dark_hex_hex.g+\",\"+dark_hex_hex.b+\")\");\n  var dark_hex_alpha= dark_hex+alpha;\n\n  return dark_hex_alpha;\n\n}\n\n\nfunction getSettingStyle(id, dark, all_settings){\n  var opositde_mode=false;\n  //console.log(all_styles);\n\n  for(var i= 0; i< all_settings.length; i++){\n    if(i==all_settings.length-1 || i==all_settings.length-2){\n    //console.log(all_settings[i])\n    }\n\n    if(all_settings[i].light== id && dark==true){\n     // console.log(opositde_mode)\n      opositde_mode=all_settings[i].dark;\n      break;\n    }\n    if(all_settings[i].dark== id && dark==false){\n      //console.log(opositde_mode)\n      opositde_mode=all_settings[i].light;\n      break;\n    }\n  }\n  return opositde_mode;\n\n}\n\n\n\nexport function SwitchDarkMode_best(Settings, sketch, document, page , layer_styles, text_styles, dark){\n    console.log(\".........................................\");\n    var all_layer= sketch.find('*', document.pages[page]);      \n    var all_artboards= sketch.find('Artboard', document.pages[page]);\n    var all_shapes= sketch.find('Shape', document.pages[page]);\n    var all_shapesPaths= sketch.find('ShapePath', document.pages[page]);\n    var all_texts= sketch.find('Text', document.pages[page]);\n    var all_settings= Settings.documentSettingForKey(document, 'Styles');\n\n    if(dark){\n      var this_mode=\"lightMode\";\n      var to_mode=\"DarkMode\";\n    }else{\n      var this_mode=\"DarkMode\";\n      var to_mode=\"lightMode\";\n    }\n    var count_switch=0;\n    console.log(\"Step 4 - Switch to \"+to_mode);\n    var percentage=0;\n    for(var i=0; i<all_shapes.length;i++ ){\n      if(percentage != parseInt(i*100 /all_shapes.length)){\n        console.log(\"Shapes 4 - \"+percentage+\"%\");\n        percentage = parseInt(i*100 /all_shapes.length);\n  \n      }\n      \n      var style_oposite_id= getSettingStyle(all_shapes[i].sharedStyleId , dark,all_settings);\n      if(style_oposite_id!=false){\n        //console.log(style_oposite_id);\n        var style_oposite = document.getSharedLayerStyleWithID(style_oposite_id);\n        //console.log(style_oposite);\n        \n        if(style_oposite!=undefined){\n        \n          all_shapes[i].sharedStyleId=style_oposite.id;\n          all_shapes[i].sharedStyle=style_oposite;\n          all_shapes[i].style=style_oposite.style;\n          all_shapes[i].style.syncWithSharedStyle(style_oposite);\n        }\n\n      }\n    }\n\n    var percentage=0;\n    for(var i=0; i<all_shapesPaths.length;i++ ){\n      if(percentage != parseInt(i*100 /all_shapesPaths.length)){\n        console.log(\"Shapes Paths 4 - \"+percentage+\"%\");\n        percentage = parseInt(i*100 /all_shapesPaths.length);\n  \n\n      }\n      //console.log(\"shape id \"+all_shapesPaths[i].sharedStyleId);\n      \n      var style_oposite_id= getSettingStyle(all_shapesPaths[i].sharedStyleId,dark,all_settings);\n      //console.log(all_shapesPaths[i].sharedStyleId);\n\n      //console.log(\"shape\"+style_oposite_id);\n      if(style_oposite_id!=false){\n        //console.log(\"style_oposite_id\");\n        var style_oposite = document.getSharedLayerStyleWithID(style_oposite_id);\n        if(style_oposite!=undefined){\n\n          all_shapesPaths[i].sharedStyleId=style_oposite.id;\n          all_shapesPaths[i].sharedStyle=style_oposite;\n          all_shapesPaths[i].style=style_oposite.style;\n          all_shapesPaths[i].style.syncWithSharedStyle(style_oposite);\n          count_switch++;\n\n        }\n      }\n    }\n\n    var percentage=0;\n    for(var i=0; i<all_texts.length;i++ ){\n      if(percentage != parseInt(i*100 /all_texts.length)){\n        console.log(\"Texts 4 - \"+percentage+\"%\");\n        percentage = parseInt(i*100 /all_texts.length);\n  \n      }\n\n      var style_oposite_id= getSettingStyle(all_texts[i].sharedStyleId, dark,all_settings);\n      if(style_oposite_id!=false){\n        var style_oposite = document.getSharedTextStyleWithID(style_oposite_id);\n        if(style_oposite!=undefined){\n\n          all_texts[i].sharedStyleId=style_oposite.id;\n          all_texts[i].sharedStyle=style_oposite;\n          all_texts[i].style=style_oposite.style;\n          all_texts[i].style.syncWithSharedStyle(style_oposite);\n          count_switch++;\n\n        }\n      }\n\n    }\n    if(count_switch>0){\n      var percentage=0;\n      for(var i=0; i<all_artboards.length;i++ ){\n        console.log(\"Artboard - \"+i);\n\n        if(percentage != parseInt(i*100 /all_artboards.length)){\n          console.log(\"Artboards 4 - \"+percentage+\"%\");\n          percentage = parseInt(i*100 /all_artboards.length);\n        }\n\n        //CHANGE TEXT COLOR\n        if( all_artboards[i].background.enabled==false){\n          var layer_style_color= \"#ffffff\";\n          \n        }else{\n          var layer_style_color= all_artboards[i].background.color;\n        }\n\n        var alpha=\"ff\";\n        var dark_hex_hex= DarkMode(layer_style_color, \"Artboard\");\n        var dark_hex= RGBToHex(\"rgb(\"+dark_hex_hex.r+\",\"+dark_hex_hex.g+\",\"+dark_hex_hex.b+\")\");\n\n\n        var new_artboard_color=dark_hex+alpha;\n        all_artboards[i].background.color=new_artboard_color;\n        all_artboards[i].background.enabled=true;\n\n      }\n    }\n    return count_switch;\n  \n}","module.exports = require(\"path\");","module.exports = require(\"sketch\");","module.exports = require(\"sketch/dom\");","module.exports = require(\"sketch/settings\");"],"sourceRoot":""}